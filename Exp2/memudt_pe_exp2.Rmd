---
title: 'Reconsolidation-based Episodic Memory Updating - Experiment 2'
author: "Taehoon Kim, Do-Joon Yi"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    highlight: tango
    number_sections: true
    theme: cosmo
    toc: true
    toc_depth: 5
    toc_float:
      collapse: false
      smooth_scroll: false
  pdf_document:
    toc: true
    toc_depth: 5
subtitle: MA-Thesis, Non-monotonic Effect of Prediction Error
mainfont: Noto Sans CJK KR
editor_options: 
  chunk_output_type: console
---

```{r setup1, echo=FALSE}
rm(list=ls())
currDir=getwd()
currDir='/Users/taehoonkim/Desktop/Workspace/curr/Exp2'
setwd(currDir)
options(scipen=4)
load("memudet_data.Rdata")
```

```{css setup2, echo=FALSE}
pre code, pre, code {
  white-space: pre !important;
  overflow-x: scroll !important;
  word-break: keep-all !important;
  word-wrap: initial !important;
}
```


```{r setup 3, message=FALSE}
knitr::opts_chunk$set(message=F, warning=F)
set.seed(12345) # for reproducibility
options(knitr.kable.NA = '')

# Some packages need to be loaded. We use `pacman` as a package manager, which takes care of the other packages. 
if (!require("pacman", quietly = TRUE)) install.packages("pacman")
if (!require("Rmisc", quietly = TRUE)) install.packages("Rmisc") # Never load it directly.
pacman::p_load(tidyverse, papaja, knitr, ggplot2, car, lme4, afex, emmeans, parallel, ordinal, psych, gridExtra, MuMIn,
               ggbeeswarm, RVAideMemoire, apaTables, scales, matlab, rcompanion, nortest, psycho, ggpubr)
devtools::install_github("thomasp85/patchwork")
remotes::install_github("rlesur/klippy")
library("patchwork"); library("klippy")
klippy::klippy()
```

<br>
  
****

<br>
  
# 방법

<br>

## 참가자 

<br>

정상 시력의 학부생 38명이 인터넷 홈페이지를 통해 모집되었다(여 18명, 평균 연령 24.79세, 표준 편차 2.48). 이 중 2명의 참가자가 과도하게 낮은 수행 및 개인 사정으로 실험 중도에 제외되어, 총 36명이 실험에 참여하였다. 36명의 참가자는 실험 집단에 18명, 통제 집단에 18명 할당되었다. 참가자들은 실험에 앞서 서면으로 작성된 실험 참가 동의서에 서명하였으며, 25,000원 상당의 문화상품권을 참가 보상으로 수령하였다. 

<br>

본 실험의 참가자 수는 예비 실험에 근거한 검증력 분석, 선행 연구의 참가자 수, 조건 간 역균형화를 고려하여 설정되었다. 검증력 분석은 G*Power 소프트웨어를 통해, 집단 간 출처 혼동과 침범에 대한 비대칭적 패턴 반응의 상호작용, 집단 간 예측 오류 조건에 따른 비단조적 침범 패턴의 상호작용 효과 크기를 80% 검증력으로 적용하여 수행되었다(Faul, Erdfelder, Lang, & Buchner, 2007). 2(집단: 실험 집단, 통제 집단) × 2(반응: 출처 혼동, 침범)의 두 요인 간 상호작용의 효과 크기(ηp2 = .23)을 바탕으로 표본수를 산출한 결과, 총 32명의 참가자 수가 필요한 것으로 나타났다. 또한, 비단조적 기억 갱신 효과와 관련된 2(집단: 실험 집단, 통제 집단) × 4(예측 오류 조건: PE 1, PE 2, PE 3, PE 4) 혼합 요인 분산 분석의 상호 작용의 효과 크기(ηp2)는 .35였다. 이를 세 예측 오류 조건의 본 실험 패러다임에 적용하여 산출된 표본수는 18명으로 나타났다. 두 번째로 본 실험과 유사한 패러다임을 사용한 연구의 표본수는 집단당 20명에서 48명으로 다양하였다. Hupbach 등(2009)의 첫 번째 실험에는 20명, Sinclear와 Barense(2018)에서는 실험 1에 48명, Forcato 등(2016)에선 36명의 참가자가 참여하였다. 마지막으로, 본 실험의 패러다임에서 예측 오류 조건은 각 참가자에게 제시된 색 단서에 따라 3가지로 구분되었기 때문에, 색 단서 - 오류 조건의 조합을 완전 역균형화하기 위해 최소 6명(3P3 = 6)이 각 집단에 할당될 필요가 있다. 이러한 점과 추정된 적정 참가자수를 고려하여 총 참가자 수는 36명으로 설정되었다.

<br>

## 장치 및 자극

<br>

장치 및 자극은 물체 자극을 제외하고 예비 실험과 동일하였다. 물체 자극은 예비 실험에서 사용된 자극에서 정체성을 알아보기 어렵거나 친숙하지 않다고 보고된 물체를 대체하고, 인터넷과 물체 모음집(Brady et al., 2008)에서 30개를 더 수집하여 총 270개의 물체 그림이 사용되었다. 물체(7.21°× 7.21°)는 색을 회색조로 조정한 후 각 회기에 제시되는 세 개의 물체 목록(목록 1, 목록 2, 목록 3)에 90개씩 무작위로 할당하였다. 목록 1과 목록 2에서 세 개의 하위 연합 기억을 형성하기 위해 세 가지 색을 사용한 연합 색 상자 자극(11.98°× 11.98°)을 구성하였다. 예비 실험의 연합 기억 학습에서 색에 따른 연합 기억 정확도를 비교한 결과, 첫 번째 색이었던 주황색에서 연합 기억 수행이 다른 색보다 전반적으로 낮았다, 주황색(M = 81.05, SD = 6.99), 노란색(M = 83.63, SD = 6.50), 파란색(M = 87.11, SD = 6.03), 초록색(M = 84.77, SD = 5.94). 이에 따라 세 가지 색은 주황색을 제외하고 노란색[255, 192, 0], 파란색[90, 155, 213], 초록색[112, 173, 70]으로 설정하였다.목록 1과 2 각각의 물체 90개는 세 가지 색에 30개 씩 무작위로 할당되었다.

<br>
  
## 실험 설계와 절차

<br>

본 실험의 설계는 2(집단: 실험 집단, 통제 집단) × 3(예측 오류: 0%-PE 1, 50%-PE 2, 100%-PE 3)의 혼합 요인 설계로 구성되었다. 전체적인 절차와 과제는 다음의 사항을 제외하고 예비 실험과 동일하였다(그림 5). 첫째, 각 회기의 시간 간격은 24~48시간에서 약 24시간으로 고정되었다. 둘째, 각 목록에 할당되는 물체가 90개로 증가함에 따라, 각 과제의 시행도 90 시행(연합 학습 및 검사 과제, 재활성화 과제), 360 시행(출처 및 연합 기억 검사)으로 조정되었다. 셋째, 예측 오류의 조건은 예비 실험의 네 조건에서 세 조건으로 축소되었다. 

<br>
![](/Users/taehoonkim/Desktop/Workspace/curr/Exp2/Exp2_Procedure.png)

<br>
  
## 통계 분석

<br>

모든 통계 분석은 R(R Core Team, 2019) 프로그램을 사용하여 수행하였다. 구체적인 분석 방법은 예비 실험과 유사하였다. 물체 목록의 연합 기억이 성공적으로 형성되었는지 확인하기 위해, 정확도와 반응시간을 분석하였다. 반응시간의 전처리 절차는 동일하다.

<br>

셋째 날의 출처 기억 반응은 동일하게 여러 종속 변인으로 구분되었다. 주요 종속 변인은 목록 1 정확반응(List 1 Correct, L1→D1), 목록 2 정확반응(List 2 Correct, L2→D2), (Source Confusion, L1→D2), 침범(Intrusion, L2→D1)의 네 가지이고, 이 외에 목록 3 정확반응(List 3 Correct, L3→New), 목록 3 오경보 1과 2(List 3 False Alarm - Day 1&2, L3→D1&2), 목록 1 & 2 누락(Miss, L1&2→New)을 측정하였다. 

<br> 

추가로, 본 실험의 두 번째 가설인 예측 오류의 비단조적 기억 갱신 효과 분석을 보완하기 위해 침범 반응에 대한 모형 적합을 수행하였다. 모형 적합은 R의 lme4 패키지를 활용하는 혼합 효과 모형(mixed effect model)을 구성하여 수행되었다(Bates, Mächler, Bolker, & Walker, 2015). 혼합 효과 모형은 참가자 또는 자극에 의한 변산이 측정된 자료에 미칠 수 있는 무선 효과를 실험 조건을 반영하는 고정 효과와 함께 한 가지 모형에서 동시에 고려할 수 있도록 해준다(Baayen, Davidson, & Bates, 2008). 침범 반응 비율이 예측 오류에 따라 선형적으로 증가하는지, 아니면 역U자 패턴을 따르는지 확인하기 위해, 결과 자료를 선형 관계를 가정한 모형(y = b0 + b1x1 + e)과 비선형 관계를 가정한 모형(y = b0 + b1x1 + b2x12 + e)에 적합하였다. 각 모형에는 예측 오류 조건의 고정 효과뿐만 아니라, 참가자에 의한 무선 절편이 무선 효과로 포함되었다. 두 모형은 우도 비율 검정(likelihood ratio test, LRT)과 AIC(akaike information criterion) 및 BIC(bayesian information criterion)와 같은 모형 비교 지표를 통해 비교되었다.

<br>

마지막으로 출처 반응의 분석 결과를 보완하기 위해 출처 기억 확신도를 분석하였다. 연합 기억이 셋째 날까지 잘 유지되었는지 확인하기 위해 각 집단, 물체 목록에서 연합 기억 정확도 및 확신도 또한 분석하였다. 모든 추론 통계 분석은 혼합 요인 분산 분석 및 Tukey의 쌍별 비교 사후 검정 방법을 통해 수행되었으며, 구형성 가정이 충족되지 않으면 교정된 자유도 상수를 사용하였다.

<br>


<br><br>

****

<br><br>
  
# 결과

<br>

## 목록 1, 목록 2의 연합 학습 수행

<br>

학습 및 검사 절차를 통해 물체-색 연합의 기억이 안정적으로 형성되었는지 확인하기 위해, 각 집단에서 연합 기억 정확도와 반응 시간의 변화를 블록 반복에 따라 분석하였다.

```{r L1&2_data_preparation, collapse=TRUE}
set_sum_contrasts()
p1 <- read.csv("MemUdt_PE_d1t2_m.csv", header = T) 
p2 <- read.csv("MemUdt_PE_d2t5_m.csv", header = T) 
p1$List <- 1; p2$List <- 2
p12 <- rbind(p1, p2)

p12$SN = factor(p12$SN); p12$Btw = factor(p12$Btw)
p12$List = factor(p12$List, levels = c(1,2), labels=c("List1", "List2"))
p12$Block = factor(p12$Block, levels=c(1,2,3,4), labels=c("b1","b2","b3","b4"))
p12$cCue = factor(p12$cCue, levels=c(1,2,3), labels=c("c1","c2","c3"))
p12$CueName = factor(p12$CueName, labels=c("c1","c2","c3"))
p12$RT <- p12$RT*1000; p12$Corr <- as.numeric(p12$Corr==1)
p12 <- p12 %>% select(SN, Btw, List, Trial, Block, bTrial, cCue, 
                      IMidx, IMname, CueName, Resp, RT, Corr)

glimpse(p12, width=70)

# 1. SN: participant ID
# 2. Btw: between factor. 1-experimental group, 2-control group
# 3. List: study list. 1-List1, 2-List2
# 4. Trial: 1 ~ 360
# 5. Block: b1 ~ b4
# 6. bTrial: 1 ~ 90
# 7. cCue: association color cue condition. 1-c1, 2-c2, 3-c3
# 8. IMidx: index of stimuli
# 9. IMname: name of stimuli
# 10. CueName: name of color cue
# 11. Resp: association color cue response
# 12. RT: association color cue response time
# 13. Corr: color cue response correctness. 1-correct, 0-incorrect

length(unique(p12$SN))
length(unique(p12$SN[p12$Btw==1]))
length(unique(p12$SN[p12$Btw==2]))
table(p12$List, p12$SN)

```

<br><br>

### 연합 학습 정확도 및 반응시간

<br>
  
#### 정확도 (Accuracy)

<br>

  연합 학습 검사 결과에서 집단과 목록, 블록 반복에 따른 정확도 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 `목록 1`, B는 `목록 2`를 나타내며, 각 모양의 점은 평균, 오차 막대는 95% 신뢰구간을 나타낸다. 점의 모양으로 두 집단이 구분되었다. 

```{r L1&2_acc_summary, warning=FALSE, message=FALSE}
# phase 1, subject-level, long-format
p12.L.long.all <- p12 %>% group_by(SN, Btw, List, Block) %>% 
  dplyr::summarise(Accuracy = mean(Corr)*100) %>% ungroup()
p12.L.long.exp <- p12.L.long.all %>% filter(Btw == 1)
p12.L.long.con <- p12.L.long.all %>% filter(Btw == 2) 

# wide format, needed for geom_segments.
p12.L.swide.all <- p12.L.long.all %>% spread(key = Block, value = Accuracy)
p12.L.swide.exp <- p12.L.swide.all %>% filter(Btw == 1)
p12.L.swide.con <- p12.L.swide.all %>% filter(Btw == 2)

# summary table
p12.L.g.all <- p12.L.long.all %>% group_by(Btw, List, Block) %>%
  summarise(ACC.M = mean(Accuracy), SD = sd(Accuracy)) %>% ungroup()
p12.L.g.all$se <- Rmisc::summarySEwithin(data = p12.L.long.all, measurevar = "Accuracy", idvar = "SN", betweenvars ="Btw", withinvars = c("List","Block"))$se
p12.L.g.all$ci <- Rmisc::summarySEwithin(data = p12.L.long.all, measurevar = "Accuracy", idvar = "SN", betweenvars ="Btw", withinvars = c("List","Block"))$ci
p12.L.g.exp <- p12.L.g.all %>% filter(Btw == 1); p12.L.g.con <- p12.L.g.all %>% filter(Btw == 2)
p12.L.g.L1 <- p12.L.g.all %>% filter(List == "List1"); p12.L.g.L2 <- p12.L.g.all %>% filter(List == "List2")
p12.L.g.L1$Btw <- factor(p12.L.g.L1$Btw, labels=c("Experimental", "Control"))
p12.L.g.L2$Btw <- factor(p12.L.g.L2$Btw, labels=c("Experimental", "Control"))
# p12.L.g.all %>% kable(digit=2)
```

**목록 1 정확도**
```{r L1_acc_summary_table}
p12.L.g.L1 %>% kable(digit=2)
```

**목록 2 정확도**
```{r L2_acc_summary_table}
p12.L.g.L2 %>% kable(digit=2)
```

**물체 목록에 따른 집단별 정확도 그래프**

```{r L1&2_acc_plot, fig.width= 12, fig.height=6}
p12.L.g.L1.plot1 <- ggplot(data=p12.L.g.L1, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        legend.key = element_blank())

p12.L.g.L2.plot1 <- ggplot(data=p12.L.g.L2, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        legend.key = element_blank())

d12_asc_acc_Main<- ggpubr::ggarrange(p12.L.g.L1.plot1, p12.L.g.L2.plot1, nrow = 1, ncol=2, 
                                labels=c("A. List 1","B. List 2"),
                                hjust = -0.05, vjust=1, font.label = list(size = 20))
d12_asc_acc_Main
```

<br>
  
##### 혼합 요인 분산 분석 - 전체 블록

<br>
  
두 집단의 물체 목록에 블록 반복에 따른 연합 기억 정확도 변화를 살펴보기 위해 참가자 간 변인인 집단과 참가자 내 변인인 목록 및 블록 반복을 요인으로 2 X 2 X 4 혼합 요인 분산분석을 수행하였다.

```{r L1&2_acc_anova, warning=FALSE, message=FALSE}
p12.L.long.all$Btw <- factor(p12.L.long.all$Btw, labels=c("Experimental", "Control"))
p12.acc.aov <- aov_ez(id = "SN", dv = "Accuracy", data = p12.L.long.all, 
                      between = "Btw", within = c("List","Block"))
# test_levene(p12.acc.aov)
# test_sphericity(p12.acc.aov)
anova(p12.acc.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 목록의 주효과, 블록 반복의 주효과, 목록과 블록 반복의 상호작용이 유의하였다.

```{r L1&2_acc_post-hoc, warning=FALSE, message=FALSE}
p12.acc.m1 <- emmeans(p12.acc.aov, c("Block"), by = c("Btw","List"), type = "response")
p12.acc.m1.pair <- update(pairs(p12.acc.m1), by = "Btw", adjust = "tukey")
p12.acc.m1.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

집단과 목록에서 블록에 의한 차이를 사후 분석한 결과, 두 집단 모두 각 목록에서 블록 반복에 따라 정확도가 향상되었다.

```{r L1&2_acc_post-hoc_plot, L1&2_acc_fig, fig.width= 12, fig.height=5}
# plot(p12.acc.m1, horizontal=F, comparisons=T) +
#   theme(panel.grid.major = element_blank(),
#         panel.grid.minor = element_blank())
```

<br>

##### 혼합 요인 분산 분석 - 블록 4

<br>
  
두 집단의 물체 목록에서 마지막 블록의 연합 기억 정확도 변화를 살펴보기 위해 참가자 간 변인인 집단과 참가자 내 변인인 목록을 요인으로 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r L1&2_b4_acc_anova, warning=FALSE, message=FALSE}
p12.L.long.b4.all <- p12.L.long.all %>% filter(Block=="b4")
p12.b4.acc.aov <- aov_ez(id = "SN", dv = "Accuracy", data = p12.L.long.b4.all, 
                      between = "Btw", within = c("List"))
# test_levene(p12.b4.acc.aov)
# test_sphericity(p12.b4.acc.aov)
anova(p12.b4.acc.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

```{r L1&2_b4_acc_post-hoc, warning=FALSE, message=FALSE}
p12.b4.acc.m1 <- emmeans(p12.b4.acc.aov, c("List","Btw"), by = NULL, type = "response")
p12.b4.acc.m1.pair <- update(pairs(p12.b4.acc.m1), by = NULL, adjust = "tukey")
p12.b4.acc.m1.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`의 `목록 2` 정확도가 `실험 집단`의 `목록 1`, `통제 집단`의 `목록 1`과 `목록 2`보다 수치적으로 우수하였으나 통계적으로 유의한 차이가 나타나지 않았다.

```{r L1&2_b4_acc_post-hoc_plot, L1&2_b4_acc_fig, fig.width= 12, fig.height=5}
plot(p12.b4.acc.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

##### 일반화 선형 혼합 모형; GLMM - 블록 4

<br>
  
분산 분석 결과를 보충하기 위해 블록 4의 연합 기억 정확도에 대하여 일반화 선형 혼합 모형(일반화 선형 혼합 모형; GLMM)을 검증하였다. 집단과 목록의 고정 효과(fixed effect)와 참가자와 자극 항목에 대한 무선 절편을 무선 효과(random effect)로 포함한 `p12.b4.Acc.Model`을 구성하였다.

<br>

```{r L1&2_b4_acc_GLMM, eval=FALSE, eval=FALSE}
p12.b4 <- p12 %>% filter(Block=="b4")
p12.b4$Block <- factor(p12.b4$Block)
p12.b4$Btw <- factor(p12.b4$Btw, labels=c("Experimental", "Control"))


(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p12.b4.Acc.Model.1 <- afex::mixed(Corr ~ Btw*List + (1|SN) + (1|IMname), 
                           p12.b4, method = "LRT", cl = cl, 
                           family=binomial(link="logit"),
                           control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p12.b4.Acc.Model.1, file="L1&2b4_Acc_afex.Rdata")

stopCluster(cl)
```

```{r L1&2_b4_acc_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/L1&2b4_Acc_afex.Rdata")
```

```{r L1&2_b4_acc_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p12.b4.Acc.Model.1) %>% kable(digits=3)
```

분석 결과, 집단과 목록의 상호작용이 유의하였다.

```{r L1&2_b4_acc_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p12.b4.acc.m2 <- emmeans(p12.b4.Acc.Model.1, c("List","Btw"), by = NULL, type = "response")
p12.b4.acc.m2.pair <- update(pairs(p12.b4.acc.m2), by = NULL, adjust = "tukey")
p12.b4.acc.m2.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

사후 분석 결과, 분산 분석과 같이 `실험 집단`의 `목록 2` 정확도가 `실험 집단`의 `목록 1`, `통제 집단`의 `목록 1`과 `목록 2`보다 수치적으로 우수하였으나 통계적으로 유의한 차이가 나타나지 않았다.

```{r L1&2_b4_acc_glmm_post-hoc_plot, eval=F, fig.width= 12, fig.height=5}
plot(p12.b4.acc.m2, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

#### 반응시간 (Response Time)

<br>

연합 기억 수행의 반응시간을 분석하였다.
  
```{r L1&2_rt_preprocessing, collapse=TRUE}
p12.acc.trial <- p12 %>% group_by(SN) %>% 
  summarise(Accuracy = mean(Corr)*100) %>% 
  ungroup() %>% summarise(M = mean(Accuracy), SD = sd(Accuracy))

cp12.all <- p12 %>% filter(Corr==1)

sp12.all <- cp12.all %>% filter(RT > 150) %>% 
  group_by(SN) %>% 
  nest() %>% 
  mutate(lbound = map(data, ~mean(.$RT)-3*sd(.$RT)),
         ubound = map(data, ~mean(.$RT)+3*sd(.$RT))) %>% 
  unnest(c(lbound, ubound)) %>% 
  unnest(data) %>% 
  ungroup() %>% 
  mutate(Outlier = (RT < lbound)|(RT > ubound)) %>% 
  filter(Outlier == FALSE) %>% 
  select(SN, Btw, List, Block, cCue, CueName, Resp, RT, Corr, IMname)

100 - 100*nrow(sp12.all)/nrow(cp12.all)
## [1] 2.174593

```

연합 기억 검사에서 정확하게 반응한 시행(M = `r round(p12.acc.trial$M, digits = 2)`%, SD = `r round(p12.acc.trial$SD, digits=2)`%)의 반응 시간 자료만 분석하였다. 가외치 제거 결과, 정확반응 시행의 반응시간 자료에서  `r round(100 - 100*nrow(sp12.all)/nrow(cp12.all), digits = 2)`%가 제거되었다.

```{r L1&2_rt_summary1, warning=FALSE, message=FALSE}

sp12.all %>% group_by(SN, Btw, Block) %>% 
  summarise(NumTrial = length(RT)) %>% 
  ungroup %>% 
  group_by(Btw, Block) %>%
  summarise(Avg = mean(NumTrial), 
            Med = median(NumTrial), 
            Min = min(NumTrial), 
            Max = max(NumTrial)) %>% 
  ungroup %>% kable(digit=2)

dens1 <- ggplot(cp12.all, aes(x=RT)) +
  geom_density() +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())

dens2 <- ggplot(sp12.all, aes(x=RT)) +
  geom_density() +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.y = element_blank(),
        axis.ticks.y = element_blank())
dens1 + dens2

```

<br>

집단과 목록, 블록 반복에 따른 반응시간 평균과 표준편차를 계산하였다. 두 집단 모두에서 블록 진행에 따라 연합 기억 검사의 반응시간이 향상되었다. 아래의 그래프에서 A는 `목록 1`, B는 `목록 2`를 나타내며, 각 모양의 점은 평균, 오차 막대는 95% 신뢰구간을 나타낸다. 점의 모양으로 두 집단이 구분되었다. 

```{r L1&2_rt_summary2, fig.width= 12, fig.height=6}
# long format
p12.L.rt.long.all <- sp12.all %>% group_by(SN, Btw, List, Block) %>% 
  summarise(RT = mean(RT)) %>% 
  ungroup()
p12.L.rt.long.exp <- p12.L.rt.long.all %>% filter(Btw==1)
p12.L.rt.long.con <- p12.L.rt.long.all %>% filter(Btw==2)

# wide format
p12.L.rt.swide.all <- p12.L.rt.long.all %>% spread(key = Block, value = RT)
p12.L.rt.swide.exp <- p12.L.rt.swide.all %>% filter(Btw==1)
p12.L.rt.swide.con <- p12.L.rt.swide.all %>% filter(Btw==2)

# summary table
p12.L.rt.g.all <- p12.L.rt.long.all %>% group_by(Btw, List, Block) %>%
  summarise(RT.M = mean(RT), SD = sd(RT)) %>% ungroup()
p12.L.rt.g.all$se <- Rmisc::summarySEwithin(data = p12.L.rt.long.all, measurevar = "RT", 
                                           idvar = "SN", betweenvars = "Btw", withinvars = c("List","Block"))$se
p12.L.rt.g.all$ci <- Rmisc::summarySEwithin(data = p12.L.rt.long.all, measurevar = "RT", 
                                           idvar = "SN", betweenvars = "Btw", withinvars = c("List","Block"))$ci
p12.L.rt.g.all$Btw <- factor(p12.L.rt.g.all$Btw, labels=c("Experimental", "Control"))
p12.L.rt.g.L1 <- p12.L.rt.g.all %>% filter(List == "List1")
p12.L.rt.g.L2 <- p12.L.rt.g.all %>% filter(List == "List2")
# p12.L.rt.g.all %>% kable(digit=2)
```

**목록 1 반응시간**
```{r L1_rt_summary_table}
p12.L.rt.g.L1 %>% kable(digits=2)
```

**목록 2 반응시간**
```{r L2_rt_summary_table}
p12.L.rt.g.L2 %>% kable(digits=2)
```


**물체 목록에 따른 집단별 반응시간 그래프**
```{r L1&2_rt_plot, fig.width= 12, fig.height=6}
p12.L.rt.g.L1.plot1 <- ggplot(data=p12.L.rt.g.L1 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        legend.key = element_blank())

p12.L.rt.g.L2.plot1 <- ggplot(data=p12.L.rt.g.L2 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 1, 1, "cm"),
        legend.key = element_blank())

d12_asc_rt_Main<- ggpubr::ggarrange(p12.L.rt.g.L1.plot1, p12.L.rt.g.L2.plot1, nrow = 1, ncol=2, 
                                labels=c("A. List 1","B. List 2"),
                                hjust = -0.05, vjust=1, font.label = list(size = 20))
d12_asc_rt_Main
```

<br>
  
##### 혼합 요인 분산 분석 - 전체 블록

<br>
  
두 집단의 물체 목록에 블록 반복에 따른 연합 기억 반응시간 변화를 살펴보기 위해 참가자 간 변인인 집단과 참가자 내 변인인 목록 및 블록 반복을 요인으로 2 X 2 X 4 혼합 요인 분산분석을 수행하였다.

```{r L1&2_rt_anova, warning=FALSE, message=FALSE}
p12.L.rt.long.all$Btw <- factor(p12.L.rt.long.all$Btw, labels=c("Experimental", "Control"))
p12.rt.aov <- aov_ez(id = "SN", dv = "RT", data = p12.L.rt.long.all, between = "Btw", within = c("List","Block"))
# test_levene(p12.rt.aov)
# test_sphericity(p12.rt.aov)
anova(p12.rt.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 블록 반복의 주효과가 유의하였다.

```{r L1&2_rt_post-hoc, warning=FALSE, message=FALSE}
p12.rt.m1 <- emmeans(p12.rt.aov, c("Block"), by = c("Btw","List"), type = "response")
p12.rt.m1.pair <- update(pairs(p12.rt.m1), by = "Btw", adjust = "tukey")
p12.rt.m1.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

집단과 목록에서 블록에 의한 차이를 사후 분석한 결과, 두 집단 모두 각 목록에서 블록 반복에 따라 정확도가 향상되었다.

```{r L1&2_rt_post-hoc_plot, L1&2_acc_fig, fig.width= 12, fig.height=5}
plot(p12.rt.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

사후 분석 결과, 두 집단 모두 각 목록에서 반복에 따라 반응속도가 향상되었다. 

<br>

##### 혼합 요인 분산 분석 - 블록 4

<br>
  
두 집단의 물체 목록에서 마지막 블록의 연합 기억 반응시간 변화를 살펴보기 위해 참가자 간 변인인 집단과 참가자 내 변인인 목록을 요인으로 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r L1&2_b4_rt_anova, warning=FALSE, message=FALSE}
p12.L.rt.long.b4.all <- p12.L.rt.long.all %>% filter(Block=="b4")
p12.b4.rt.aov <- aov_ez(id = "SN", dv = "RT", data = p12.L.rt.long.b4.all, 
                      between = "Btw", within = c("List"))
# test_levene(p12.b4.rt.aov)
# test_sphericity(p12.b4.rt.aov)
anova(p12.b4.rt.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

```{r L1&2_b4_rt_post-hoc, warning=FALSE, message=FALSE}
p12.b4.rt.m1 <- emmeans(p12.b4.rt.aov, c("List","Btw"), by = NULL, type = "response")
p12.b4.rt.m1.pair <- update(pairs(p12.b4.rt.m1), by = NULL, adjust = "tukey")
p12.b4.rt.m1.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

사후 분석 결과, 모든 비교에서 통계적으로 유의한 차이가 나타나지 않았다.

```{r L1&2_b4_rt_post-hoc_plot, L1&2_b4_acc_fig, fig.width= 12, fig.height=5}
plot(p12.b4.rt.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

##### 일반화 선형 혼합 모형; GLMM - 블록 4

<br>
  
분산 분석 결과를 보충하기 위해 블록 4의 연합 기억 반응시간에 대하여 일반화 선형 혼합 모형(일반화 선형 혼합 모형; GLMM)을 검증하였다. 편포를 보이는 반응시간 분포를 고려하여 반응시간 분포에 적합한 inverse Gaussian distribution과 RT와 predictors 간의 linear relationship(identity link function)을 가정한 일반화 선형 혼합 모형 `p12.b4.RT.Model`을 구성하였다(Lo & Andrews, 2015). 집단과 목록의 고정 효과(fixed effect)와 참가자와 자극 항목에 대한 무선 절편을 무선 효과(random effect)로 포함하였다.

<br>

```{r L1&2_b4_rt_GLMM, eval=FALSE, eval=FALSE}
p12.b4.rt <- sp12.all %>% filter(Block=="b4")
p12.b4.rt$Block <- factor(p12.b4.rt$Block)
p12.b4.rt$Btw <- factor(p12.b4.rt$Btw, labels=c("Experimental", "Control"))


(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p12.b4.RT.Model.1 <- afex::mixed(RT ~ Btw*List + (1|SN) + (1|IMname), 
                           p12.b4.rt, method = "LRT", cl = cl, expand_re=T, 
                           family=inverse.gaussian(link="identity"),
                           control = glmerControl(optimizer = "bobyqa", 
                                                  optCtrl = list(maxfun = 1e6)))

save(p12.b4.RT.Model.1, file="L1&2b4_RT_afex.Rdata")

stopCluster(cl)
```

```{r L1&2_b4_rt_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/L1&2b4_RT_afex.Rdata")
```

```{r L1&2_b4_rt_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p12.b4.RT.Model.1) %>% kable(digits=3)
```

분석 결과, 목록의 주효과, 집단과 목록의 상호작용이 유의하였다.

```{r L1&2_b4_rt_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p12.b4.rt.m2 <- emmeans(p12.b4.RT.Model.1, c("List","Btw"), by = NULL, type = "response")
p12.b4.rt.m2.pair <- update(pairs(p12.b4.rt.m2), by = NULL, adjust = "tukey")
p12.b4.rt.m2.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`의 `목록 2` 반응시간이 `목록 1`보다 우수한 것으로 나타났다.

```{r L1&2_b4_rt_glmm_post-hoc_plot, eval=F, fig.width= 12, fig.height=5, warning=F, message=F}
plot(p12.b4.rt.m2, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

목록 1 연합 기억 검사의 정확도와 반응시간을 집단별로 함께 나타난 그래프는 아래와 같다.



#### 목록 1 & 2의 연합 학습 수행 그래프

연합 학습 수행 검사의 정확도와 반응시간을 목록별로 함께 나타난 그래프는 아래와 같다.


```{r L1&2_Fig.ACC&RT, fig.width = 8, fig.height = 6}

p12.L.g.L1.plot1 <- ggplot(data=p12.L.g.L1, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())

p12.L.g.L2.plot1 <- ggplot(data=p12.L.g.L2, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())

p12.L.rt.g.L1.plot1 <- ggplot(data=p12.L.rt.g.L1 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())

p12.L.rt.g.L2.plot1 <- ggplot(data=p12.L.rt.g.L2 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())


d12_asc_all_Main<- ggpubr::ggarrange(p12.L.g.L1.plot1, p12.L.g.L2.plot1, p12.L.rt.g.L1.plot1, p12.L.rt.g.L2.plot1, 
                             nrow = 2, ncol=2, labels=c("A. List 1","B. List 2"," "," "),
                             hjust = -0.05, vjust=1, font.label = list(size = 20))
d12_asc_all_Main
# ggsave("d12_asc_all_Main.jpg", plot = d12_asc_all_Main, width=8, height=6, unit='in', dpi=600)

```

<br>

****

<br>
  
## Day 3 출처 기억 및 연합 기억 검사

<br>

```{r d3_data_preparation, collapse=TRUE}
## load data
p3 <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3$SN = factor(p3$SN); p3$Btw = factor(p3$Btw)
p3$cSrc = factor(p3$cSrc, levels=c(1,2,3),  labels=c("List_1","List_2","List_3"))
p3$cCue = factor(p3$cCue, levels=c(1,2,3,0), labels=c("cc1","cc2","cc3","cc0"))
p3$cPE = factor(p3$cPE, levels=c(1,2,3,0), labels=c("pe1","pe2","pe3","pe0"))
p3$CueName = factor(p3$CueName, labels=c("c0","c1","c2","c3"))
p3$Resp <- factor(p3$Resp, levels=c(1,2,3), labels=c("Day_1", "Day_2", "New"))
p3$Correct <- as.numeric(p3$Corr==1); p3$Int <- as.numeric(p3$Corr==3); 
p3$Err <- as.numeric(p3$Corr==2); p3$sErr <- as.numeric(p3$Corr==3 | p3$Corr==2); 
p3$Incorr <- as.numeric(p3$Corr==0); p3$aCorr <- as.numeric(p3$aCorr==1);
p3 <- p3 %>% unite(cSrc_Resp, c(cSrc,Resp), remove=FALSE) %>% rename(tRsp = "cSrc_Resp")
p3$tRsp[p3$tRsp=='List_1_Day_1'] <- 'List 1 Correct'
p3$tRsp[p3$tRsp=='List_2_Day_2'] <- 'List 2 Correct'
p3$tRsp[p3$tRsp=='List_1_Day_2'] <- 'Source Confusion'
p3$tRsp[p3$tRsp=='List_2_Day_1'] <- 'Intrusion'
p3$tRsp[p3$tRsp=='List_1_New'] <- 'List 1 Miss'
p3$tRsp[p3$tRsp=='List_2_New'] <- 'List 2 Miss'
p3$tRsp[p3$tRsp=='List_3_New'] <- 'List 3 Correct'
p3$tRsp[p3$tRsp=='List_3_Day_1'] <- 'List 3 FA - Day 1'
p3$tRsp[p3$tRsp=='List_3_Day_2'] <- 'List 3 FA - Day 2'
p3$tRsp <- factor(p3$tRsp, levels=c('List 1 Correct', 'List 2 Correct', 'Source Confusion',
                                    'Intrusion', 'List 1 Miss', 'List 2 Miss',
                                    'List 3 Correct', 'List 3 FA - Day 1', 'List 3 FA - Day 2'))
p3 <- p3 %>% select(SN, Btw, Trial, tRsp, cSrc, cCue, cPE, IMname, Resp, Corr, Conf, 
                    aResp, aCorr, aConf, Correct, Int, Err, Incorr)

glimpse(p3, width = 70)

# 1. SN: participant ID
# 2. Btw: between-participants factor. 1-experimental group, 2-control group
# 3. Trial: 1 ~ 360
# 4. tRsp: type of source response
# 5. cSrc: learning source of stimuli. List_1 - day1, List_2 - day2, New - lure
# 6. cCue: association color cue condition. cc1 - cue 1, cc2 - cue 2, cc3 - cue 3, cc0 - lure
# 7. cPE: prediction error condition. pe1 - 0%, pe2 - 50%, pe3 - 100%, pe0 - no pe/lure
# 8. IMname: name of stimuli
# 9. Resp: source response (learning day/list)
# 10. Corr: source response type. 1-correct, 2-source confusion, 3-intrusion, 0-incorrect
# 11. Conf: source response confidence. 1-4
# 12. aResp: association response
# 13. aCorr: correctness of association response 
# 14. aConf: association response confidence. 1-4
# 15. Correct: correct response of source memory (List1>D1, List2>D2, List3>new)
# 16. Int: intrusion response of source memory (List2>D1)
# 17. err: source confusion response of source memory (List1>D2)
# 18. Incorr: incorrect response of source memory (List1&2>new, List3>day1&2)

length(unique(p3$SN))
length(unique(p3$SN[p3$Btw==1])) # the number of participants of experimental group
length(unique(p3$SN[p3$Btw==2])) # the number of participants of control group
table(p3$SN)
```

<br><br>

### Day 3 출처 기억 반응 분석

<br>

셋째 날 출처 및 연합 기억 검사에서 물체 목록에 대한 출처 기억 반응 패턴을 분석하였다. 출처 반응은 주요 종속 변인인 **목록 1 정확반응 (List 1 Correct, L1→D1)**, **목록 2 정확반응 (List 2 Correct, L2→D2)**, **출처 혼동 (Source Confusion, L1→D2)**, **침범 (Intrusion, L2→D1)** 과 부차적인 변인인 **목록 3 정확반응 (List 3 Correct, L3→New)**, **목록 3 오경보 1과 2 (List 3 False Alarm - Day 1&2, L3→D1&2)**, **목록 1 & 2 누락 (Miss, L1&2→New)**으로 구분되어 분석되었다.

<br>

#### 출처 반응의 기술통계

<br>

두 집단의 물체 목록에 따른 출처 반응 패턴을 표로 나타내었다. **List 3 Correct**, **List 3 False Alarm**, **List 1&2 Miss**는 두 집단 모두에서 천장 효과와 바닥 효과를 보였다. 따라서 이 반응들은 분석에 포함하지 않았다.

```{r d3_src_asyptt_summary, warning= FALSE, message=FALSE}
# phase 1, subject-level, long-format
p3.AsyPtt.long.all <- p3 %>%  group_by(SN, Btw, cSrc, Resp) %>%
  summarise(Rsp = length(Resp)/90*100) %>% ungroup()
p3.AsyPtt.wide.all <- p3.AsyPtt.long.all %>% spread(key = Resp, value = Rsp)
p3.AsyPtt.long.all <- gather(p3.AsyPtt.wide.all, Resp, Rsp, Day_1:New, factor_key=TRUE)
p3.AsyPtt.long.all[is.na(p3.AsyPtt.long.all)] <- 0 
p3.AsyPtt.long.all <- arrange(p3.AsyPtt.long.all, SN, cSrc, Resp, Rsp)
p3.AsyPtt.long.exp <- p3.AsyPtt.long.all %>% filter(Btw==1)
p3.AsyPtt.long.con <- p3.AsyPtt.long.all %>% filter(Btw==2)

# wide format
p3.AsyPtt.swide.all <- p3.AsyPtt.long.all %>% spread(key = Resp, value = Rsp)
p3.AsyPtt.swide.exp <- p3.AsyPtt.swide.all %>% filter(Btw==1)
p3.AsyPtt.swide.con <- p3.AsyPtt.swide.all %>% filter(Btw==2)

# summary table
p3.AsyPtt.g.all <- p3.AsyPtt.long.all %>% group_by(Btw, cSrc, Resp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all, measurevar = "Rsp", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cSrc","Resp"))$se
p3.AsyPtt.g.all$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all, measurevar = "Rsp", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cSrc","Resp"))$ci
p3.AsyPtt.g.exp <- p3.AsyPtt.g.all %>% filter(Btw==1)
p3.AsyPtt.g.con <- p3.AsyPtt.g.all %>% filter(Btw==2)

p3.AsyPtt.g.table <- p3.AsyPtt.g.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(Src_Resp = "cSrc_Resp")
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_1_New'] <- 'List 1 Miss'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_2_New'] <- 'List 2 Miss'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_3_New'] <- 'List 3 Correct'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_3_Day_1'] <- 'List 3 FA - Day 1'
p3.AsyPtt.g.table$Src_Resp[p3.AsyPtt.g.table$Src_Resp=='List_3_Day_2'] <- 'List 3 FA - Day 2'
srt <- c(1, 3, 5, 4, 2, 6, 8, 9, 7)
p3.AsyPtt.g.table.1 <- p3.AsyPtt.g.table %>% filter(Btw == 1) %>% arrange(srt)
p3.AsyPtt.g.table.2 <- p3.AsyPtt.g.table %>% filter(Btw == 2) %>% arrange(srt)
p3.AsyPtt.g.table.all <- rbind(p3.AsyPtt.g.table.1, p3.AsyPtt.g.table.2)
p3.AsyPtt.g.table.all$Btw <- factor(p3.AsyPtt.g.table.all$Btw, levels = c(1,2), labels=c("Experimental", "Control"))
p3.AsyPtt.g.table.all %>% kable(digits=2)
```

<br>

#### 출처 반응의 비대칭적 패턴

<br>

두 집단의 물체 목록에 따른 출처 반응 패턴을 그래프로 나타내었다. 그래프에서 A는 전체 집단의 물체 목록에 따른 출처 반응, B는 실험 집단, C는 통제집단을 나타낸다. A 그래프에서 x축은 물체 목록에 따른 출처 반응, y축은 반응 비율을 나타내며, 색은 각 집단을 나타낸다. B,C 그래프의 x축은 각 학습일에 학습한 물체 목록(첫째 날 학습 `목록 1`, 둘째 날 학습 `목록 2`, 새로운 물체 `목록 3`)을 나타내며, y축은 반응의 비율을 나타낸다. 각 집단에서 해당 물체 목록에 대한 출처 귀인 반응을 첫째 날 학습 `Day 1`, 둘째 날 학습 `Day 2`, 학습하지 않음 `New`로 구분하였다. 모든 그래프에서 빨간 점은 평균을 나타내며, 오차 막대는 95% 신뢰구간으로 표시하였다.

```{r d3_src_asyptt_plot, fig.width= 10, fig.height=12}
## plot
p3.AsyPtt.long.all.p2 <- p3.AsyPtt.long.all %>% filter(cSrc != "List_3", Resp != "New")
p3.AsyPtt.g.all.p2 <- p3.AsyPtt.g.all %>% filter(cSrc != "List_3", Resp != "New")
p3.all.plot1 <- ggplot(data=p3.AsyPtt.long.all.p2, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.g.all.p2, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        legend.position=c(0.8, 0.85))

p3.exp.plot1 <- ggplot(data=p3.AsyPtt.long.exp, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=Rsp, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.22, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_1")$"Day_1",
                   xend=1, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_1")$"Day_2",
                   xend=1+.22, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_1")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.22, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_2")$"Day_1",
                   xend=2, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_2")$"Day_2",
                   xend=2+.22, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_2")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_3"), inherit.aes = FALSE,
               aes(x=3-.22, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_3")$"Day_1",
                   xend=3, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_3")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.exp,cSrc=="List_3"), inherit.aes = FALSE,
               aes(x=3, y=filter(p3.AsyPtt.swide.exp,cSrc=="List_3")$"Day_2",
                   xend=3+.22, yend=filter(p3.AsyPtt.swide.exp,cSrc=="List_3")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.g.exp, aes(x = cSrc, y = Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00","#56b4e9", "#ff6164"),
                    labels = c("Day 1", "Day 2", "New")) +
  scale_x_discrete(labels = c("List 1", "List 2", "List 3")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")
p3.con.plot1 <- ggplot(data=p3.AsyPtt.long.con, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=Rsp, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.22, y=filter(p3.AsyPtt.swide.con,cSrc=="List_1")$"Day_1",
                   xend=1, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1, y=filter(p3.AsyPtt.swide.con,cSrc=="List_1")$"Day_2",
                   xend=1+.22, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_1")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.22, y=filter(p3.AsyPtt.swide.con,cSrc=="List_2")$"Day_1",
                   xend=2, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2, y=filter(p3.AsyPtt.swide.con,cSrc=="List_2")$"Day_2",
                   xend=2+.22, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_2")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_3"), inherit.aes = FALSE,
               aes(x=3-.22, y=filter(p3.AsyPtt.swide.con,cSrc=="List_3")$"Day_1",
                   xend=3, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_3")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.swide.con,cSrc=="List_3"), inherit.aes = FALSE,
               aes(x=3, y=filter(p3.AsyPtt.swide.con,cSrc=="List_3")$"Day_2",
                   xend=3+.22, yend=filter(p3.AsyPtt.swide.con,cSrc=="List_3")$"New", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.g.con, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00","#56b4e9", "#ff6164"),
                    labels = c("Day 1", "Day 2", "New")) +
  scale_x_discrete(labels = c("List 1", "List 2", "List 3")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")

ggpubr::ggarrange(p3.all.plot1, labels = "A) All Group",
          ggpubr::ggarrange(p3.exp.plot1, p3.con.plot1, ncol = 2, labels = c("B) Experimental Group", "C) Control Group"), 
                    hjust = -0.1, vjust=1, font.label = list(size = 16)), nrow = 2, 
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>

##### 목록 1, 목록 2의 출처 반응 오류 분석
  
<br>
  
###### 혼합 요인 분산 분석
  
<br>
  
  기억 갱신 효과를 반영하는 비대칭적 출처 반응 패턴을 살펴보기 위해, `목록 1`과 `목록 2`에서의 학습 출처 오류를 살펴보았다. 

```{r d3_src_asyptt_L1&2err_summary, warning=FALSE, message=FALSE}
# List 1 & 2 Incorrect Source Response
p3.AsyPtt.long.all.2 <- p3.AsyPtt.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp")
p3.AsyPtt.long.all.2$sResp[p3.AsyPtt.long.all.2$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.long.all.2$sResp[p3.AsyPtt.long.all.2$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.long.all.2$sResp[p3.AsyPtt.long.all.2$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.long.all.2$sResp[p3.AsyPtt.long.all.2$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.long.all.2$sResp <- factor(p3.AsyPtt.long.all.2$sResp)
p3.AsyPtt.long.all.2 <- p3.AsyPtt.long.all.2 %>% filter(sResp %in% c("Source Confusion", "Intrusion"))

p3.AsyPtt.g.all.2 <- p3.AsyPtt.long.all.2 %>% group_by(Btw, sResp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all.2$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.2, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$se
p3.AsyPtt.g.all.2$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.2, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$ci
p3.AsyPtt.g.all.2 %>% kable(digit=2)
```

**Source Confusion (L1>D2)** 과 **Intrusion (L2>D1)**에서 집단 간, 집단 내의 차이를 분석하기 위해 집단과 물체 목록에서의 출처 오류를 요인으로 한 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r d3_src_asyptt_L1&2err_anova, warning=F, message=F}
p3.AsyPtt.all.2.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.all.2, between = "Btw", within = "sResp")
anova(p3.AsyPtt.all.2.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 출처 반응의 주효과가 유의하였다. 집단의 주효과와 집단과 출처 반응의 상호작용은 유의하지 않았다.
사후 분석으로 각 집단 내의 출처 오류와 집단 간의 출처 오류 차이를 살펴보았다. 
 
```{r d3_src_asyptt_L1&2err_anova_post-hoc, warning=FALSE, message=FALSE} 
# source response contrast
p3.AsyPtt.m2.1.all <- emmeans(p3.AsyPtt.all.2.aov, "sResp", by = "Btw", type = "response")
p3.AsyPtt.m2.1.all.pair <- update(pairs(p3.AsyPtt.m2.1.all), by = NULL, adjust = "tukey")
p3.AsyPtt.m2.1.all.pair %>% summary(infer = TRUE) %>% kable(digits=3)

# group contrast
p3.AsyPtt.m2.2.all <- emmeans(p3.AsyPtt.all.2.aov, "Btw", by = "sResp", type = "response")
p3.AsyPtt.m2.2.all.pair <- update(pairs(p3.AsyPtt.m2.1.all), by = NULL, adjust = "tukey")
p3.AsyPtt.m2.2.all.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

출처 반응에 따른 사후 분석을 수행한 결과, `실험 집단`에서 **Source Confusion (L1>D2)**이 **Intrusion (L2>D1)**보다 유의하게 낮은 비대칭적 출처 오귀인 패턴을 보였다. `통제 집단`에서는 **Source Confusion (L1>D2)**과 **Intrusion (L2>D1)**의 차이가 유의하지 않았다.
각 출처 반응에서 집단 간의 차이에 대한 사후 분석 결과, `실험 집단`이 `통제 집단`보다 높은 **Intrusion (L2>D1)**을 보이는 경향이 나타났다. 그러나 분산 분석에서 집단과 출처 반응 간의 상호작용이 유의하지 않았다는 것을 고려할 필요가 있다.

```{r d3_src_asyptt_L1&2err_anova_plot, warning=F, message=F, fig.width= 12, fig.height=5}
p3.AsyPtt.m2.3.all <- emmeans(p3.AsyPtt.all.2.aov, c("sResp","Btw"), by = NULL, type = "response")
plot(p3.AsyPtt.m2.3.all, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

###### 일반화 선형 혼합 모형; GLMM

<br>

집단과 물체 목록에서의 **Source Confusion (L1>D2)**, **Intrusion (L2>D1)** 출처 반응을 일반화 선형 혼합 모형으로 검증하였다.

```{r d3_src_asyptt_L1&2err_GLMM_prep, eval=FALSE, warning=FALSE, message=FALSE}
p3.sErr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.sErr <- p3.sErr %>% filter(cSrc != 3)
p3.sErr$SN = factor(p3.sErr$SN); 
p3.sErr$Btw = factor(p3.sErr$Btw, levels=c(1,2), labels=c("Experimental", "Control"))
p3.sErr$cSrc = factor(p3.sErr$cSrc, labels=c("List_1", "List_2"))
p3.sErr$Resp <- factor(p3.sErr$Resp, levels=c(1,2,3), labels=c("Day_1", "Day_2", "New"))
p3.sErr$sErr <- as.numeric(p3.sErr$Corr==3 | p3.sErr$Corr==2);
p3.sErr$sincor <- as.numeric(p3.sErr$Corr==0)
```

```{r d3_src_asyptt_L1&2err_GLMM, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.src.sErr.Model.1 <- afex::mixed(sErr ~ Btw*cSrc + (1|SN) + (1|IMname),
                             p3.sErr, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.src.sErr.Model.1 , file="d3_src_sErr_afex.Rdata")
stopCluster(cl)
```

```{r d3_src_asyptt_L1&2err_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/d3_src_sErr_afex.Rdata")
```

```{r d3_src_asyptt_L1&2err_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.src.sErr.Model.1) %>% kable(digit=3)
```

분석 결과, 출처 반응의 주효과, 집단과 출처 반응의 상호작용이 유의하였다.

```{r d3_src_asyptt_L1&2err_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p3.src.sErr.m1 <- emmeans(p3.src.sErr.Model.1, c("cSrc"), by = "Btw", type = "response")
p3.src.sErr.m1.pair <- update(pairs(p3.src.sErr.m1), by = NULL, adjust= "tukey")
p3.src.sErr.m1.pair %>% summary(infer = TRUE) %>% kable(digits=3)

p3.src.sErr.m2 <- emmeans(p3.src.sErr.Model.1, c("Btw"), by = "cSrc", type = "response")
p3.src.sErr.m2.pair <- update(pairs(p3.src.sErr.m2), by = NULL, adjust= "tukey")
p3.src.sErr.m2.pair %>% summary(infer = TRUE) %>% kable(digits=3)

p3.src.sErr.m3 <- emmeans(p3.src.sErr.Model.1, c("cSrc","Btw"), by = NULL, type = "response")
p3.src.sErr.m3.pair <- update(pairs(p3.src.sErr.m3), by = NULL, adjust= "tukey")
p3.src.sErr.m3.pair %>% summary(infer = TRUE) %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`에서 **Source Confusion (L1>D2)**이 **Intrusion (L2>D1)**보다 유의하게 낮은 비대칭적 출처 오귀인 패턴을 보였다. `통제 집단`에서는 **Source Confusion (L1>D2)**과 **Intrusion (L2>D1)**의 차이가 유의하지 않았다. 또한, `실험 집단`은 `통제 집단`보다 유의하게 높은 **Intrusion (L2>D1)** 수준을 보였다. 그러나 이 차이는 상호작용의 모든 비교에 대한 사후 분석에서는 나타나지 않았다.

```{r d3_src_asyptt_L1&2err_GLMM_plot, eval=F, warning=F, message=F, fig.width= 12, fig.height=5}
plot(p3.src.sErr.m3, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>


##### 목록 1, 목록 2 출처 반응 정확도
  
<br>
  
###### 혼합 요인 분산 분석
  
<br>
  
 `목록 1`, `목록 2`의 출처 반응 정확도에서 집단과 정확 출처 반응에 따른 차이를 분석하였다. 

```{r  d3_src_asyptt_L1&2corr_summary, warning=FALSE, message=FALSE}
# List 1 & 2 & 3 Correct Source Response
p3.AsyPtt.long.all.1 <- p3.AsyPtt.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp") 
p3.AsyPtt.long.all.1$sResp[p3.AsyPtt.long.all.1$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.long.all.1$sResp[p3.AsyPtt.long.all.1$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.long.all.1$sResp[p3.AsyPtt.long.all.1$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.long.all.1$sResp[p3.AsyPtt.long.all.1$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.long.all.1$sResp <- factor(p3.AsyPtt.long.all.1$sResp)
p3.AsyPtt.long.all.1 <- p3.AsyPtt.long.all.1 %>% filter(sResp %in% c("List 1 Correct", "List 2 Correct"))
p3.AsyPtt.long.all.1$Btw <- factor(p3.AsyPtt.long.all.1$Btw, levels=c(1,2), labels=c("Experimental","Control"))

p3.AsyPtt.g.all.1 <- p3.AsyPtt.long.all.1 %>% group_by(Btw, sResp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all.1$Rsp <- p3.AsyPtt.g.all.1$Rsp.M
p3.AsyPtt.g.all.1$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.1, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$se
p3.AsyPtt.g.all.1$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.1, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$ci
p3.AsyPtt.g.all.1 %>% kable(digit=2)
```

집단과 정확 출처 반응을 요인으로 한 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r d3_src_asyptt_L1&2corr_anova, warning=F, message=F}
p3.AsyPtt.all.1.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.all.1, between = "Btw", within = "sResp")
anova(p3.AsyPtt.all.1.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 출처 반응의 주효과가 유의하였다.

```{r d3_src_asyptt_L1&2corr_anova_post-hoc, warning=FALSE, message=FALSE}
p3.AsyPtt.m1.1.all <- emmeans(p3.AsyPtt.all.1.aov, "sResp", by = "Btw", type = "response")
p3.AsyPtt.m1.1.all.pair <- update(pairs(p3.AsyPtt.m1.1.all), by = NULL, adjust = "tukey")
p3.AsyPtt.m1.1.all.pair %>% summary(infer=T) %>% kable(digits=3)
```

각 집단에서 출처 반응에 따른 사후 분석 결과, `실험 집단`에서 **List 1 Correct**는 **List 2 Correct**보다 유의하게 높은 정확도를 보였다. 

```{r d3_src_asyptt_L1&2corr_anova_plot, warning=F, message=F, fig.width= 12, fig.height=5}
plot(p3.AsyPtt.m1.1.all, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

###### 일반화 선형 혼합 모형; GLMM

<br>

분산 분석 결과를 보충하기 위해 일반화 선형 혼합 모형으로 검증하였다. 집단, 정확 출처 반응을 고정 효과로 하고 참가자와 자극에 대한 무선 효과로 포함한 일반화 선형 혼합 모형 `p3.src.corr.Model`을 구성하였다. 

```{r d3_src_asyptt_L1&2corr_GLMM_prep, eval=FALSE, warning=FALSE, message=FALSE}
p3.sCorr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.sCorr <- p3.sCorr %>% filter(cSrc != 3, Resp != 3); p3.sCorr$SN = factor(p3.sCorr$SN)
p3.sCorr$Btw = factor(p3.sCorr$Btw, levels=c(1,2), labels=c("Experimental","Control"))
p3.sCorr$cSrc = factor(p3.sCorr$cSrc, labels=c("List_1", "List_2"))
p3.sCorr$Resp <- factor(p3.sCorr$Resp, levels=c(1,2), labels=c("Day_1", "Day_2"))
p3.sCorr$sCorr <- as.numeric(p3.sCorr$Corr==1);
```

```{r d3_src_asyptt_L1&2corr_GLMM, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.src.corr.Model.1 <- afex::mixed(sCorr ~ Btw*cSrc + (1|SN) + (1|IMname), 
                             p3.sCorr, method = "LRT", cl = cl, 
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.src.corr.Model.1, file="d3_src_corr_afex.Rdata")
stopCluster(cl)
```

```{r d3_src_asyptt_L1&2corr_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/d3_src_corr_afex.Rdata")
```

```{r d3_src_asyptt_L1&2corr_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.src.corr.Model.1) %>% kable(digit=3)
```

분석 결과, 출처 반응의 주효과, 집단과 출처 반응의 상호작용이 유의하였다.

```{r d3_src_asyptt_L1&2corr_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p3.src.corr.m1 <- emmeans(p3.src.corr.Model.1, "cSrc", by = "Btw", type = "response") 
p3.src.corr.m1.pair <- update(pairs(p3.src.corr.m1), by=NULL, adjust="tukey")
p3.src.corr.m1.pair %>% summary(infer=T) %>% kable(digits=3)

p3.src.corr.m2 <- emmeans(p3.src.corr.Model.1, "Btw", by = "cSrc", type = "response") 
p3.src.corr.m2.pair <- update(pairs(p3.src.corr.m2), by=NULL, adjust="tukey")
p3.src.corr.m2.pair %>% summary(infer=T) %>% kable(digits=3)

p3.src.corr.m3 <- emmeans(p3.src.corr.Model.1, c("cSrc", "Btw"), type = "response") 
p3.src.corr.m3.pair <- update(pairs(p3.src.corr.m3), by=NULL, adjust="tukey")
p3.src.corr.m3.pair %>% summary(infer=T) %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`에서 **List 1 Correct**는 **List 2 Correct**보다 유의하게 높은 정확도를 보였다. 또한, `실험집단`은 `통제집단`보다 유의하게 낮은 **List 2 Correct**를 보였다.

```{r d3_src_asyptt_L1&2corr_GLMM_plot, eval=F, warning=F, message=F, fig.width= 12, fig.height=5}
plot(p3.src.corr.m3, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())
```

<br>

##### 기타 분석

###### 목록 1, 목록 2의 누락 출처 반응
  
<br>

두 집단에서 **List 1 Miss**와 **List 2 Miss**의 차이를 분석하기 위해 집단과 반응을 요인으로한 2 X 2 혼합 요인 분산 분석을 수행하였다.

```{r d3_src_asyptt_L1&2miss_summary&anova, warning=FALSE, message=FALSE}
# List 1 & 2 Error
p3.AsyPtt.long.all.3 <- p3.AsyPtt.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp")
p3.AsyPtt.long.all.3$sResp[p3.AsyPtt.long.all.3$sResp=='List_1_New'] <- 'List 1 Miss'
p3.AsyPtt.long.all.3$sResp[p3.AsyPtt.long.all.3$sResp=='List_2_New'] <- 'List 2 Miss'
p3.AsyPtt.long.all.3$sResp <- factor(p3.AsyPtt.long.all.3$sResp)
p3.AsyPtt.long.all.3 <- p3.AsyPtt.long.all.3 %>% filter(sResp %in% c("List 1 Miss", "List 2 Miss"))

p3.AsyPtt.g.all.3 <- p3.AsyPtt.long.all.3 %>% group_by(Btw, sResp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all.3$Rsp <- p3.AsyPtt.g.all.2$Rsp.M
p3.AsyPtt.g.all.3$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.3, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$se
p3.AsyPtt.g.all.3$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.3, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$ci
p3.AsyPtt.g.all.3 %>% kable(digit=2)

p3.AsyPtt.all.3.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.all.3, between = "Btw", within = "sResp")
anova(p3.AsyPtt.all.3.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

###### 목록 3 정확반응

<br>

두 집단 간의 **List 3 Correct**를 비교하였다.

```{r d3_src_asyptt_L3corr_summary&anova, warning=FALSE, message=FALSE}
# List 3 Correct
p3.AsyPtt.long.all.4 <- p3.AsyPtt.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp")
p3.AsyPtt.long.all.4$sResp[p3.AsyPtt.long.all.4$sResp=='List_3_New'] <- 'List 3 Correct'
p3.AsyPtt.long.all.4$sResp <- factor(p3.AsyPtt.long.all.4$sResp)
p3.AsyPtt.long.all.4 <- p3.AsyPtt.long.all.4 %>% filter(sResp %in% c("List 3 Correct"))

p3.AsyPtt.g.all.4 <- p3.AsyPtt.long.all.4 %>% group_by(Btw) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all.4$Rsp.se <- Rmisc::summarySE(data = p3.AsyPtt.long.all.4, 
                                                   measurevar = "Rsp", groupvars = "Btw")$se
p3.AsyPtt.g.all.4$Rsp.ci <- Rmisc::summarySE(data = p3.AsyPtt.long.all.4, 
                                                   measurevar = "Rsp", groupvars = "Btw")$ci
p3.AsyPtt.g.all.4 %>% kable(digit=2)

p3.AsyPtt.all.4.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.all.4, between = "Btw")
anova(p3.AsyPtt.all.4.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, **List 3 Correct**에서 두 집단 간의 차이는 유의하지 않았다.

<br>

###### 목록 3에서의 오경보
  
<br>
  
**List 3 FA - Day 1**과 **List 3 FA - Day 2**에서 집단과 출처 반응을 요인으로 한 2 X 2 혼합 요인 분산 분석을 수행하였다.

```{r d3_src_asyptt_L3FA_summary&anova, warning=FALSE, message=FALSE}
# List 3 Incorrect Source Response 
p3.AsyPtt.long.all.5 <- p3.AsyPtt.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp")
p3.AsyPtt.long.all.5$sResp[p3.AsyPtt.long.all.5$sResp=='List_3_Day_1'] <- 'List 3 FA - D1'
p3.AsyPtt.long.all.5$sResp[p3.AsyPtt.long.all.5$sResp=='List_3_Day_2'] <- 'List 3 FA - D2'
p3.AsyPtt.long.all.5$sResp <- factor(p3.AsyPtt.long.all.5$sResp)
p3.AsyPtt.long.all.5 <- p3.AsyPtt.long.all.5 %>% filter(sResp %in% c("List 3 FA - D1", "List 3 FA - D2"))

p3.AsyPtt.g.all.5 <- p3.AsyPtt.long.all.5 %>% group_by(Btw, sResp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.all.5$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.5, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$se
p3.AsyPtt.g.all.5$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.all.5, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = "sResp")$ci
p3.AsyPtt.g.all.5 %>% kable(digit=2)

p3.AsyPtt.all.5.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.all.5, between = "Btw", within = "sResp")
anova(p3.AsyPtt.all.5.aov, es = "pes") %>% kable(digits=3)

```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

#### 예측 오류 정도와 기억 갱신 간의 관계

<br>

##### 예측 오류 정도에 따른 비대칭적 출처 오귀인 패턴

<br>

```{r d3_src_byPe_preparation}
p3.AsyPtt.long.pe <- p3 %>%  group_by(SN, Btw, cSrc, cPE, Resp) %>%
  summarise(Rsp = length(Resp)/30*100) %>% ungroup()
p3.AsyPtt.wide.pe <- p3.AsyPtt.long.pe %>% spread(key = Resp, value = Rsp)
p3.AsyPtt.long.pe <- gather(p3.AsyPtt.wide.pe, Resp, Rsp, Day_1:New, factor_key=TRUE)
p3.AsyPtt.long.pe[is.na(p3.AsyPtt.long.pe)] <- 0 
p3.AsyPtt.long.pe <- arrange(p3.AsyPtt.long.pe, SN, cSrc, cPE, Resp, Rsp)
p3.AsyPtt.long.pe <- p3.AsyPtt.long.pe %>% filter(cSrc != "List_3", Resp != "New", cPE!="pe0")
p3.AsyPtt.long.pe.exp <- p3.AsyPtt.long.pe %>% filter(Btw==1)
p3.AsyPtt.long.pe.con <- p3.AsyPtt.long.pe %>% filter(Btw==2)

# wide format
p3.AsyPtt.swide.pe <- p3.AsyPtt.long.pe %>% spread(key = Resp, value = Rsp)
p3.AsyPtt.swide.pe.exp <- p3.AsyPtt.swide.pe %>% filter(Btw==1)
p3.AsyPtt.swide.pe.con <- p3.AsyPtt.swide.pe %>% filter(Btw==2)

# summary table
p3.AsyPtt.g.pe <- p3.AsyPtt.long.pe  %>% 
  group_by(Btw, cPE, cSrc, Resp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.pe$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.pe, measurevar = "Rsp", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cPE","cSrc","Resp"))$se
p3.AsyPtt.g.pe$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.pe, measurevar = "Rsp", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cPE","cSrc","Resp"))$ci
p3.AsyPtt.g.pe.exp <- p3.AsyPtt.g.pe %>% filter(Btw==1)
p3.AsyPtt.g.pe.con <- p3.AsyPtt.g.pe %>% filter(Btw==2)
# p3.AsyPtt.g.pe %>% kable(digits=2)
```

예측 오류 조건에 따른 출처 오귀인 패턴의 그래프를 나타내었다.

<br>

```{r d3_src_byPe_asyptt_plot, fig.width=18, fig.height=6}
p3.AsyPtt.long.pe1 <- p3.AsyPtt.long.pe %>% filter(cPE == "pe1")
p3.AsyPtt.g.all.pe1 <- p3.AsyPtt.g.pe %>% filter(cPE == "pe1")
p3.all.plot3.pe1 <- ggplot(data=p3.AsyPtt.long.pe1, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.g.all.pe1, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  # geom_point(data=p3.AsyPtt.g.all.pe1, aes(x = cSrc, y=Rsp.M),
  # position = position_dodge(0.80), color = "black", size = 5, show.legend = FALSE) +
  # geom_errorbar(data=p3.AsyPtt.g.all.pe1, aes(x=cSrc, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci), size = 1, width = .2, position = position_dodge(0.8)) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    # scale_fill_manual(values = c("#a3d8d7", "#ed9b5d"),#a3d8d7 #72c2c8
                    # scale_fill_manual(values = c("#feb24c", "#4292c6"),
                    # scale_fill_manual(values = c("#c6d9f1", "#254061"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))

p3.AsyPtt.long.pe2 <- p3.AsyPtt.long.pe %>% filter(cPE == "pe2")
p3.AsyPtt.g.all.pe2 <- p3.AsyPtt.g.pe %>% filter(cPE == "pe2")
p3.all.plot3.pe2 <- ggplot(data=p3.AsyPtt.long.pe2, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.g.all.pe2, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  # geom_point(data=p3.AsyPtt.g.all.pe2, aes(x = cSrc, y=Rsp.M),
  # position = position_dodge(0.80), color = "black", size = 5, show.legend = FALSE) +
  # geom_errorbar(data=p3.AsyPtt.g.all.pe2, aes(x=cSrc, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci), size = 1, width = .2, position = position_dodge(0.8)) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    # scale_fill_manual(values = c("#a3d8d7", "#ed9b5d"),#a3d8d7 #72c2c8
                    # scale_fill_manual(values = c("#feb24c", "#4292c6"),
                    # scale_fill_manual(values = c("#c6d9f1", "#254061"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))
p3.AsyPtt.long.pe3 <- p3.AsyPtt.long.pe %>% filter(cPE == "pe3")
p3.AsyPtt.g.all.pe3 <- p3.AsyPtt.g.pe %>% filter(cPE == "pe3")
p3.all.plot3.pe3 <- ggplot(data=p3.AsyPtt.long.pe3, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.g.all.pe3, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  # geom_point(data=p3.AsyPtt.g.all.pe3, aes(x = cSrc, y=Rsp.M),
  # position = position_dodge(0.80), color = "black", size = 5, show.legend = FALSE) +
  # geom_errorbar(data=p3.AsyPtt.g.all.pe3, aes(x=cSrc, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci), size = 1, width = .2, position = position_dodge(0.8)) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    # scale_fill_manual(values = c("#a3d8d7", "#ed9b5d"),#a3d8d7 #72c2c8
                    # scale_fill_manual(values = c("#feb24c", "#4292c6"),
                    # scale_fill_manual(values = c("#c6d9f1", "#254061"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))


ggpubr::ggarrange(p3.all.plot3.pe1, p3.all.plot3.pe2, p3.all.plot3.pe3, ncol=3, 
          labels = c("A) PE 1 (0%)", "B) PE 2 (50%)", "C) PE 3(100%)"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 

```
<br>

각 예측 오류 조건에서 **Source Confusion**과 **Intrusion** 간의 비대칭적 패턴에 대한 혼합 요인 분산분석을 수행하였다.

```{r d3_src_byPe_asyptt_preparation, warning=FALSE, message=FALSE}
p3.AsyPtt.long.pe.2 <- p3.AsyPtt.long.pe %>% unite(cSrc_Resp, c(cSrc,Resp), remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp")
p3.AsyPtt.long.pe.2$sResp[p3.AsyPtt.long.pe.2$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.long.pe.2$sResp[p3.AsyPtt.long.pe.2$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.long.pe.2$sResp[p3.AsyPtt.long.pe.2$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.long.pe.2$sResp[p3.AsyPtt.long.pe.2$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.long.pe.2$sResp <- factor(p3.AsyPtt.long.pe.2$sResp)
p3.AsyPtt.long.pe.2 <- p3.AsyPtt.long.pe.2 %>% filter(sResp %in% c("Source Confusion", "Intrusion"))
p3.AsyPtt.long.pe1.2 <- p3.AsyPtt.long.pe.2 %>% filter(cPE == "pe1")
p3.AsyPtt.long.pe2.2 <- p3.AsyPtt.long.pe.2 %>% filter(cPE == "pe2")
p3.AsyPtt.long.pe3.2 <- p3.AsyPtt.long.pe.2 %>% filter(cPE == "pe3")

p3.AsyPtt.g.pe.2 <- p3.AsyPtt.long.pe.2 %>% group_by(Btw, cPE, sResp) %>%
  summarise(Rsp.M = mean(Rsp), Rsp.SD = sd(Rsp)) %>% ungroup()
p3.AsyPtt.g.pe.2$Rsp.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.pe.2, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = c("cPE","sResp"))$se
p3.AsyPtt.g.pe.2$Rsp.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.long.pe.2, idvar = "SN",
                                                   measurevar = "Rsp", betweenvars = "Btw", withinvars = c("cPE","sResp"))$ci
p3.AsyPtt.g.pe1.2 <- p3.AsyPtt.g.pe.2 %>% filter(cPE =="pe1")
p3.AsyPtt.g.pe2.2 <- p3.AsyPtt.g.pe.2 %>% filter(cPE =="pe2")
p3.AsyPtt.g.pe3.2 <- p3.AsyPtt.g.pe.2 %>% filter(cPE =="pe3")
```

`PE 1` 조건에서의 분석 결과는 아래와 같다.

```{r d3_src_asyptt_PE1_anova}
p3.AsyPtt.g.pe1.2 %>% kable(digits=2)
p3.AsyPtt.pe1.2.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.pe1.2, between = "Btw", within = "sResp")
anova(p3.AsyPtt.pe1.2.aov, es = "pes") %>% kable(digits=3)
```

모든 효과가 유의하지 않았다.

```{r d3_src_asyptt_PE1_anova_posthoc}
p3.AsyPtt.pe1.m1 <- emmeans(p3.AsyPtt.pe1.2.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.pe1.m1$contrasts %>% kable(digits=3)

p3.AsyPtt.pe1.m2 <- emmeans(p3.AsyPtt.pe1.2.aov, pairwise ~ Btw | sResp, type = "response")
p3.AsyPtt.pe1.m2$contrasts %>% kable(digits=3)
```

<br>
  
`PE 2` 조건에서의 분석 결과는 아래와 같다.

```{r d3_src_asyptt_PE2_anova}
p3.AsyPtt.g.pe2.2 %>% kable(digits=2)
p3.AsyPtt.pe2.2.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.pe2.2, between = "Btw", within = "sResp")
anova(p3.AsyPtt.pe2.2.aov, es = "pes") %>% kable(digits=3)
```

출처 반응의 주효과와 집단과 출처 반응의 상호작용이 유의하였다. 

```{r d3_src_asyptt_PE2_anova_posthoc}
p3.AsyPtt.pe2.m1 <- emmeans(p3.AsyPtt.pe2.2.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.pe2.m1$contrasts %>% kable(digits=3)

p3.AsyPtt.pe2.m2 <- emmeans(p3.AsyPtt.pe2.2.aov, pairwise ~ Btw | sResp, type = "response")
p3.AsyPtt.pe2.m2$contrasts %>% kable(digits=3)
```

`실험 집단`에서 **Source Confusion (L1>D2)**이 **Intrusion (L2>D1)**보다 유의하게 낮은 비대칭적 출처 오귀인 패턴을 보였다. 
또한 `실험 집단`이 `통제 집단`보다 높은 **Intrusion (L2>D1)**을 보이는 경향이 나타났다. 

<br>
  
`PE 3` 조건에서의 분석 결과는 아래와 같다.

```{r d3_src_asyptt_PE3_anova}
p3.AsyPtt.g.pe3.2 %>% kable(digits=2)
p3.AsyPtt.pe3.2.aov <- aov_ez(id = "SN", dv = "Rsp", data = p3.AsyPtt.long.pe3.2, between = "Btw", within = "sResp")
anova(p3.AsyPtt.pe3.2.aov, es = "pes") %>% kable(digits=3)
```

출처 반응의 주효과가 유의하였다.

```{r d3_src_asyptt_PE3_anova_posthoc}
p3.AsyPtt.pe3.m1 <- emmeans(p3.AsyPtt.pe3.2.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.pe3.m1$contrasts %>% kable(digits=3)

p3.AsyPtt.pe3.m2 <- emmeans(p3.AsyPtt.pe3.2.aov, pairwise ~ Btw | sResp, type = "response")
p3.AsyPtt.pe3.m2$contrasts %>% kable(digits=3)
```

`실험 집단`에서 **Source Confusion (L1>D2)**이 **Intrusion (L2>D1)**보다 유의하게 낮은 비대칭적 출처 오귀인 패턴을 보였다. 
`실험 집단`과 `통제 집단` 간의 **Intrusion (L2>D1)**의 차이는 나타나지 않았다.

```{r d3_src_asyptt_byPE_anova_plot, fig.width=18, fig.height=6}

A <- plot(p3.AsyPtt.pe1.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

B <- plot(p3.AsyPtt.pe2.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

C <- plot(p3.AsyPtt.pe3.m1, horizontal=F, comparisons=T) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank())

ggpubr::ggarrange(A, B, C, ncol=3, 
          labels = c("A) PE 1 (0%)", "B) PE 2 (50%)", "C) PE 3 (100%)"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>

종합하자면, 예측 오류 조건에 따른 각 집단의 **Intrusion**과 **Source Confusion**의 비대칭적 패턴은 `PE 2(50%)` 조건과 `PE 3(100%)` 조건의 실험집단에서 관찰되었다. 또한 `PE 2(50%)` 조건에서 `실험 집단`은 `통제 집단`보다 높은 **Intrusion**을 보였다.

<br>

##### 목록 1 정확 반응
  
  각 집단과 예측 오류 조건에서 **List 1 Correct**의 차이가 있는지 확인하기 위해 각 조건에 대한 정확도 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 오차 막대는 95% 신뢰구간을 표시한다.

```{r d3_src_L1corr_byPE_summary&plot, fig.width= 18, fig.height=6}
## List 1 Correct Response
# long format
p3.Acc.long.all.1 <- p3 %>% filter(cSrc == "List_1", cPE != "pe0") %>% group_by(SN, Btw, cPE) %>% 
  summarise(Acc = mean(Correct)*100) %>% ungroup()
p3.Acc.long.exp.1 <- p3.Acc.long.all.1 %>% filter(Btw==1)
p3.Acc.long.con.1 <- p3.Acc.long.all.1 %>% filter(Btw==2)

# wide format
p3.Acc.swide.all.1 <- p3.Acc.long.all.1 %>% spread(key = cPE, value = Acc)
p3.Acc.swide.exp.1 <- p3.Acc.swide.all.1 %>% filter(Btw==1)
p3.Acc.swide.con.1 <- p3.Acc.swide.all.1 %>% filter(Btw==2)

# summary
p3.Acc.g.all.1 <- p3.Acc.long.all.1 %>%  group_by(Btw, cPE) %>% 
  summarise(Acc.M = mean(Acc), Acc.SD = sd(Acc)) %>% ungroup() 
p3.Acc.g.all.1$Acc.se <- Rmisc::summarySEwithin(data = p3.Acc.long.all.1, measurevar = "Acc", 
                                                idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.g.all.1$Acc.ci <- Rmisc::summarySEwithin(data = p3.Acc.long.all.1, measurevar = "Acc", 
                                                idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.g.exp.1 <- p3.Acc.g.all.1 %>% filter(Btw==1)
p3.Acc.g.con.1 <- p3.Acc.g.all.1 %>% filter(Btw==2)
p3.Acc.g.all.1 %>% kable(digits=2)


## plot
p3.Acc.g.all.1.p3 <- p3.Acc.g.all.1
p3.Acc.g.all.1.p3$Btw <- factor(p3.Acc.g.all.1.p3$Btw, labels=c("Experimental", "Control"))
p3.plot2.2.all.1.p3 <- ggplot(data=p3.Acc.g.all.1.p3, 
                              aes(x=cPE, y=Acc.M, ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(40,100), clip = "on") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "List 1 Correct (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.25),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())

p3.plot2.2.exp.1 <- ggplot(p3.Acc.g.exp.1, mapping=aes(x=cPE, y=Acc.M, group=1)) + 
  geom_ribbon(aes(ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Acc.M, ymax=Acc.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.long.exp.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Acc, group=SN, color=SN)) +
  geom_point(p3.Acc.long.exp.1, mapping = aes(x=cPE, y=Acc, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(30, 100), clip = "on") +
  labs(x = "Prediction Error", y = "List 1 Correct (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Source Memory (L1>D1; Exp)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        aspect.ratio = 1,
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))

p3.plot2.2.con.1 <- ggplot(p3.Acc.g.con.1, mapping=aes(x=cPE, y=Acc.M, group=1)) + 
  geom_ribbon(aes(ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Acc.M, ymax=Acc.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.long.con.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Acc, group=SN, color=SN)) +
  geom_point(p3.Acc.long.con.1, mapping = aes(x=cPE, y=Acc, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(30, 100), clip = "on") +
  labs(x = "Prediction Error", y = "List 1 Correct (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Source Memory (L1>D1; Con)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        aspect.ratio = 1,
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.plot2.2.all.1.p3, p3.plot2.2.exp.1, p3.plot2.2.con.1, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>
  
집단과 예측 오류 조건을 요인으로한 2 X 3 혼합 요인 분산분석을 수행하였다.
  
```{r d3_src_L1corr_byPE_anova, warning=FALSE, message=FALSE}
p3.Acc.all.aov.1 <- aov_ez(id = "SN", dv = "Acc", data = p3.Acc.long.all.1, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.1, es = "pes") %>% kable(digits=3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위해, 집단과 예측 오류 조건에 따른 **List 1 Correct**에 대하여 일반화 선형 혼합 효과 모형을 검증하였다. 집단, 예측 오류 조건을 고정 효과로 하고 참가자와 자극의 무선 효과를 포함한 `p3.L1.src.corr.Model`을 구성하였다.

```{r d3_src_L1corr_byPE_GLMM_prep, warning=FALSE, message=FALSE}
p3.L1.src.corr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.L1.src.corr <- p3.L1.src.corr %>% filter(cSrc == 1)
p3.L1.src.corr$SN = factor(p3.L1.src.corr$SN); p3.L1.src.corr$Btw = factor(p3.L1.src.corr$Btw)
p3.L1.src.corr$cSrc = factor(p3.L1.src.corr$cSrc, labels=c("List_1"))
p3.L1.src.corr$cPE = factor(p3.L1.src.corr$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.L1.src.corr$Resp <- factor(p3.L1.src.corr$Resp, levels=c(1,2,3), labels=c("Day_1", "Day_2", "New"))
p3.L1.src.corr$Correct <- as.numeric(p3.L1.src.corr$Corr==1)
p3.L1.src.corr$Int <- as.numeric(p3.L1.src.corr$Corr==3); p3.L1.src.corr$Err <- as.numeric(p3.L1.src.corr$Corr==2); 
p3.L1.src.corr$Incorr <- as.numeric(p3.L1.src.corr$Corr==0)
p3.L1.src.corr.exp <- p3.L1.src.corr %>% filter(Btw == 1)
p3.L1.src.corr.con <- p3.L1.src.corr %>% filter(Btw == 2)
```

```{r d3_src_L1corr_byPE_GLMM, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L1.src.corr.Model.1 <- afex::mixed(Correct ~ Btw*cPE + (1|SN) + (1|IMname),
                             p3.L1.src.corr, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.src.corr.Model.1, file="memudet_day3_L1src_corr.Rdata")
stopCluster(cl)
```

```{r d3_src_L1corr_byPE_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_L1src_corr.Rdata")
```

```{r d3_src_L1corr_byPE_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L1.src.corr.Model.1) %>% kable(digit=3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

##### 목록 1 출처 혼동
  
<br>
  
  **Source Confusion**에서 집단과 예측 오류 조건에 따른 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>
  
```{r d3_src_L1err_byPE_summary&plot, fig.width= 18, fig.height=6}
## List 1 Source Confusion
# long format
p3.Err.long.all <- p3 %>% filter(cSrc == "List_1", cPE != "pe0") %>% group_by(SN, Btw, cPE) %>% 
  summarise(Error = mean(Err)*100) %>% ungroup()
p3.Err.wide.all <- p3.Err.long.all %>% spread(key = cPE, value = Error)
p3.Err.long.all <- gather(p3.Err.wide.all, cPE, Error, pe1:pe3, factor_key=TRUE)
p3.Err.long.all[is.na(p3.Err.long.all)] <- 0
p3.Err.long.all <- arrange(p3.Err.long.all, SN, Btw, Error)
p3.Err.long.exp <- p3.Err.long.all %>% filter(Btw==1)
p3.Err.long.con <- p3.Err.long.all %>% filter(Btw==2)

# wide format
p3.Err.swide.all <- p3.Err.long.all %>% spread(key = cPE, value = Error)
p3.Err.swide.exp <- p3.Err.swide.all %>% filter(Btw==1)
p3.Err.swide.con <- p3.Err.swide.all %>% filter(Btw==2)

# summary
p3.Err.g.all <- p3.Err.long.all %>%  group_by(Btw, cPE) %>% 
  summarise(Err.M = mean(Error), Err.SD = sd(Error)) %>% ungroup()
p3.Err.g.all$Err.se <- Rmisc::summarySEwithin(data = p3.Err.long.all, measurevar = "Error", 
                                              idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Err.g.all$Err.ci <- Rmisc::summarySEwithin(data = p3.Err.long.all, measurevar = "Error", 
                                              idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Err.g.exp <- p3.Err.g.all %>% filter(Btw==1)
p3.Err.g.con <- p3.Err.g.all %>% filter(Btw==2)
p3.Err.g.all %>% kable(digits=2)

## plot 
p3.Err.g.all.p3 <- p3.Err.g.all
p3.Err.g.all.p3$Btw <- factor(p3.Err.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.3.all.1.p3 <- ggplot(data=p3.Err.g.all.p3, 
                              aes(x=cPE, y=Err.M, ymin=Err.M-Err.ci, ymax=Err.M+Err.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,70), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  labs(x = "Prediction Error", y = "Source Confusion (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
# p3.plot2.3.all.1.p3


p3.plot2.3.exp <- ggplot(p3.Err.g.exp, mapping=aes(x=cPE, y=Err.M, group=1)) + 
  geom_ribbon(aes(ymin=Err.M-Err.ci, ymax=Err.M+Err.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Err.M, ymax=Err.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Err.long.exp, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Error, group=SN, color=SN)) +
  geom_point(p3.Err.long.exp, mapping = aes(x=cPE, y=Error, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(0, 80), clip = "on") +
  labs(x = "Prediction Error", y = "Source Confusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Source Confusions (L1>D2; Exp)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
p3.plot2.3.con <- ggplot(p3.Err.g.con, mapping=aes(x=cPE, y=Err.M, group=1)) + 
  geom_ribbon(aes(ymin=Err.M-Err.ci, ymax=Err.M+Err.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Err.M, ymax=Err.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Err.long.con, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Error, group=SN, color=SN)) +
  geom_point(p3.Err.long.con, mapping = aes(x=cPE, y=Error, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(0, 80), clip = "on") +
  labs(x = "Prediction Error", y = "Source Confusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Source Confusions (L1>D2; Con)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.plot2.3.all.1.p3, p3.plot2.3.exp, p3.plot2.3.con, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>
  
  **Source Confusion**이 집단, 예측 오류 조건에 따라 다른지 살펴보기 위해, 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>
  
```{r d3_src_L1err_byPE_anova, warning=FALSE, message=FALSE}
p3.Err.all.aov <- aov_ez(id = "SN", dv = "Error", data = p3.Err.long.all, between = "Btw", within = "cPE")
anova(p3.Err.all.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 예측 오류 조건의 주효과가 유의하였다.

```{r d3_src_L1err_byPE_anova_post-hoc, warning=FALSE, message=FALSE}
p3.scnf.m1.all <- emmeans(p3.Err.all.aov, pairwise ~ cPE | Btw, type = "response")
p3.scnf.m1.all$contrasts %>% kable(digits=3)

p3.scnf.m2.all <- emmeans(p3.Err.all.aov, pairwise ~ Btw | cPE, type = "response")
p3.scnf.m2.all$contrasts %>% kable(digits=3)
```

사후 분석 결과, 모든 비교가 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위해, 집단과 예측 오류 조건에 따른 **Source Confusion**에 대하여 일반화 선형 혼합 효과 모형을 검증하였다. 집단과 예측 오류 조건을 고정 효과로 하고 참가자와 자극의 무선 효과를 포함한 `p3.L1.src.corr.Model`을 구성하였다.

```{r d3_src_L1err_byPE_GLMM_prep, warning=FALSE, message=FALSE}
p3.L1.src.corr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T)
p3.L1.src.corr <- p3.L1.src.corr %>% filter(cSrc == 1)
p3.L1.src.corr$SN = factor(p3.L1.src.corr$SN); p3.L1.src.corr$Btw = factor(p3.L1.src.corr$Btw)
p3.L1.src.corr$cSrc = factor(p3.L1.src.corr$cSrc, labels=c("List_1"))
p3.L1.src.corr$cPE = factor(p3.L1.src.corr$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.L1.src.corr$Resp <- factor(p3.L1.src.corr$Resp, levels=c(1,2,3), labels=c("Day_1", "Day_2", "New"))
p3.L1.src.corr$Correct <- as.numeric(p3.L1.src.corr$Corr==1)
p3.L1.src.corr$Int <- as.numeric(p3.L1.src.corr$Corr==3); p3.L1.src.corr$Err <- as.numeric(p3.L1.src.corr$Corr==2);
p3.L1.src.corr$Incorr <- as.numeric(p3.L1.src.corr$Corr==0)
p3.L1.src.corr.exp <- p3.L1.src.corr %>% filter(Btw == 1)
p3.L1.src.corr.con <- p3.L1.src.corr %>% filter(Btw == 2)
```

```{r d3_src_L1err_byPE_GLMM, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L1.src.scnf.Model.1 <- afex::mixed(Err ~ Btw*cPE + (1|SN) + (1|IMname),
                             p3.L1.src.corr, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L1.src.scnf.Model.1, file="memudet_day3_L1src_scnf.Rdata")
stopCluster(cl)
```

```{r d3_src_L1err_byPE_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_L1src_corr.Rdata")
```

```{r d3_src_L1err_byPE_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L1.src.scnf.Model.1) %>% kable(digit=3)
```

분석 결과, 예측 오류의 주효과가 유의하였다.

```{r d3_src_L1err_byPE_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p3.L1.src.scnf.m1 <- emmeans(p3.L1.src.scnf.Model.1, pairwise ~ cPE | Btw , type = "response", adjust="bon") # adjust="bon"
p3.L1.src.scnf.m1$contrasts %>% kable(digits=3)
```

사후 분석 결과, `통제 집단`에서 예측 오류가 수반되지 않았던 `PE 1`은 `PE 3` 보다 유의하게 높은 **Source Confusion (L1>D2)** 반응을 보였다.

<br>

##### 목록 2 정확 반응
  
<br>

  집단과 예측 오류 조건에 따른 **List 2 Correct** 차이를 분석하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 오차 막대는 95% 신뢰구간을 표시한다.

<br>
  
```{r d3_src_L2corr_byPE_summary&plot, fig.width= 18, fig.height=6}
## List 2 Correct Source Memory
# long format
p3.Acc.long.all.2 <- p3 %>% filter(cSrc == "List_2", cPE != "pe0") %>% group_by(SN, Btw, cPE) %>% 
  summarise(Acc = mean(Correct)*100) %>% ungroup()
p3.Acc.long.exp.2 <- p3.Acc.long.all.2 %>% filter(Btw==1)
p3.Acc.long.con.2 <- p3.Acc.long.all.2 %>% filter(Btw==2)

# wide format
p3.Acc.swide.all.2 <- p3.Acc.long.all.2 %>% spread(key = cPE, value = Acc)
p3.Acc.swide.exp.2 <- p3.Acc.swide.all.2 %>% filter(Btw==1)
p3.Acc.swide.con.2 <- p3.Acc.swide.all.2 %>% filter(Btw==2)

# summary
p3.Acc.g.all.2 <- p3.Acc.long.all.2 %>%  group_by(Btw, cPE) %>% 
  summarise(Acc.M = mean(Acc), Acc.SD = sd(Acc)) %>% ungroup() 
p3.Acc.g.all.2$Acc.se <- Rmisc::summarySEwithin(data = p3.Acc.long.all.2, measurevar = "Acc", 
                                                idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.g.all.2$Acc.ci <- Rmisc::summarySEwithin(data = p3.Acc.long.all.2, measurevar = "Acc", 
                                                idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.g.exp.2 <- p3.Acc.g.all.2 %>% filter(Btw==1)
p3.Acc.g.con.2 <- p3.Acc.g.all.2 %>% filter(Btw==2)
p3.Acc.g.all.2 %>% kable(digits=2)

## plot
p3.Acc.g.all.2.p3 <- p3.Acc.g.all.2
p3.Acc.g.all.2.p3$Btw <- factor(p3.Acc.g.all.2.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.2.all.2.p3 <- ggplot(data=p3.Acc.g.all.2.p3, 
                              aes(x=cPE, y=Acc.M, ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(40,100), clip = "on") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "List 2 Correct (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.25),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
# p3.plot2.2.all.2.p3
p3.plot2.2.exp.2 <- ggplot(p3.Acc.g.exp.2, mapping=aes(x=cPE, y=Acc.M, group=1)) + 
  geom_ribbon(aes(ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Acc.M, ymax=Acc.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.long.exp.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Acc, group=SN, color=SN)) +
  geom_point(p3.Acc.long.exp.2, mapping = aes(x=cPE, y=Acc, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(30, 100), clip = "on") +
  labs(x = "Prediction Error", y = "List 2 Correct (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 Source Memory (L2>D2; Exp)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
p3.plot2.2.con.2 <- ggplot(p3.Acc.g.con.2, mapping=aes(x=cPE, y=Acc.M, group=1)) + 
  geom_ribbon(aes(ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Acc.M, ymax=Acc.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.long.con.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Acc, group=SN, color=SN)) +
  geom_point(p3.Acc.long.con.2, mapping = aes(x=cPE, y=Acc, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(30, 100), clip = "on") +
  labs(x = "Prediction Error", y = "List 2 Correct (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 Source Memory (L2>D2; Con)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.plot2.2.all.2.p3, p3.plot2.2.exp.2, p3.plot2.2.con.2, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>
  
**List 2 Correct**에 대하여 집단과 예측 오류 조건을 요인으로한 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>
  
```{r d3_src_L2corr_byPE_anova, warning=FALSE, message=FALSE}
p3.Acc2.all.aov <- aov_ez(id = "SN", dv = "Acc", data = p3.Acc.long.all.2, between = "Btw", within = "cPE")
anova(p3.Acc2.all.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 예측 오류의 주효과가 유의하였다.

```{r d3_src_L2corr_byPE_anova_post-hoc, warning=FALSE, message=FALSE}
p3.Acc2.m1.all <- emmeans(p3.Acc2.all.aov, pairwise ~ cPE | Btw, type = "response")
p3.Acc2.m1.all$contrasts %>% kable(digits = 3)

p3.Acc2.m1.all.2 <- emmeans(p3.Acc2.all.aov, pairwise ~ Btw | cPE, type = "response")
p3.Acc2.m1.all.2$contrasts %>% kable(digits = 3)
```

사후 분석 결과, `실험 집단`에서 `PE 1` 조건이 `PE 2` 조건보다 유의하게 높은 **List 2 Correct** 수준을 보이는 것으로 나타났다. 
각 예측 오류 조건에서 두 집단 차이를 살펴본 결과, `PE 2` 조건에서 `통제 집단`이 `실험 집단`보다 우수한 것으로 나타났다. 

<br>

분산 분석 결과를 보충하기 위하여, 집단과 예측 오류를 고정 효과로 하고 참가자와 자극을 무선 효과로 설정한 일반화 선형 혼합 모형을 검증하였다. 

```{r d3_src_L2corr_byPE_GLMM_prep, warning=FALSE, message=FALSE}
p3.L2.src.corr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.L2.src.corr <- p3.L2.src.corr %>% filter(cSrc == 2)
p3.L2.src.corr$SN = factor(p3.L2.src.corr$SN); p3.L2.src.corr$Btw = factor(p3.L2.src.corr$Btw)
p3.L2.src.corr$cSrc = factor(p3.L2.src.corr$cSrc, labels=c("List_2"))
p3.L2.src.corr$cPE = factor(p3.L2.src.corr$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.L2.src.corr$Resp <- factor(p3.L2.src.corr$Resp, levels=c(1,2,3), labels=c("Day_1", "Day_2", "New"))
p3.L2.src.corr$Correct <- as.numeric(p3.L2.src.corr$Corr==1)
p3.L2.src.corr$Int <- as.numeric(p3.L2.src.corr$Corr==3); p3.L2.src.corr$Err <- as.numeric(p3.L2.src.corr$Corr==2); 
p3.L2.src.corr$Incorr <- as.numeric(p3.L2.src.corr$Corr==0)
p3.L2.src.corr.exp <- p3.L2.src.corr %>% filter(Btw == 1)
p3.L2.src.corr.con <- p3.L2.src.corr %>% filter(Btw == 2)
```


```{r d3_src_L2corr_byPE_GLMM, eval=FALSE, eval=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L2.src.corr.Model.1 <- afex::mixed(Correct ~ Btw*cPE + (1|SN), 
                               p3.L2.src.corr, method = "LRT", cl = cl, 
                               family=binomial(link="logit"),
                               control = glmerControl(optCtrl = list(maxfun = 1e6)))

p3.L2.src.corr.Model.2 <- afex::mixed(Correct ~ Btw*cPE + (1|SN) + (1|IMname), 
                               p3.L2.src.corr, method = "LRT", cl = cl, 
                               family=binomial(link="logit"),
                               control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L2.src.corr.Model.1, p3.L2.src.corr.Model.2, file="memudet_day3_Acc2_afex.Rdata")

stopCluster(cl)
```

```{r d3_src_L2corr_byPE_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_Acc2_afex.Rdata")
```

`p3.L2.src.corr.Model.2`는 과적합되어 분석에서 제외하였다.

```{r d3_src_L2corr_byPE_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L2.src.corr.Model.1) %>% kable(digits=3)
```

`p1.Acc.Model.1` 분석 결과, 예측 오류 조건의 주효과는 유의하였다. 

```{r d3_src_L2corr_byPE_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p3.acc2.m3.all <- emmeans(p3.L2.src.corr.Model.1, pairwise ~ cPE | Btw, type = "response")
p3.acc2.m3.all$contrasts %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`에서 `PE 1` 조건이 `PE 2` 조건 보다 유의하게 높은 **List 2 Correct (L2>D2)** 수준을 보이는 것으로 나타났다. 

<br>

##### 목록 2 침범
  
<br>
  
**Intrusion**의 집단과 예측 오류 조건에 따른 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>
  
```{r d3_src_L2err_byPE_summary&plot, fig.width= 18, fig.height=6}
## List 2 Intrusion
# long format
p3.Intru.long.all <- p3 %>% filter(cSrc == "List_2", cPE != "pe0") %>% group_by(SN, Btw, cPE) %>%
  summarise(Intrusion = mean(Int)*100) %>% 
  ungroup()
p3.Intru.long.exp <- p3.Intru.long.all %>% filter(Btw==1)
p3.Intru.long.con <- p3.Intru.long.all %>% filter(Btw==2)

# wide format
p3.Intru.swide.all <- p3.Intru.long.all %>% spread(key = cPE, value = Intrusion)
p3.Intru.swide.exp <- p3.Intru.swide.all %>% filter(Btw==1)
p3.Intru.swide.con <- p3.Intru.swide.all %>% filter(Btw==2)

# summary
p3.Intru.g.all <- p3.Intru.long.all %>%  group_by(Btw, cPE) %>% 
  summarise(Intru.M = mean(Intrusion), Intru.SD = sd(Intrusion)) %>% ungroup() 
p3.Intru.g.all$Intru.se <- Rmisc::summarySEwithin(data = p3.Intru.long.all, measurevar = "Intrusion", 
                                                  idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Intru.g.all$Intru.ci <- Rmisc::summarySEwithin(data = p3.Intru.long.all, measurevar = "Intrusion", 
                                                  idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Intru.g.exp <- p3.Intru.g.all %>% filter(Btw==1)
p3.Intru.g.con <- p3.Intru.g.all %>% filter(Btw==2)
p3.Intru.g.all %>% kable(digits=2)

## plot
p3.Intru.g.all.p3 <- p3.Intru.g.all
p3.Intru.g.all.p3$Btw <- factor(p3.Intru.g.all.p3$Btw, labels=c("Experimental", "Control"))
p3.plot2.1.all.p3 <- ggplot(data=p3.Intru.g.all.p3, 
                            aes(x=cPE, y=Intru.M, ymin=Intru.M-Intru.ci, ymax=Intru.M+Intru.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,70), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "Intrusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
# p3.plot2.1.all.p3

p3.plot2.1.exp <- ggplot(p3.Intru.g.exp, mapping=aes(x=cPE, y=Intru.M, group=1)) + 
  geom_ribbon(aes(ymin=Intru.M-Intru.ci, ymax=Intru.M+Intru.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Intru.M, ymax=Intru.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Intru.long.exp, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Intrusion, group=SN, color=SN)) +
  geom_point(p3.Intru.long.exp, mapping = aes(x=cPE, y=Intrusion, group=SN, color = SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(0, 80), clip = "on") +
  labs(x = "Prediction Error", y = "Intrusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Intrusion (L2>D1; Exp)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
p3.plot2.1.con <- ggplot(p3.Intru.g.con, mapping=aes(x=cPE, y=Intru.M, group=1)) + 
  geom_ribbon(aes(ymin=Intru.M-Intru.ci, ymax=Intru.M+Intru.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Intru.M, ymax=Intru.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Intru.long.con, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Intrusion, group=SN, color=SN)) +
  geom_point(p3.Intru.long.con, mapping = aes(x=cPE, y=Intrusion, group=SN, color = SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(0, 80), clip = "on") +
  labs(x = "Prediction Error", y = "Intrusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Intrusion (L2>D1; Con)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.plot2.1.all.p3, p3.plot2.1.exp, p3.plot2.1.con, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>
  
**Intrusion**에 대하여 집단과 예측 오류 조건을 요인으로 하는 2 X 3 혼합 요인 분산분석으로 수행하였다.

<br>
  
```{r d3_src_L2err_byPE_anova, warning=FALSE, message=FALSE}
p3.Intru.all.aov <- aov_ez(id = "SN", dv = "Intrusion", data = p3.Intru.long.all, between = "Btw", within = "cPE")
anova(p3.Intru.all.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 집단과 예측 오류 조건의 상호 작용은 유의하였다.

```{r d3_src_L2err_byPE_anova_post-hoc, warning=FALSE, message=FALSE}
p3.Intru.m1.all <- emmeans(p3.Intru.all.aov, pairwise ~ cPE | Btw, type = "response")
p3.Intru.m1.all$contrasts %>% kable(digits=3)

p3.Intru.m2.all <- emmeans(p3.Intru.all.aov, pairwise ~ Btw | cPE, type = "response")
p3.Intru.m2.all$contrasts %>% kable(digits=3)
```

분석 결과, `실험 집단`에서 `PE 1`은 `PE 2`보다 유의하게 낮은 **Intrusion** 반응을 보였다. `PE 1`과 `PE 3`, `PE 2`와 `PE 3` 간의 차이는 유의하지 않았다. `통제 집단`에서는 모든 비교가 유의하지 않았다. 또한 `PE 2`에서 `실험 집단`은 `통제 집단`보다 유의하게 높은 **Intrusion** 반응을 보였다.

<br>

분산분석 결과를 보충하기 위해, 집단과 예측 오류를 고정 효과로 하고 참가자와 자극을 무선 효과로 설정한 일반화 선형 혼합 모형 `p3.Int.Model`을 검증하였다. 

```{r d3_src_L2err_byPE_GLMM_prep, eval=FALSE, warning=FALSE, message=FALSE}
p3.glmm.int <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.glmm.int <- p3.glmm.int %>% filter(cSrc == 2)
p3.glmm.int$SN = factor(p3.glmm.int$SN); p3.glmm.int$Btw = factor(p3.glmm.int$Btw)
p3.glmm.int$cPE = factor(p3.glmm.int$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.glmm.int$RT <- p3.glmm.int$RT*1000; p3.glmm.int$Correct <- as.numeric(p3.glmm.int$Corr==1)
p3.glmm.int$Int <- as.numeric(p3.glmm.int$Corr==3);
p3.glmm.int.exp <- p3.glmm.int %>% filter(Btw == 1)
p3.glmm.int.con <- p3.glmm.int %>% filter(Btw == 2)
```

``` {r d3_src_L2err_byPE_GLMM, eval=FALSE, warning=FALSE, message=FALSE}

(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.Int.Model.1 <- afex::mixed(Int ~ Btw*cPE + (1|SN) + (1|IMname), 
                               p3.glmm.int, method = "LRT", cl = cl, 
                               family=binomial(link="logit"),
                               control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.Int.Model.1, file="memudet_day3_Int_afex.Rdata")

stopCluster(cl)
```

```{r d3_src_L2err_byPE_GLMM_load, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_Int_afex.Rdata")
```

```{r d3_src_L2err_byPE_GLMM_result, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.Int.Model.1) %>% kable(digits=3)
```

분석 결과, 예측 오류의 주효과, 집단과 예측 오류 간의 상호작용이 유의하였다.
집단 내에서의 예측 오류 효과와 각 예측 오류 조건에서의 집단 간 사후분석을 수행하였다.

```{r d3_src_L2err_byPE_GLMM_post-hoc, eval=FALSE, warning=FALSE, message=FALSE}
p3.Intru.m3.all <- emmeans(p3.Int.Model.1, pairwise ~ cPE | Btw, type = "response")
p3.Intru.m3.all$contrasts %>% kable(digits=3)

p3.Intru.m4.all <- emmeans(p3.Int.Model.1, pairwise ~ Btw | cPE, type = "response")
p3.Intru.m4.all$contrasts %>% kable(digits=4)

# plot(p3.Intru.m3.all, horizontal=F, comparison=T)
```

분석 결과, `실험 집단`에서 `PE 1`은 `PE 2`보다 유의하게 낮은 **Intrusion** 반응을 보였다. `PE 1`과 `PE 3`, `PE 2`와 `PE 3` 간의 차이는 유의하지 않았다. `통제 집단`에서는 모든 비교가 유의하지 않았다. 또한 `PE 2`에서 `실험 집단`은 `통제 집단`보다 유의하게 높은 **Intrusion** 반응을 보였다.

<br>

##### 기억 갱신 점수
  
<br>
  
  집단과 예측 오류 조건에 따른 **기억 갱신 점수(Updating Score)**를 살펴보았다. **기억 갱신 점수(Updating Score)**는 **Intrusion**과 **Source Confusion**의 차이로, 출처 기억 반응에서 **Intrusion**과 **Source Confusion**간의 비대칭적 반응 패턴을 반영하기 위해 구성하였다. 양수의 값은 **Intrusion**이 **Source Confusion** 보다 높은 경우를 나타낸다. 각 집단의 참가자별로 **US**의 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

<br>
  
```{r d3_src_US_byPE_summary&plot, fig.width= 18, fig.height=6}
## Updating Score
# long format
p3.us <- merge(p3.Intru.long.all, p3.Err.long.all, key=c(SN,cPE))
p3.us <- arrange(p3.us, SN, Btw, cPE)
p3.US.long.all <- p3.us %>% group_by(SN, Btw, cPE) %>% 
  summarise(US = (Intrusion - Error)) %>% ungroup()
p3.US.long.exp <- p3.US.long.all %>% filter(Btw==1)
p3.US.long.con <- p3.US.long.all %>% filter(Btw==2)

# wide format
p3.US.swide.all <- p3.US.long.all %>% spread(key = cPE, value = US)
p3.US.swide.exp <- p3.US.swide.all %>% filter(Btw==1)
p3.US.swide.con <- p3.US.swide.all %>% filter(Btw==2)

# summary
p3.US.g.all <- p3.US.long.all %>%  group_by(Btw, cPE) %>% 
  summarise(US.M = mean(US), US.SD = sd(US)) %>% ungroup() 
p3.US.g.all$US.se <- Rmisc::summarySEwithin(data = p3.US.long.all, measurevar = "US", 
                                            idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.US.g.all$US.ci <- Rmisc::summarySEwithin(data = p3.US.long.all, measurevar = "US", 
                                            idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.US.g.exp <- p3.US.g.all %>% filter(Btw==1)
p3.US.g.con <- p3.US.g.all %>% filter(Btw==2)
p3.US.g.all %>% kable(digits=2)

## plot
p3.US.g.all.p3 <- p3.US.g.all
p3.US.g.all.p3$Btw <- factor(p3.US.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot5.1.all.p3 <- ggplot(data=p3.US.g.all.p3, 
                            aes(x=cPE, y=US.M, ymin=US.M-US.ci, ymax=US.M+US.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(-50,50), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "Updating Score") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.20),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
# p3.plot5.1.all.p3
p3.plot2.5.exp <- ggplot(p3.US.g.exp, mapping=aes(x=cPE, y=US.M, group=1)) + 
  geom_ribbon(aes(ymin=US.M-US.ci, ymax=US.M+US.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=US.M, ymax=US.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.US.long.exp, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=US, group=SN, color=SN)) +
  geom_point(p3.US.long.exp, mapping = aes(x=cPE, y=US, group=SN, color = SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(-50, +50), clip = "on") +
  labs(x = "Prediction Error", y = "Updating Score") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Updating Score (Exp)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        aspect.ratio = 1,
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
p3.plot2.5.con <- ggplot(p3.US.g.con, mapping=aes(x=cPE, y=US.M, group=1)) + 
  geom_ribbon(aes(ymin=US.M-US.ci, ymax=US.M+US.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=US.M, ymax=US.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.US.long.con, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=US, group=SN, color=SN)) +
  geom_point(p3.US.long.con, mapping = aes(x=cPE, y=US, group=SN, color = SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(-50, +50), clip = "on") +
  labs(x = "Prediction Error", y = "Updating Score") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Updating Score (Con)") +
  theme_bw(base_size = 18) +
  theme(axis.title = element_text(face = "plain", size = 18, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        # panel.border=element_blank(),
        aspect.ratio = 1,
        plot.margin = margin(0.3, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.plot5.1.all.p3, p3.plot2.5.exp, p3.plot2.5.con, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"), 
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>
  
각 집단과 예측 오류 조건에서의 `US` 차이를 살펴보기 위하여 2 X 3 혼합 요인 분산분석을 수행하였다.

```{r d3_src_US_byPE_anova, warning=FALSE, message=FALSE}
p3.US.all.aov <- aov_ez(id = "SN", dv = "US", data = p3.US.long.all, between = "Btw", within = "cPE")
anova(p3.US.all.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 예측 오류의 주효과가 유의하였다. 집단과 예측 오류 간의 상호작용은 유의하지 않았다.

```{r d3_src_US_byPE_post-hoc, warning=FALSE, message=FALSE}
p3.US.m1.all <- emmeans(p3.US.all.aov, pairwise ~ cPE | Btw, type = "response")
p3.US.m1.all$contrasts %>% kable(digits = 3)

p3.US.m2.all <- emmeans(p3.US.all.aov, pairwise ~ Btw | cPE, type = "response")
p3.US.m2.all$contrasts %>% kable(digits = 3)

# plot(p3.US.m1.all, horizontal=F, comparison=T)
# plot(p3.US.m2.all, horizontal=F, comparison=T)
```

사후 분석 결과, `실험 집단`에서 `PE 1`보다 `PE 2`가 유의하게 높은 **US**값을 보였다. 다른 차이는 유의하지 않았다. 또한 `PE 2` 조건에서 `실험 집단`은 `통제 집단`보다 유의하게 높은 **US**값을 보였다. 그러나 앞선 분산분석에서 집단과 예측 오류의 상호작용이 유의하지 않았다는 점을 고려할 필요가 있다.

<br>

분산 분석 결과를 보충하기 위해 `Updating Score`에 대한 예측 오류의 주효과를 고정 효과로 하고 참가자에 의한 무선 절편을 무선 효과로 포함한 일반 선형 혼합 모형을 검증하였다. 

```{r d3_src_US_byPE_GLMM, eval = FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))
p3.US.long.all$cPE <- factor(p3.US.long.all$cPE)

p3.US.Model.1 <- afex::mixed(US ~ Btw*cPE + (1|SN), REML = FALSE,
                              p3.US.long.all, method = "LRT", cl = cl,
                              control = lmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.US.Model.1, file="memudet_day3_US_afex.Rdata")

stopCluster(cl)
```

```{r d3_src_US_byPE_GLMM_load, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_US_afex.Rdata")
```

```{r d3_src_US_byPE_GLMM_result, warning=FALSE, message=FALSE}
anova(p3.US.Model.1) %>% kable(digits=4)
```

`p3.US.Model.1` 분석 결과, 예측 오류의 주효과가 유의하였다. 집단 내에서의 예측 오류 효과와 각 예측 오류 조건에서의 집단 간 사후분석을 수행하였다.

```{r d3_src_US_byPE_GLMM_post-hoc, warning=FALSE, message=FALSE}
p3.US.m3.all <- emmeans(p3.US.Model.1, pairwise ~ cPE | Btw, type = "response")
p3.US.m3.all$contrasts %>% kable(digits=3)

p3.US.m4.all <- emmeans(p3.US.Model.1, pairwise ~ Btw | cPE, type = "response")
p3.US.m4.all$contrasts %>% kable(digits=3)
```

사후 분석 결과, `실헙 집단`에서 예측 오류 조건 `PE 2`는 `PE 1`보다 유의하게 높은 **US** 정도를 보였다. 또한 `PE 2`조건에서 `실험 집단`은 `통제집단`보다 유의하게 높은 **US**을 보였다. 그러나 분산 분석과 마찬가지로, 집단과 예측 오류 간의 상호작용이 유의하지 않았다는 것을 고려할 필요가 있다.

<br>

#### 예측 오류 정도와 기억 갱신 효과의 관계 - 모형 적합

<br>

앞선 분석에서는 예측 오류와 기억 갱신 간의 관계가 비단조적임을 나타내는 예측 오류 조건 간의 차이가 뚜렷하게 나타나지 않았다. 예측 오류 조건에 따른 출처 기억 반응 분석 결과, `실험 집단`의 예측 오류 조건 `PE 3`과 `PE 1`, `PE 2` 간의 차이는 비단조적 예측과 같지 않았다. 하지만 수치적으로 볼 때, `실험 집단`에서 예측 오류 조건에 따른 기억 갱신 효과의 평균은 `Intrusion`에서 `PE 1` 27.45%, `PE 2` 37.84%, `PE 3` 32.94%, `Updating Score`에서 `PE 1` 3.53, `PE 2` 18.82, `PE 3` 12.35로 비단조적인 패턴을 보였다. 이에 따라 기억 갱신의 패턴이 선형적 패턴과 비단조적 패턴 중 어느 것을 더 지지하는지 살펴보기 위하여 회귀 모형 적합을 수행하였다. 예측 오류 조건에 따른 `Intrusion`, `Updating Score`을 선형 모형 및 비선형 모형에 적합하고 두 집단 각각에서 어떤 모형이 기억 갱신 패턴에 적합한지 살펴보았다. 

<br>

```{r d3_src_byPE_model_prep, warning=FALSE, message=FALSE}
## Intrusion (L2>D1)
p3.Intru.long.all.fit <- p3.Intru.long.all
p3.Intru.long.all.fit$cPEn <- as.numeric(p3.Intru.long.all$cPE)
p3.Intru.long.exp.fit <- p3.Intru.long.all.fit %>% filter(Btw==1)
p3.Intru.long.con.fit <- p3.Intru.long.all.fit %>% filter(Btw==2)

## Updating Score (Intrusion - Source Confusion)
p3.US.long.all.fit <- p3.US.long.all
p3.US.long.all.fit$cPEn <- as.numeric(p3.US.long.all$cPE)
p3.US.long.exp.fit <- p3.US.long.all.fit %>% filter(Btw==1)
p3.US.long.con.fit <- p3.US.long.all.fit %>% filter(Btw==2)
```

먼저 각 집단 참가자들의 **Intrusion (L2>D1)**의 비율에 대하여 참가자에 의한 무선효과를 고려한 혼합 모형을 구성하였다. 혼합 모형은 각 집단에서 예측 오류와 **Intrusion (L2>D1)**의 비율 간의 선형 관계를 가정한 선형 혼합 모형 `lin.int.exp.model`, `lin.int.con.model`과 비단조적 관계를 가정한 `quad.int.exp.model`,`quad.int.con.model`로 구분되었다. 이어서 각 집단에서 어떤 모형이 **Intrusion (L2>D1)** 비율과 예측 오류 조건 간의 관계를 더 잘 설명하는지 모형 간 비교를 수행하였다.

```{r d3_src_byPE_Int_model, warning=FALSE, message=FALSE}
# experimental group
lin.int.exp.model <- lmer(Intrusion ~ cPEn + (1|SN), p3.Intru.long.exp.fit, 
                          control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
quad.int.exp.model <- lmer(Intrusion ~ poly(cPEn, 2) + (1|SN), p3.Intru.long.exp.fit, 
                           control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)

# control group
lin.int.con.model <- lmer(Intrusion ~ cPEn + (1|SN), p3.Intru.long.con.fit, 
                          control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
quad.int.con.model <- lmer(Intrusion ~ poly(cPEn, 2) + (1|SN), p3.Intru.long.con.fit, 
                           control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
```

`실험 집단`에서 각 모형을 분석한 결과는 아래와 같다.

```{r d3_src_byPE_Int_model_comparison1, warning=FALSE, message=FALSE}
anova(lin.int.exp.model, quad.int.exp.model) %>% kable(digit=3)
r2.int.exp <-cbind(MuMIn::r.squaredGLMM(lin.int.exp.model)[1,2], MuMIn::r.squaredGLMM(quad.int.exp.model)[1,2])
colnames(r2.int.exp)[c(1,2)] <- paste0(rep(c("Linear", "Quadratic")), colnames(r2.int.exp)[c(1,2)])
r2.int.exp %>% kable(digit = 2)
```

`통제 집단`에서 각 모형을 분석한 결과는 아래와 같다. 

```{r d3_src_byPE_Int_model_comparison2, warning=FALSE, message=FALSE}
anova(quad.int.con.model, lin.int.con.model) %>% kable(digit=3)
r2.int.con <-cbind(MuMIn::r.squaredGLMM(lin.int.con.model)[1,2], MuMIn::r.squaredGLMM(quad.int.con.model)[1,2])
colnames(r2.int.con)[c(1,2)] <- paste0(rep(c("Linear", "Quadratic")), colnames(r2.int.con)[c(1,2)])
r2.int.con %>% kable(digit = 2)
```

분석 결과, `통제 집단`과 달리 `실험 집단`에서의 **Intrusion (L2>D1)**과 예측 오류의 관계는 선형 모형 `lin.int.exp.model` 보다는 비단조적 모형 `quad.int.exp.model`에 더 가까운 것으로 나타났다.

<br> 

참가자들의 **Updating Score**에 대하여 참가자에 의한 무선효과를 고려한 혼합 모형을 구성하였다. 모형은 각 집단에서 예측 오류와 **Updating Score** 값 간의 선형 관계를 가정한 선형 혼합 모형 `lin.us.exp.model`, `lin.us.con.model`과 비단조적 관계를 가정한 `quad.us.exp.model`,`quad.Us.con.model`로 구분되었다. 이어서 각 집단에서 어떤 모형이 **Updating Score**와 예측 오류 조건 간의 관계를 더 잘 설명하는지 모형 간 비교를 수행하였다.

```{r d3_src_byPE_US_model, warning=FALSE, message=FALSE}
# experimental group
lin.us.exp.model <- lmer(US ~ cPEn + (1|SN), p3.US.long.exp.fit, 
                          control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
quad.us.exp.model <- lmer(US ~ poly(cPEn, 2) + (1|SN), p3.US.long.exp.fit, 
                           control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)

# control group
lin.us.con.model <- lmer(US ~ cPEn + (1|SN), p3.US.long.con.fit, 
                          control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
quad.us.con.model <- lmer(US ~ poly(cPEn, 2) + (1|SN), p3.US.long.con.fit, 
                           control = lmerControl(optCtrl = list(maxfun = 1e6)), REML=FALSE)
```

`실험 집단`에서 각 모형을 분석한 결과는 아래와 같다.

```{r d3_src_byPE_US_model_comparison1, warning=FALSE, message=FALSE}
anova(lin.us.exp.model, quad.us.exp.model) %>% kable(digit=3)
r2.us.exp <-cbind(MuMIn::r.squaredGLMM(lin.us.exp.model)[1,2], MuMIn::r.squaredGLMM(quad.us.exp.model)[1,2])
colnames(r2.us.exp)[c(1,2)] <- paste0(rep(c("Linear", "Quadratic")), colnames(r2.us.exp)[c(1,2)])
r2.us.exp %>% kable(digit = 2)
```

`통제 집단`에서 각 모형을 분석한 결과는 아래와 같다. 

```{r d3_src_byPE_US_model_comparison2, warning=FALSE, message=FALSE}
anova(quad.us.con.model, lin.us.con.model) %>% kable(digit=3)
r2.us.con <-cbind(MuMIn::r.squaredGLMM(lin.us.con.model)[1,2], MuMIn::r.squaredGLMM(quad.us.con.model)[1,2])
colnames(r2.us.con)[c(1,2)] <- paste0(rep(c("Linear", "Quadratic")), colnames(r2.us.con)[c(1,2)])
r2.us.con %>% kable(digit = 2)
```

분석 결과, `통제 집단`과 달리 `실험 집단`에서의 **Updating Score**와 예측 오류의 관계는 선형 모형 `lin.us.exp.model` 보다는 비단조적 모형 `quad.us.exp.model`에 더 가까운 것으로 나타났다.

<br><br>

### Day 3 출처 기억 확신도

<br>

출처 반응 분석 결과를 보충하기 위해 출처 반응의 확신도를 분석하였다. 출처 반응 패턴에 대한 확신도를 분석할 때, 각 출처 반응에 포함되는 시행수가 너무 작을 경우 결과를 오도할 위험성이 있다. 따라서 분석에 앞서 각 출처 반응의 시행수를 살펴보았다. 아래의 표는 각 물체 목록에서의 출처 반응에 따른 시행수를 나타낸다. `목록 1`과 `목록 2`의 물체를 `New`로 반응한 시행은 `목록 1`에서 4.29, `목록 2`에서 3.32 시행으로 매우 적어 확신도 분석에 포함하지 않았다. 추가로 `목록 3`에 대한 출처 반응은 본 실험의 주요 고려 대상이 아니었으므로 분석에 포함하지 않았다.

```{r}
# The number of trials per condition
p3 %>% group_by(SN, cSrc, Resp) %>% 
  summarise(NumTrial = length(Resp)) %>% 
  ungroup %>% 
  group_by(cSrc, Resp) %>%
  summarise(Avg = mean(NumTrial), 
            Med = median(NumTrial), 
            Min = min(NumTrial), 
            Max = max(NumTrial)) %>% 
  ungroup %>% kable(digit=4)
```

이에 따라 확신도 분석은 출처 기억 검사에서 학습한 것으로 반응한 경우(`목록 1`과 `목록 2`에서 정확하게 출처 반응을 한 **List 1 Corrct**, **List 2 Corrct**와 `목록 1`, `목록 2`에서 출처를 서로 다르게 반응한 **Source Confusion (L1>D2)**, **Intrusion (L2>D1)**에 대해서만 수행하였다. 

<br>

#### 출처 기억 확신도의 기술통계

<br>

```{r, warning= FALSE, message=FALSE}
# phase 1, subject-level, long-format
p3.AsyPtt.conf.long.all <- p3 %>% filter(cSrc != "List_3", Resp != "New") %>% group_by(SN, Btw, cSrc, Resp) %>%
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.AsyPtt.conf.wide.all <- p3.AsyPtt.conf.long.all %>% spread(key = Resp, value = Conf)
p3.AsyPtt.conf.long.all <- gather(p3.AsyPtt.conf.wide.all, Resp, Conf, Day_1:Day_2, factor_key=TRUE)
p3.AsyPtt.conf.long.all[is.na(p3.AsyPtt.conf.long.all)] <- 0 
p3.AsyPtt.conf.long.all <- arrange(p3.AsyPtt.conf.long.all, SN, cSrc, Resp, Conf)
p3.AsyPtt.conf.long.exp <- p3.AsyPtt.conf.long.all %>% filter(Btw==1)
p3.AsyPtt.conf.long.con <- p3.AsyPtt.conf.long.all %>% filter(Btw==2)

# wide format
p3.AsyPtt.conf.swide.all <- p3.AsyPtt.conf.long.all %>% spread(key = Resp, value = Conf)
p3.AsyPtt.conf.swide.exp <- p3.AsyPtt.conf.swide.all %>% filter(Btw==1)
p3.AsyPtt.conf.swide.con <- p3.AsyPtt.conf.swide.all %>% filter(Btw==2)

# summary table
p3.AsyPtt.conf.g.all <- p3.AsyPtt.conf.long.all %>% group_by(Btw, cSrc, Resp) %>%
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup()
p3.AsyPtt.conf.g.all$Conf.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.all, measurevar = "Conf", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cSrc","Resp"))$se
p3.AsyPtt.conf.g.all$Conf.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.all, measurevar = "Conf", idvar = "SN", 
                                                 betweenvars = "Btw", withinvars = c("cSrc","Resp"))$ci
p3.AsyPtt.conf.g.exp <- p3.AsyPtt.conf.g.all %>% filter(Btw==1)
p3.AsyPtt.conf.g.con <- p3.AsyPtt.conf.g.all %>% filter(Btw==2)
p3.AsyPtt.conf.g.table <- p3.AsyPtt.conf.g.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(Src_Resp = "cSrc_Resp")
p3.AsyPtt.conf.g.table$Src_Resp[p3.AsyPtt.conf.g.table$Src_Resp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.conf.g.table$Src_Resp[p3.AsyPtt.conf.g.table$Src_Resp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.conf.g.table$Src_Resp[p3.AsyPtt.conf.g.table$Src_Resp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.conf.g.table$Src_Resp[p3.AsyPtt.conf.g.table$Src_Resp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.conf.g.table.1 <- p3.AsyPtt.conf.g.table %>% filter(Btw == 1) %>% arrange(c(1 ,3, 4, 2))
p3.AsyPtt.conf.g.table.2 <- p3.AsyPtt.conf.g.table %>% filter(Btw == 2) %>% arrange(c(1 ,3, 4, 2))
p3.AsyPtt.conf.g.table.all <- rbind(p3.AsyPtt.conf.g.table.1, p3.AsyPtt.conf.g.table.2)
p3.AsyPtt.conf.g.table.all %>% kable(digits=2)
```

<br>
  
두 물체 목록(`목록 1`, `목록 2`)의 출처 반응에서 확신도가 어떻게 나타나는지 살펴보기 위해, 각 집단에서 물체 목록의 출처 반응 확신도 평균과 표준편차를 계산하였다. 그래프에서 A는 전체 집단의 물체 목록에 따른 출처 반응, B는 실험 집단, C는 통제집단을 나타낸다. A 그래프에서 x축은 물체 목록에 따른 출처 반응, y축은 반응 비율을 나타내며, 색은 각 집단을 나타낸다. B,C 그래프의 x축은 각 학습일에 학습한 물체 목록(첫째 날 학습 `목록 1`, 둘째 날 학습 `목록 2`, 새로운 물체 `목록 3`)을 나타내며, y축은 확신도 반응을 나타낸다. 각 집단에서 해당 물체 목록에 대한 출처 귀인 반응을 첫째 날 학습 `Day 1`, 둘째 날 학습 `Day 2`, 학습하지 않음 `New`로 구분하였다. 모든 그래프에서 빨간 점은 평균을 나타내며, 오차 막대는 95% 신뢰구간으로 표시하였다.

<br>

```{r, fig.width= 10, fig.height=12}
## plot
p3.conf.all.plot1 <- ggplot(data=p3.AsyPtt.conf.long.all, aes(x=Resp, y=Conf, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.conf.g.all, aes(x = Resp, y = Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~cSrc, scales="free_x", 
             labeller = labeller(cSrc = c("List_1" = "List 1 (Day 1)","List_2" = "List 2 (Day 2)"))) +
  scale_x_discrete(labels=c("Day 1","Day 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Source Response by Object List", y = "Confidence Rating (1-4)", fill ="Group") +
  # ggtitle("Confidence Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position="top")
p3.conf.exp.plot1 <- ggplot(data=p3.AsyPtt.conf.long.exp, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=Conf, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.conf.swide.exp,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.conf.g.exp, aes(x = cSrc, y = Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Object List", y = "Confidence Rating (1 - 4)", fill ="Attribution") +
  # ggtitle("Confidence Response (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position="top")
p3.conf.con.plot1 <- ggplot(data=p3.AsyPtt.conf.long.con, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=Conf, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.conf.swide.con,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.conf.g.con, aes(x = cSrc, y = Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Object List", y = "Confidence Rating (1 - 4)", fill ="Attribution") +
  # ggtitle("Confidence Response (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position="top")
ggpubr::ggarrange(p3.conf.all.plot1, labels = "A) All Group",
          ggpubr::ggarrange(p3.conf.exp.plot1, p3.conf.con.plot1, ncol = 2, labels = c("B) Experimental", "C) Control"),
                    hjust = -0.1, vjust=1, font.label = list(size = 16)), nrow = 2,
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

#### 비대칭적 출처 반응에서의 확신도

<br>

집단과 출처 반응에 따른 확신도의 차이를 분석하였다. 집단과 출처 반응을 요인으로 한 2 X 4 혼합 요인 분산분석을 수행하였다.

```{r, warning=FALSE, message=FALSE}
# List 1 & 2 Confidence of Source Response
p3.AsyPtt.conf.long.all.1 <- p3.AsyPtt.conf.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp") 
p3.AsyPtt.conf.long.all.1$sResp[p3.AsyPtt.conf.long.all.1$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.conf.long.all.1$sResp[p3.AsyPtt.conf.long.all.1$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.conf.long.all.1$sResp[p3.AsyPtt.conf.long.all.1$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.conf.long.all.1$sResp[p3.AsyPtt.conf.long.all.1$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.conf.long.all.1$sResp <- factor(p3.AsyPtt.conf.long.all.1$sResp)

p3.AsyPtt.conf.g.all.1 <- p3.AsyPtt.conf.long.all.1 %>% group_by(Btw, sResp) %>%
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup()
p3.AsyPtt.conf.g.all.1$Conf.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.all.1, idvar = "SN",
                                                        measurevar = "Conf", betweenvars = "Btw", withinvars = "sResp")$se
p3.AsyPtt.conf.g.all.1$Conf.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.all.1, idvar = "SN",
                                                        measurevar = "Conf", betweenvars = "Btw", withinvars = "sResp")$ci
p3.AsyPtt.conf.g.all.1 %>% arrange(c(4, 1, 2, 3, 8, 5, 6, 7)) %>%  kable(digit=2)

p3.AsyPtt.conf.all.1.aov <- aov_ez(id = "SN", dv = "Conf", data = p3.AsyPtt.conf.long.all.1, between = "Btw", within = "sResp")
anova(p3.AsyPtt.conf.all.1.aov, es = "pes") %>% kable(digits = 3)
```

<br>

분석 결과, 출처 반응의 주효과가 유의하였다. 집단의 주효과와 집단과 출처 반응의 상호작용은 유의하지 않았다.

```{r, warning=FALSE, message=FALSE}
# source response contrast
p3.AsyPtt.conf.m1.1.all <- emmeans(p3.AsyPtt.conf.all.1.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.conf.m1.1.all$contrasts %>% kable(digit=3)

```

<br>

각 집단에서 출처 반응에 따른 사후 분석을 수행한 결과, `실험 집단`에서 **List 1 Correct (L1>D1)**은 **Source Confusion (L1>D2)**, **Intrusion (L2>D1)** 보다 유의하게 높은 확신도를 보였다. 또한 **Source Confusion (L1>D2)**보다는 **Intrusion (L2>D1)**, **List 2 Correct (L2>D2)**이 더 높은 확신도를 보였다. **List 1 Correct (L1>D1)**과 **List 2 Correct (L2>D2)**, **Intrusion (L2>D1)**과 **List 2 Correct (L2>D2)** 간의 차이는 유의하지 않았다.
<br>
`통제 집단`에서는 **List 1 Correct (L1>D1)**이 **Source Confusion (L1>D2)** 보다 유의하게 높은 확신도를 보였다. 또한 **Source Confusion (L1>D2)**보다는 **Intrusion (L2>D1)**, **List 2 Correct (L2>D2)**이 더 높은 확신도를 보였다. 이 외에, **List 1 Correct (L1>D1)**과 **Intrusion (L2>D1)**, **List 2 Correct (L2>D2)**의 차이, **Intrusion (L2>D1)**과 **List 2 Correct (L2>D2)`** 간의 차이는 유의하지 않았다. 

<br>

#### 예측 오류 조건에 따른 출처 기억 확신도

<br>

집단, 예측 오류 조건에 따른 출처 반응 확신도를 분석하였다. 출처 반응 패턴 분석과 유사하게, 네 가지 주요 종속 변인, **List 1 Correct (L1>D1)**, **List 2 Correct (L2>D2)**, **Source Confusion (L1>D2)**, **Intrusion (L2>D1)**에서 예측 오류 조건과 집단에 의한 확신도 차이를 살펴보았다.

<br>

##### 예측 오류 조건에 따른 출처 기억 확신도 패턴

<br>

먼저 각 예측 오류 조건에서 출처 반응 패턴에 따른 출처 기억 확신도를 살펴보았다.
  
```{r}
p3.AsyPtt.conf.long.pe <- p3 %>%  group_by(SN, Btw, cSrc, cPE, Resp) %>%
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.AsyPtt.conf.wide.pe <- p3.AsyPtt.conf.long.pe %>% spread(key = Resp, value = Conf)
p3.AsyPtt.conf.long.pe <- gather(p3.AsyPtt.conf.wide.pe, Resp, Conf, Day_1:New, factor_key=TRUE)
p3.AsyPtt.conf.long.pe[is.na(p3.AsyPtt.conf.long.pe)] <- 0 
p3.AsyPtt.conf.long.pe <- arrange(p3.AsyPtt.conf.long.pe, SN, cSrc, cPE, Resp, Conf)
p3.AsyPtt.conf.long.pe <- p3.AsyPtt.conf.long.pe %>% filter(cSrc != "List_3", Resp != "New", cPE!="pe0")
p3.AsyPtt.conf.long.pe.exp <- p3.AsyPtt.conf.long.pe %>% filter(Btw==1)
p3.AsyPtt.conf.long.pe.con <- p3.AsyPtt.conf.long.pe %>% filter(Btw==2)

# wide format
p3.AsyPtt.conf.swide.pe <- p3.AsyPtt.conf.long.pe %>% spread(key = Resp, value = Conf)
p3.AsyPtt.conf.swide.pe.exp <- p3.AsyPtt.conf.swide.pe %>% filter(Btw==1)
p3.AsyPtt.conf.swide.pe.con <- p3.AsyPtt.conf.swide.pe %>% filter(Btw==2)

# summary table
p3.AsyPtt.conf.g.pe <- p3.AsyPtt.conf.long.pe  %>% 
  group_by(Btw, cPE, cSrc, Resp) %>%
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup()
p3.AsyPtt.conf.g.pe$Conf.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.pe, measurevar = "Conf", idvar = "SN", 
                                                betweenvars = "Btw", withinvars = c("cPE","cSrc","Resp"))$se
p3.AsyPtt.conf.g.pe$Conf.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.pe, measurevar = "Conf", idvar = "SN", 
                                                betweenvars = "Btw", withinvars = c("cPE","cSrc","Resp"))$ci
p3.AsyPtt.conf.g.pe.exp <- p3.AsyPtt.g.pe %>% filter(Btw==1)
p3.AsyPtt.conf.g.pe.con <- p3.AsyPtt.g.pe %>% filter(Btw==2)
p3.AsyPtt.conf.g.pe %>% kable(digits=2)
```

<br>
  
```{r, fig.width=18, fig.height=6}
p3.AsyPtt.conf.long.pe1 <- p3.AsyPtt.conf.long.pe %>% filter(cPE == "pe1")
p3.AsyPtt.conf.g.all.pe1 <- p3.AsyPtt.conf.g.pe %>% filter(cPE == "pe1")
p3.all.plot3.conf.pe1 <- ggplot(data=p3.AsyPtt.conf.long.pe1, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.conf.g.all.pe1, aes(x = cSrc, y=Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Source Response by Object List", y = "Confidence Rating (1-4)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))

p3.AsyPtt.conf.long.pe2 <- p3.AsyPtt.conf.long.pe %>% filter(cPE == "pe2")
p3.AsyPtt.conf.g.all.pe2 <- p3.AsyPtt.conf.g.pe %>% filter(cPE == "pe2")
p3.all.plot3.conf.pe2 <- ggplot(data=p3.AsyPtt.conf.long.pe2, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.conf.g.all.pe2, aes(x = cSrc, y=Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Source Response by Object List", y = "Confidence Rating (1-4)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))
p3.AsyPtt.conf.long.pe3 <- p3.AsyPtt.conf.long.pe %>% filter(cPE == "pe3")
p3.AsyPtt.conf.g.all.pe3 <- p3.AsyPtt.conf.g.pe %>% filter(cPE == "pe3")
p3.all.plot3.conf.pe3 <- ggplot(data=p3.AsyPtt.conf.long.pe3, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.conf.g.all.pe3, aes(x = cSrc, y=Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Source Response by Object List", y = "Confidence Rating (1-4)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85))


ggpubr::ggarrange(p3.all.plot3.conf.pe1, p3.all.plot3.conf.pe2, p3.all.plot3.conf.pe3, ncol=3, 
          labels = c("A) PE 1 (0%)", "B) PE 2 (50%)", "C) PE 3 (100%)"),
          hjust = -0.1, vjust=1, font.label = list(size = 16)) 
```

<br>

각 예측 오류 조건에서 출처 반응에 따른 확신도의 혼합 요인 분산 분석을 수행하였다. 

```{r}
p3.AsyPtt.conf.long.pe.1 <- p3.AsyPtt.conf.long.pe %>% unite(cSrc_Resp, c(cSrc,Resp), remove=FALSE) %>% 
  rename(sResp = "cSrc_Resp") 
p3.AsyPtt.conf.long.pe.1$sResp[p3.AsyPtt.conf.long.pe.1$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.conf.long.pe.1$sResp[p3.AsyPtt.conf.long.pe.1$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.conf.long.pe.1$sResp[p3.AsyPtt.conf.long.pe.1$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.conf.long.pe.1$sResp[p3.AsyPtt.conf.long.pe.1$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.conf.long.pe.1$sResp <- factor(p3.AsyPtt.conf.long.pe.1$sResp)
p3.AsyPtt.conf.long.pe1.1 <- p3.AsyPtt.conf.long.pe.1 %>% filter(cPE=="pe1")
p3.AsyPtt.conf.long.pe2.1 <- p3.AsyPtt.conf.long.pe.1 %>% filter(cPE=="pe2")
p3.AsyPtt.conf.long.pe3.1 <- p3.AsyPtt.conf.long.pe.1 %>% filter(cPE=="pe3")

p3.AsyPtt.conf.g.pe.1 <- p3.AsyPtt.conf.long.pe.1 %>% group_by(Btw, cPE, sResp) %>%
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup()
p3.AsyPtt.conf.g.pe.1$Conf.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.pe.1, idvar = "SN",
                                                         measurevar = "Conf", betweenvars = "Btw", withinvars = c("cPE","sResp"))$se
p3.AsyPtt.conf.g.pe.1$Conf.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.conf.long.pe.1, idvar = "SN",
                                                         measurevar = "Conf", betweenvars = "Btw", withinvars = c("cPE","sResp"))$ci
p3.AsyPtt.conf.g.pe1.1 <- p3.AsyPtt.conf.g.pe.1 %>% filter(cPE=="pe1")
p3.AsyPtt.conf.g.pe2.1 <- p3.AsyPtt.conf.g.pe.1 %>% filter(cPE=="pe2")
p3.AsyPtt.conf.g.pe3.1 <- p3.AsyPtt.conf.g.pe.1 %>% filter(cPE=="pe3")
```

`PE 1` 조건에서의 분석 결과는 아래와 같다.

```{r}
p3.AsyPtt.conf.g.pe1.1 %>% kable(digits=2)
p3.AsyPtt.conf.pe1.1.aov <- aov_ez(id = "SN", dv = "Conf", data = p3.AsyPtt.conf.long.pe1.1, between = "Btw", within = "sResp")
anova(p3.AsyPtt.conf.pe1.1.aov, es = "pes") %>% kable(digits = 3)
```
<br>

분석 결과, 출처 반응의 주효과가 유의하였다. 

```{r, warning=FALSE, message=FALSE}
p3.AsyPtt.conf.pe1.m1 <- emmeans(p3.AsyPtt.conf.pe1.1.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.conf.pe1.m1$contrasts %>% kable(digit=3)
```
<br>

`실험 집단`과 `통제 집단` 모두에서, **Source Confusion**의 확신도는 **List 1 Correct**, **List 2 Correct**보다 유의하게 낮았다.
추가로, `통제 집단`에서 **Intrusion**과 **Source Confusion** 간의 확신도 차이는 유의하였다.

<br>

`PE 2` 조건에서의 분석 결과는 아래와 같다.

```{r}
p3.AsyPtt.conf.g.pe2.1 %>% kable(digits=2)
p3.AsyPtt.conf.pe2.1.aov <- aov_ez(id = "SN", dv = "Conf", data = p3.AsyPtt.conf.long.pe2.1, between = "Btw", within = "sResp")
anova(p3.AsyPtt.conf.pe2.1.aov, es = "pes") %>% kable(digits = 3)
```

<br>

분석 결과, 출처 반응의 주효과가 유의하였다. 

```{r, warning=FALSE, message=FALSE}
p3.AsyPtt.conf.pe2.m1 <- emmeans(p3.AsyPtt.conf.pe2.1.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.conf.pe2.m1$contrasts %>% kable(digit=3)
```

<br>

`실험 집단`과 `통제 집단` 모두에서, **Source Confusion**의 확신도는 **List 1 Correct**, **List 2 Correct**보다 유의하게 낮았다.
`실험 집단`에서 **Intrusion**과 **Source Confusion** 간의 확신도 차이는 유의하였다.
  
<br>
  
`PE 2` 조건에서의 분석 결과는 아래와 같다.

```{r}
p3.AsyPtt.conf.g.pe3.1 %>% kable(digits=2)
p3.AsyPtt.conf.pe3.1.aov <- aov_ez(id = "SN", dv = "Conf", data = p3.AsyPtt.conf.long.pe3.1, between = "Btw", within = "sResp")
anova(p3.AsyPtt.conf.pe3.1.aov, es = "pes") %>% kable(digits = 3)
```

<br>

분석 결과, 출처 반응의 주효과가 유의하였다. 

```{r, warning=FALSE, message=FALSE}
p3.AsyPtt.conf.pe3.m1 <- emmeans(p3.AsyPtt.conf.pe3.1.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.conf.pe3.m1$contrasts %>% kable(digit=3)
```

<br>

`실험 집단`과 `통제 집단` 모두에서, **Source Confusion**의 확신도는 **List 1 Correct**, **List 2 Correct**보다 유의하게 낮았다.
또한 **Intrusion**과 **Source Confusion** 간의 확신도 차이는 유의하였다.
  
<br>

##### 목록 1 정확반응의 확신도

<br> 

**List 1 Correct (L1>D1)** 에서 집단과 예측 오류 조건에 따른 확신도 차이가 있는지 확인하기 위해 조건에 대한 정확도 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 리본은 95% 신뢰구간을 표시한다.

```{r, fig.width= 18, fig.height=6}
## List 1 Correct Response
# long format
p3.Acc.conf.long.all.1 <- p3 %>% filter(cSrc == "List_1", cPE != "pe0", Correct == 1) %>% group_by(SN, Btw, cPE) %>% 
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.Acc.conf.long.exp.1<- p3.Acc.conf.long.all.1 %>% filter(Btw==1)
p3.Acc.conf.long.con.1 <- p3.Acc.conf.long.all.1 %>% filter(Btw==2)

# wide format
p3.Acc.conf.swide.all.1 <- p3.Acc.conf.long.all.1 %>% spread(key = cPE, value = Conf)
p3.Acc.conf.swide.exp.1 <- p3.Acc.conf.swide.all.1 %>% filter(Btw==1)
p3.Acc.conf.swide.con.1 <- p3.Acc.conf.swide.all.1 %>% filter(Btw==2)

# summary
p3.Acc.conf.g.all.1 <- p3.Acc.conf.long.all.1 %>%  group_by(Btw, cPE) %>% 
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup() 
p3.Acc.conf.g.all.1$Conf.se <- Rmisc::summarySEwithin(data = p3.Acc.conf.long.all.1, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.conf.g.all.1$Conf.ci <- Rmisc::summarySEwithin(data = p3.Acc.conf.long.all.1, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.conf.g.exp.1 <- p3.Acc.conf.g.all.1 %>% filter(Btw==1)
p3.Acc.conf.g.con.1 <- p3.Acc.conf.g.all.1 %>% filter(Btw==2)
p3.Acc.conf.g.all.1 %>% kable(digit=2)

## plot
p3.conf.all.plot2.2.1 <- ggplot(p3.Acc.conf.g.all.1, mapping=aes(x=cPE, y=Conf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.conf.g.all.1, mapping = aes(x=cPE, y=Conf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.conf.exp.plot2.2.1 <- ggplot(p3.Acc.conf.g.exp.1, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.conf.long.exp.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Acc.conf.long.exp.1, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.conf.con.plot2.2.1 <- ggplot(p3.Acc.conf.g.con.1, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.conf.long.con.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Acc.conf.long.con.1, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.conf.all.plot2.2.1, p3.conf.exp.plot2.2.1, p3.conf.con.plot2.2.1, ncol=3, 
          labels = c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>

확신도에 대하여 참가자 간 변인인 집단, 참가자 내 변인인 예측 오류 조건을 요인으로 하는 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.conf.1 <- aov_ez(id = "SN", dv = "Conf", data = p3.Acc.conf.long.all.1, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.conf.1, es = "pes") %>% kable(digits = 3)
```
<br>

분석 결과, 모든 효과가 유의하지 않았다.

<br>

##### 목록 1 출처 혼동의 확신도

<br>

**Source Confusion (L1>D2)**에서 집단, 예측 오류 조건에 따른 확신도 평균과 표준편차를 계산하였다. 
24번, 25번 참가자는 일부 예측 오류 조건에서 **Source Confusion** 반응이 없었기 때문에 확신도 반응도 없었다. 
따라서 결과가 왜곡되는 것을 방지하기 위해 분석에서 제외하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>

```{r, fig.width= 12, fig.height=6}
## List 1 Source Confusion
# long format
p3.Err.conf.long.all <- p3 %>% filter(cSrc == "List_1", cPE != "pe0", Err == 1, SN != 24, SN != 25) %>% group_by(SN, Btw, cPE) %>% 
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.Err.conf.long.exp <- p3.Err.conf.long.all %>% filter(Btw==1)
p3.Err.conf.long.con <- p3.Err.conf.long.all %>% filter(Btw==2)

# wide format
p3.Err.conf.swide.all <- p3.Err.conf.long.all %>% spread(key = cPE, value = Conf)
p3.Err.conf.swide.exp <- p3.Err.conf.swide.all %>% filter(Btw==1)
p3.Err.conf.swide.con <- p3.Err.conf.swide.all %>% filter(Btw==2)

# summary
p3.Err.conf.g.all <- p3.Err.conf.long.all %>%  group_by(Btw, cPE) %>% 
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup() 
p3.Err.conf.g.all$Conf.se <- Rmisc::summarySEwithin(data = p3.Err.conf.long.all, measurevar = "Conf", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Err.conf.g.all$Conf.ci <- Rmisc::summarySEwithin(data = p3.Err.conf.long.all, measurevar = "Conf", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Err.conf.g.exp <- p3.Err.conf.g.all %>% filter(Btw==1)
p3.Err.conf.g.con <- p3.Err.conf.g.all %>% filter(Btw==2)
p3.Err.conf.g.all %>% kable(digit=2)

## plot 
p3.conf.all.plot2.3 <- ggplot(p3.Err.conf.g.all, mapping=aes(x=cPE, y=Conf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Err.conf.g.all, mapping = aes(x=cPE, y=Conf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)", fill="Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.conf.exp.plot2.3 <- ggplot(p3.Err.conf.g.exp, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Err.conf.long.exp, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Err.conf.long.exp, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Source Confusions (L1>D2; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.conf.con.plot2.3 <- ggplot(p3.Err.conf.g.con, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Err.conf.long.con, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Err.conf.long.con, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Source Confusions (L1>D2; Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.conf.all.plot2.3, p3.conf.exp.plot2.3, p3.conf.con.plot2.3, ncol=3, 
          labels=c("A) All Group","B) Experimental","C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Err.all.aov.conf <- aov_ez(id = "SN", dv = "Conf", data = p3.Err.conf.long.all, between = "Btw", within = "cPE")
anova(p3.Err.all.aov.conf, es = "pes") %>% kable(digits = 3)
```

<br>

분석 결과, 모든 효과가 유의하지 않았다.

<br>

##### 목록 2 정확반응의 확신도

<br>

**List 2 Correct (L2>D2)**에서 집단과 예측 오류에 따른 확신도 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 


<br>

```{r, fig.width= 12, fig.height=6}
## List 2 Correct Source Memory
# long format
p3.Acc.conf.long.all.2 <- p3 %>%  filter(cSrc == "List_2", cPE != "pe0", Correct == 1) %>% group_by(SN, Btw, cPE) %>% 
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.Acc.conf.long.exp.2 <- p3.Acc.conf.long.all.2 %>% filter(Btw==1)
p3.Acc.conf.long.con.2 <- p3.Acc.conf.long.all.2 %>% filter(Btw==2)

# wide format
p3.Acc.conf.swide.all.2 <- p3.Acc.conf.long.all.2 %>% spread(key = cPE, value = Conf)
p3.Acc.conf.swide.exp.2 <- p3.Acc.conf.swide.all.2 %>% filter(Btw==1)
p3.Acc.conf.swide.con.2 <- p3.Acc.conf.swide.all.2 %>% filter(Btw==2)

# summary
p3.Acc.conf.g.all.2 <- p3.Acc.conf.long.all.2 %>%  group_by(Btw, cPE) %>% 
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup() 
p3.Acc.conf.g.all.2$Conf.se <- Rmisc::summarySEwithin(data = p3.Acc.conf.long.all.2, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.conf.g.all.2$Conf.ci <- Rmisc::summarySEwithin(data = p3.Acc.conf.long.all.2, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.conf.g.exp.2 <- p3.Acc.conf.g.all.2 %>% filter(Btw==1)
p3.Acc.conf.g.con.2 <- p3.Acc.conf.g.all.2 %>% filter(Btw==2)
p3.Acc.conf.g.all.2 %>% kable(digit=2)

## plot
p3.conf.all.plot2.2.2 <- ggplot(p3.Acc.conf.g.all.2, mapping=aes(x=cPE, y=Conf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.conf.g.all.2, mapping = aes(x=cPE, y=Conf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)", fill="Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")

p3.conf.exp.plot2.2.2 <- ggplot(p3.Acc.conf.g.exp.2, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.conf.long.exp.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Acc.conf.long.exp.2, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 Correct SM (L2>D2; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.conf.con.plot2.2.2 <- ggplot(p3.Acc.conf.g.con.2, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.conf.long.con.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Acc.conf.long.con.2, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 Correct SM (L2>D2; Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.conf.all.plot2.2.2, p3.conf.exp.plot2.2.2, p3.conf.con.plot2.2.2, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 예측 오류 조건에 따른 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.conf.2 <- aov_ez(id = "SN", dv = "Conf", data = p3.Acc.conf.long.all.2, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.conf.2, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

##### 목록 2 침범의 확신도

<br>

**Intrusion (L2>D1)** 확신도의 집단과 예측 오류 조건에 따른 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

<br>

```{r, fig.width= 12, fig.height=6}
## List 2 Intrusion
# long format
p3.Intru.conf.long.all <- p3 %>% filter(cSrc == "List_2", cPE != "pe0", Int == 1) %>% group_by(SN, Btw, cPE) %>% 
  summarise(Conf = mean(Conf)) %>% ungroup()
p3.Intru.conf.long.exp <- p3.Intru.conf.long.all %>% filter(Btw==1)
p3.Intru.conf.long.con <- p3.Intru.conf.long.all %>% filter(Btw==2)

# wide format
p3.Intru.conf.swide.all <- p3.Intru.conf.long.all %>% spread(key = cPE, value = Conf)
p3.Intru.conf.swide.exp <- p3.Intru.conf.swide.all %>% filter(Btw==1)
p3.Intru.conf.swide.con <- p3.Intru.conf.swide.all %>% filter(Btw==2)

# summary
p3.Intru.conf.g.all <- p3.Intru.conf.long.all %>%  group_by(Btw, cPE) %>% 
  summarise(Conf.M = mean(Conf), Conf.SD = sd(Conf)) %>% ungroup() 
p3.Intru.conf.g.all$Conf.se <- Rmisc::summarySEwithin(data = p3.Intru.conf.long.all, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Intru.conf.g.all$Conf.ci <- Rmisc::summarySEwithin(data = p3.Intru.conf.long.all, measurevar = "Conf", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Intru.conf.g.exp <- p3.Intru.conf.g.all %>% filter(Btw==1)
p3.Intru.conf.g.con <- p3.Intru.conf.g.all %>% filter(Btw==2)
p3.Intru.conf.g.all %>% kable(digit=2)

## plot
p3.conf.all.plot2.1 <- ggplot(p3.Intru.conf.g.all, mapping=aes(x=cPE, y=Conf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Intru.conf.g.exp, mapping = aes(x=cPE, y=Conf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)", fill="Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.conf.exp.plot2.1 <- ggplot(p3.Intru.conf.g.exp, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Intru.conf.long.exp, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Intru.conf.long.exp, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Intrusion (L2>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.conf.con.plot2.1 <- ggplot(p3.Intru.conf.g.con, mapping=aes(x=cPE, y=Conf.M, group=1)) + 
  geom_ribbon(aes(ymin=Conf.M-Conf.ci, ymax=Conf.M+Conf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=Conf.M, ymax=Conf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Intru.conf.long.con, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=Conf, group=SN, color=SN)) +
  geom_point(p3.Intru.conf.long.con, mapping = aes(x=cPE, y=Conf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Confidence Rating (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("Intrusion (L2>D1; Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.conf.all.plot2.1, p3.conf.exp.plot2.1, p3.conf.con.plot2.1, ncol=3, 
          labels=c("A) All Group","B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 예측 오류 조건을 요인으로 한 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Intru.all.aov.conf <- aov_ez(id = "SN", dv = "Conf", data = p3.Intru.conf.long.all, between = "Btw", within = "cPE")
anova(p3.Intru.all.aov.conf, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

### Day 3 연합 기억 정확도

<br>

출처 기억 반응에서는 예측 오류를 수반한 재활성화에 의해 기억 갱신 효과가 나타난다는 출처 반응 및 확신도 패턴을 확인할 수 있었다.
그러나 이러한 결과가 기억의 손상에 의한 것이 아닌 갱신에 의한 것이라는 점을 확인하기 위해서는 첫 날과 둘째 날에 학습한 연합 기억이 어느 정도 유지되어 있어야 한다. 또한 본 실험에서 유도한 재공고화, 예측 오류를 수반한 재활성화가 출처 기억 뿐만 아니라 연합 기억에도 영향을 준다면, 각 조건에 따라 일정한 패턴을 확인할 수 있을 것이다. 따라서 집단, 출처 반응, 예측 오류 조건에서의 연합 기억 정확도를 분석하였다. 기억 검사 과제에서 `New`로 출처 반응을 한 경우에는 연합 기억 검사를 생략하였으므로, `목록 3`의 연합 기억은 분석할 수 없었다.  

<br>

#### 집단과 목록에 따른 연합 기억 정확도

<br>

  첫째 날과 둘째 날의 연합 기억 학습 수행을 비교한 분석에서는 둘째 날 연합 기억 학습이 첫째 날 연합 기억 학습보다 우수하게 나타났었다. 이러한 결과 패턴이 마지막 날의 연합 기억 검사에서도 유사하게 나타나는지 확인하였다. 또한 두 집단 간의 연합 기억 수행의 차이가 있는지도 확인하였다. 

<br>

```{r, fig.width=12, fig.height = 6}
# long format
p3.day.Asc.long.all <- p3 %>% filter(cSrc != "List_3", Resp != "New") %>% group_by(SN, Btw, cSrc) %>% 
  summarise(aCorr = mean(aCorr)*100) %>% ungroup
p3.day.Asc.long.exp <- p3.day.Asc.long.all %>% filter(Btw==1)
p3.day.Asc.long.con <- p3.day.Asc.long.all %>% filter(Btw==2)

# wide format
p3.day.Asc.swide.all <- p3.day.Asc.long.all %>% spread(key = cSrc, value = aCorr)
p3.day.Asc.swide.exp <- p3.day.Asc.swide.all %>% filter(Btw==1)
p3.day.Asc.swide.con <- p3.day.Asc.swide.all %>% filter(Btw==2)

# summary
p3.day.Asc.g.all <- p3.day.Asc.long.all %>% group_by(Btw, cSrc) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup()
p3.day.Asc.g.all$aCorr.se <- Rmisc::summarySEwithin(data = p3.day.Asc.long.all, measurevar = "aCorr", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cSrc")$se
p3.day.Asc.g.all$aCorr.ci <- Rmisc::summarySEwithin(data = p3.day.Asc.long.all, measurevar = "aCorr", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cSrc")$ci  
p3.day.Asc.g.exp <- p3.day.Asc.g.all %>% filter(Btw==1)
p3.day.Asc.g.con <- p3.day.Asc.g.all %>% filter(Btw==2)
p3.day.Asc.g.all %>% kable(digits=2)

## plot
p3.day.Asc.all.plot.1 <- ggplot(data=p3.day.Asc.long.all, aes(x=Btw, y=aCorr, fill=cSrc)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=Btw, y=aCorr, group=cSrc, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.day.Asc.swide.all,Btw==1), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.day.Asc.swide.all,Btw==1)$"List_1",
                   xend=1+.16, yend=filter(p3.day.Asc.swide.all,Btw==1)$"List_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.day.Asc.swide.all,Btw==2), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.day.Asc.swide.all,Btw==2)$"List_1",
                   xend=2+.16, yend=filter(p3.day.Asc.swide.all,Btw==2)$"List_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.g.all, aes(x = Btw, y = aCorr.M, ymin = aCorr.M-aCorr.ci, ymax = aCorr.M+aCorr.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("List 1", "List 2")) +
  scale_x_discrete(labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(25, 100), clip = "on") +
  labs(x = "Group", y = "Accuracy (%)", fill ="Object List") +
  # ggtitle("Association Memory by Group") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")

p3.day.Asc.all.plot.2 <- ggplot(data=p3.day.Asc.long.all, aes(x=cSrc, y=aCorr, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aCorr, group=Btw, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.g.all, aes(x = cSrc, y = aCorr.M, ymin = aCorr.M-aCorr.ci, ymax = aCorr.M+aCorr.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(25, 100), clip = "on") +
  labs(x = "Object List", y = "Accuracy (%)", fill ="Group") +
  # ggtitle("Association Memory by Object List") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")

ggpubr::ggarrange(p3.day.Asc.all.plot.1, p3.day.Asc.all.plot.2, ncol = 2, 
          labels=c("A) Association Memory by Group","B) Association Memory by List"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

##### 혼합 요인 분산 분석

집단과 물체 목록을 요인으로 하는 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r, warning=FALSE, message=FALSE}
p3.day.Asc.all.aov <- aov_ez(id = "SN", dv = "aCorr", data = p3.day.Asc.long.all, between = "Btw", within = c("cSrc"))
anova(p3.day.Asc.all.aov, es = "pes") %>% kable(digits=3)
```

분석 결과, 물체 목록의 주효과는 유의하였다.

```{r, warning=FALSE, message=FALSE}
p3.day.Asc.m1.all <- emmeans(p3.day.Asc.all.aov, pairwise ~ cSrc | Btw, type = "response")
p3.day.Asc.m1.all$contrasts %>% kable(digits=3)

```

각 집단 별로 물체 목록에 대한 사후 분석을 수행한 결과, `실험 집단`에서 `목록 2`가 `목록 1`보다 우수한 연합 기억 수행을 보였다.

<br>

##### 일반화 선형 혼합 모형; GLMM

<br>

분산분석 결과를 보충하기 위해 집단과 물체 목록에서의 연합 기억 정확도 차이에 대한 일반화 선형 혼합 모형(일반화 선형 혼합 모형; GLMM)을 검증하였다. 집단과 물체 목록의 고정 효과(fixed effect)와 참가자와 자극 항목에 대한 무선 효과(random effect)를 포함한 모형 `p3.12.Acc.exp.Model.1`을 구성하였다.

```{r, eval=FALSE, warning=FALSE, message=FALSE}
p3.aCorr <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.aCorr <- p3.aCorr %>% filter(cSrc != 3, Resp != 3)
p3.aCorr$SN = factor(p3.aCorr$SN); p3.aCorr$Btw = factor(p3.aCorr$Btw)
p3.aCorr$cSrc = factor(p3.aCorr$cSrc, labels=c("List_1", "List_2"))
p3.aCorr$Resp <- factor(p3.aCorr$Resp, levels=c(1,2), labels=c("Day_1", "Day_2"))
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.12.Acc.all.Model.1 <- afex::mixed(aCorr ~ Btw*cSrc + (1|SN) + (1|IMname), 
                              p3.aCorr, method = "LRT", cl = cl, 
                              family=binomial(link="logit"),
                              control = glmerControl(optCtrl = list(maxfun = 1e6), optimizer = "bobyqa"))

save(p3.12.Acc.all.Model.1, file="memudet_day3_12asc_Acc_afex.Rdata")

stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_12asc_Acc_afex.Rdata")
```

```{r, eval=FALSE}
anova(p3.12.Acc.all.Model.1) %>% kable(digits=3)
```

분석 결과, 물체 목록의 주효과는 유의하였다.

```{r, eval=FALSE}
p3.day.Asc.m3.all <- emmeans(p3.12.Acc.all.Model.1, pairwise ~ cSrc | Btw, type = "response")
p3.day.Asc.m3.all$contrasts %>% kable(digits=4)
```

각 집단에서 물체 목록에 대한 사후 분석을 수행한 결과, `실험 집단`에서 `목록 1`의 연합 기억보다 `목록 2`의 연합 기억이 유의하게 우수하였다. 
`통제 집단`에서도 유사한 경향이 나타났으나, 통계적으로 유의하지 않았다.

<br>

#### 비대칭적 출처 반응에서의 연합 기억 정확도

<br>

물체 목록(`목록 1`, `목록 2`)에서 집단과 출처 반응에 따라 연합 기억이 어떻게 나타나는지 살펴보기 위해, 각 조건에 대한 연합 기억 정확도 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B, C는 각 집단을 나타내며, 빨간 점은 평균, 오차 막대는 95% 신뢰구간을 표시한다.

<br>

```{r, fig.width=10, fig.height = 12}
# long format
p3.AsyPtt.Asc.long.all <- p3 %>% filter(cSrc != "List_3", Resp != "New") %>% group_by(SN, Btw, cSrc, Resp) %>%
  summarise(aCorr = mean(aCorr)*100) %>% ungroup()
p3.AsyPtt.Asc.wide.all <- p3.AsyPtt.Asc.long.all %>% spread(key = Resp, value = aCorr)
p3.AsyPtt.Asc.long.all <- gather(p3.AsyPtt.Asc.wide.all, Resp, aCorr, Day_1:Day_2, factor_key=TRUE)
p3.AsyPtt.Asc.long.all[is.na(p3.AsyPtt.Asc.long.all)] <- 0 
p3.AsyPtt.Asc.long.all <- arrange(p3.AsyPtt.Asc.long.all, SN, cSrc, Resp, aCorr)
p3.AsyPtt.Asc.long.exp <- p3.AsyPtt.Asc.long.all %>% filter(Btw==1)
p3.AsyPtt.Asc.long.con <- p3.AsyPtt.Asc.long.all %>% filter(Btw==2)

# wide format
p3.AsyPtt.Asc.swide.all <- p3.AsyPtt.Asc.long.all %>% spread(key = Resp, value = aCorr)
p3.AsyPtt.Asc.swide.exp <- p3.AsyPtt.Asc.swide.all %>% filter(Btw==1)
p3.AsyPtt.Asc.swide.con <- p3.AsyPtt.Asc.swide.all %>% filter(Btw==2)

# summary
p3.AsyPtt.Asc.g.all <- p3.AsyPtt.Asc.long.all %>% group_by(Btw, cSrc, Resp) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup()
p3.AsyPtt.Asc.g.all$aCorr.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.Asc.long.all, measurevar = "aCorr", 
                                                       idvar = "SN", betweenvars = "Btw", withinvars = c("cSrc","Resp"))$se
p3.AsyPtt.Asc.g.all$aCorr.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.Asc.long.all, measurevar = "aCorr", 
                                                       idvar = "SN", betweenvars = "Btw", withinvars = c("cSrc","Resp"))$ci  
p3.AsyPtt.Asc.g.exp <- p3.AsyPtt.Asc.g.all %>% filter(Btw==1)
p3.AsyPtt.Asc.g.con <- p3.AsyPtt.Asc.g.all %>% filter(Btw==2)
p3.AsyPtt.Asc.g.table.all <- p3.AsyPtt.Asc.g.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(sResp = "cSrc_Resp")
p3.AsyPtt.Asc.g.table.all$sResp[p3.AsyPtt.Asc.g.table.all$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.Asc.g.table.all$sResp[p3.AsyPtt.Asc.g.table.all$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.Asc.g.table.all$sResp[p3.AsyPtt.Asc.g.table.all$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.Asc.g.table.all$sResp[p3.AsyPtt.Asc.g.table.all$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.Asc.g.table.all %>% arrange(c(1,3,4,2,5,7,8,6)) %>% kable(digit=2)

## plot
p3.Asc.all.plot3 <- ggplot(data=p3.AsyPtt.Asc.long.all, aes(x=Resp, y=aCorr, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.Asc.g.all, aes(x = Resp, y=aCorr.M, ymin = aCorr.M - aCorr.ci, ymax = aCorr.M + aCorr.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~cSrc, scales="free_x", 
             labeller = labeller(cSrc = c("List_1" = "List 1 (Day 1)","List_2" = "List 2 (Day 2)"))) +
  scale_x_discrete(labels=c("Day 1", "Day 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Association Accuracy (%)", fill ="Group") +
  # ggtitle("Association Memory Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position="top")
p3.Asc.exp.plot3 <- ggplot(data=p3.AsyPtt.Asc.long.exp, aes(x=cSrc, y=aCorr, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aCorr, group=Resp, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.Asc.swide.exp,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.Asc.g.exp, aes(x = cSrc, y = aCorr.M, ymin = aCorr.M-aCorr.ci, ymax = aCorr.M+aCorr.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00", "#ff6164"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(25, 100), clip = "on") +
  labs(x = "Object List", y = "Accuracy (%)", fill ="Attribution") +
  # ggtitle("Association Memory (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")
p3.Asc.con.plot3 <- ggplot(data=p3.AsyPtt.Asc.long.con, aes(x=cSrc, y=aCorr, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aCorr, group=Resp, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.Asc.swide.con,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.Asc.g.con, aes(x = cSrc, y = aCorr.M, ymin = aCorr.M-aCorr.ci, ymax = aCorr.M+aCorr.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00", "#ff6164"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(25, 100), clip = "on") +
  labs(x = "Object List", y = "Accuracy (%)", fill ="Attribution") +
  # ggtitle("Association Memory (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")
ggpubr::ggarrange(p3.Asc.all.plot3, labels = "A) All Group",
          ggpubr::ggarrange(p3.Asc.exp.plot3, p3.Asc.con.plot3, ncol = 2, labels = c("B) Experimental", "C) Control"),
                    hjust = -0.1, vjust=1, font.label = list(size = 16)), nrow = 2,
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 출처 반응에 따른 연합 기억 정확도의 차이를 살펴보기 위해, 집단과 출처 반응을 요인으로 한 2 X 4 혼합 요인 분산분석을 수행하였다.

```{r, warning=FALSE, message=FALSE}
# List 1 & 2 Association Memory by Source Response
p3.AsyPtt.Asc.long.all <- p3.AsyPtt.Asc.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(sResp = "cSrc_Resp")
p3.AsyPtt.Asc.long.all$sResp[p3.AsyPtt.Asc.long.all$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.Asc.long.all$sResp[p3.AsyPtt.Asc.long.all$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.Asc.long.all$sResp[p3.AsyPtt.Asc.long.all$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.Asc.long.all$sResp[p3.AsyPtt.Asc.long.all$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.Asc.long.all$sResp <- factor(p3.AsyPtt.Asc.long.all$sResp)

p3.AsyPtt.Asc.all.1.aov <- aov_ez(id = "SN", dv = "aCorr", data = p3.AsyPtt.Asc.long.all, between = "Btw", within = "sResp")
anova(p3.AsyPtt.Asc.all.1.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 출처 반응의 주효과가 유의하였다.

```{r, warning=FALSE, message=FALSE}
# source response contrast
p3.AsyPtt.Asc.m1.1.all <- emmeans(p3.AsyPtt.Asc.all.1.aov, pairwise ~ sResp | Btw, type = "response")
p3.AsyPtt.Asc.m1.1.all$contrasts %>% kable(digit=3)
```

출처 반응에 따른 사후 분석을 수행한 결과, `실험 집단`에서 **List 2 Correct (L2>D2)**은 **Source Confusion (L1>D2)** 보다 유의하게 높은 연합 기억 정확도를 보였다. 통제 집단에서도 이와 마찬가지로 **List 2 Correct (L2>D2)**이 **Source Confusion (L1>D2)** 보다 유의하게 높은 연합 기억 정확도를 보였다. **Intrusion (L2>D1)**과 **Source Confusion (L1>D2)**, **List 2 Correct (L2>D2)** 간의 차이는 유의하지 않았다. 이 외에 다른 비교들도 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위해, 집단과 출처 반응을 고정 효과로 하고, 참가자와 자극의 무선 효과를 포함한 일반화 선형 혼합 모형을 검증하였다. 

```{r, warning=FALSE, message=FALSE}
p3.aRsp <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.aRsp <- p3.aRsp %>% filter(cSrc != 3, Resp != 3)
p3.aRsp$SN = factor(p3.aRsp$SN); p3.aRsp$Btw = factor(p3.aRsp$Btw)
p3.aRsp$cSrc = factor(p3.aRsp$cSrc, labels=c("List_1", "List_2"))
p3.aRsp$Resp <- factor(p3.aRsp$Resp, levels=c(1,2), labels=c("Day_1", "Day_2"))
p3.aRsp <- p3.aRsp %>% select(SN, Btw, cSrc, Resp, IMname, Corr, aCorr) %>% 
  unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(sResp = "cSrc_Resp")
p3.aRsp$sResp[p3.aRsp$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.aRsp$sResp[p3.aRsp$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.aRsp$sResp[p3.aRsp$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.aRsp$sResp[p3.aRsp$sResp=='List_2_Day_1'] <- 'Intrusion'

```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.Asyptt.Asc.all.Model.1 <- afex::mixed(aCorr ~ Btw*sResp + (1|SN) + (1|IMname), 
                              p3.aRsp, method = "LRT", cl = cl, 
                              family=binomial(link="logit"),
                              control = glmerControl(optCtrl = list(maxfun = 1e6), optimizer = "bobyqa"))

save(p3.Asyptt.Asc.all.Model.1, file="memudet_day3_Asyptt_Asc_afex.Rdata")

stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_12asc_Acc_afex.Rdata")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.Asyptt.Asc.all.Model.1) %>% kable(digits=3)
```

분석 결과, 출처 반응의 주효과가 유의하였다.

```{r, eval=FALSE, warning=FALSE, message=FALSE}
p3.Asyptt.Asc.m2.1.all <- emmeans(p3.Asyptt.Asc.all.Model.1, pairwise ~ sResp | Btw, type = "response")
p3.Asyptt.Asc.m2.1.all$contrasts %>% kable(digits=3)
```

사후 분석 결과, `실험 집단`에서 **List 1 Correct**의 연합 기억이 **Source Confusion**, **List 2 Correct**보다 우수하였다. 또한 **List 2 Correct**의 연합 기억은 **Source Confusion**, **Intrusion** 보다 우수하였다. `통제 집단`에서는 **List 1 Correct**의 연합 기억이 **Source Confusion** 보다 우수하였다. 그리고 **List 2 Correct**의 연합 기억이 **Source Confusion** 보다 우수하였다. 다른 비교는 유의하지 않았다.

<br>

#### 예측 오류 조건에 따른 연합 기억 정확도

<br>

##### 예측 오류에 따른 목록 1 연합 기억 정확도

<br>

`목록 1`에서 집단과 예측 오류 조건에 따라 연합 기억 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>

```{r, fig.width= 12, fig.height=6}
## List 1 Association Memory
# long format
p3.Acc.Asc.long.all.0 <- p3 %>% filter(cPE != "pe0", cSrc == "List_1") %>% group_by(SN, Btw, cPE) %>% 
  summarise(aCorr = mean(aCorr)*100) %>% ungroup()
p3.Acc.Asc.long.exp.0 <- p3.Acc.Asc.long.all.0 %>% filter(Btw==1)
p3.Acc.Asc.long.con.0 <- p3.Acc.Asc.long.all.0 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.swide.all.0 <- p3.Acc.Asc.long.all.0 %>% spread(key = cPE, value = aCorr)
p3.Acc.Asc.swide.exp.0 <- p3.Acc.Asc.swide.all.0 %>% filter(Btw==1)
p3.Acc.Asc.swide.con.0 <- p3.Acc.Asc.swide.all.0 %>% filter(Btw==2)

# summary
p3.Acc.Asc.g.all.0 <- p3.Acc.Asc.long.all.0 %>%  group_by(Btw, cPE) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup() 
p3.Acc.Asc.g.all.0$aCorr.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.0, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.g.all.0$aCorr.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.0, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.g.exp.0 <- p3.Acc.Asc.g.all.0 %>% filter(Btw==1)
p3.Acc.Asc.g.con.0 <- p3.Acc.Asc.g.all.0 %>% filter(Btw==2)
p3.Acc.Asc.g.all.0 %>% kable(digit=2)


## plot
p3.Asc.all.plot4.2.0 <- ggplot(p3.Acc.Asc.g.all.0, mapping=aes(x=cPE, y=aCorr.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.g.all.0, mapping = aes(x=cPE, y=aCorr.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.exp.plot4.2.0 <- ggplot(p3.Acc.Asc.g.exp.0, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.exp.0, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.exp.0, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.con.plot4.2.0 <- ggplot(p3.Acc.Asc.g.con.0, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.con.0, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.con.0, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.all.plot4.2.0, p3.Asc.exp.plot4.2.0, p3.Asc.con.plot4.2.0, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>

집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.0 <- aov_ez(id = "SN", dv = "aCorr", data = p3.Acc.Asc.long.all.0, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.0, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위하여, `목록 1`의 연합 기억 정확도에 대해 집단과 예측 오류 조건의 고정 효과와 참가자와 자극 항목의 무선 효과를 포함한 일반화 선형 혼합 모형을 검증하였다.

```{r, warning=FALSE, message=FALSE}
p3.L1.asc.corr <- p3 %>% filter(cSrc=="List_1", Resp != "New")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L1.asc.corr.Model.1 <- afex::mixed(aCorr ~ Btw*cPE + (1|SN) + (1|IMname),
                             p3.L1.asc.corr, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L1.asc.corr.Model.1, file="memudet_day3_L1asc_corr.Rdata")
stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_L1asc_corr.Rdata")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L1.asc.corr.Model.1) %>% kable(digit=3)
```

분석 결과, 모든 효과가 유의하지 않았다. 

<br>

##### 예측 오류에 따른 목록 2 연합 기억 정확도

<br>
  
  `목록 2`에서 집단과 예측 오류 조건에 따라 연합 기억 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>
  
```{r, fig.width= 12, fig.height=6}
## List 2 Association Memory
# long format
p3.Acc.Asc.long.all.0.2 <- p3 %>% filter(cPE != "pe0", cSrc == "List_2") %>% group_by(SN, Btw, cPE) %>% 
  summarise(aCorr = mean(aCorr)*100) %>% ungroup()
p3.Acc.Asc.long.exp.0.2 <- p3.Acc.Asc.long.all.0.2 %>% filter(Btw==1)
p3.Acc.Asc.long.con.0.2 <- p3.Acc.Asc.long.all.0.2 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.swide.all.0.2 <- p3.Acc.Asc.long.all.0.2 %>% spread(key = cPE, value = aCorr)
p3.Acc.Asc.swide.exp.0.2 <- p3.Acc.Asc.swide.all.0.2 %>% filter(Btw==1)
p3.Acc.Asc.swide.con.0.2 <- p3.Acc.Asc.swide.all.0.2 %>% filter(Btw==2)

# summary
p3.Acc.Asc.g.all.0.2 <- p3.Acc.Asc.long.all.0.2 %>%  group_by(Btw, cPE) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup() 
p3.Acc.Asc.g.all.0.2$aCorr.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.0.2, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.g.all.0.2$aCorr.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.0.2, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.g.exp.0.2 <- p3.Acc.Asc.g.all.0.2 %>% filter(Btw==1)
p3.Acc.Asc.g.con.0.2 <- p3.Acc.Asc.g.all.0.2 %>% filter(Btw==2)
p3.Acc.Asc.g.all.0.2 %>% kable(digit=2)


## plot
p3.Asc.all.plot4.2.0.2 <- ggplot(p3.Acc.Asc.g.all.0.2, mapping=aes(x=cPE, y=aCorr.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.g.all.0.2, mapping = aes(x=cPE, y=aCorr.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L2>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.exp.plot4.2.0.2 <- ggplot(p3.Acc.Asc.g.exp.0.2, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.exp.0.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.exp.0.2, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.con.plot4.2.0.2 <- ggplot(p3.Acc.Asc.g.con.0.2, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.con.0.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.con.0.2, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.all.plot4.2.0.2, p3.Asc.exp.plot4.2.0.2, p3.Asc.con.plot4.2.0.2, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>
  
  집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>
  
```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.0.2 <- aov_ez(id = "SN", dv = "aCorr", data = p3.Acc.Asc.long.all.0.2, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.0.2, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>
  
  분산 분석 결과를 보충하기 위하여, `목록 1`의 연합 기억 정확도에 대해 집단과 예측 오류 조건의 고정 효과와 참가자와 자극 항목의 무선 효과를 포함한 일반화 선형 혼합 모형을 검증하였다.

```{r, warning=FALSE, message=FALSE}
p3.L2.asc.corr <- p3 %>% filter(cSrc=="List_2", Resp != "New")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L2.asc.corr.Model.1 <- afex::mixed(aCorr ~ Btw*cPE + (1|SN) + (1|IMname),
                                      p3.L2.asc.corr, method = "LRT", cl = cl,
                                      family=binomial(link="logit"),
                                      control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L2.asc.corr.Model.1, file="memudet_day3_L2asc_corr.Rdata")
stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_12asc_Acc_afex.Rdata")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L2.asc.corr.Model.1) %>% kable(digit=3)
```

분석 결과, 모든 효과가 유의하지 않았다. 

<br>

##### 출처 반응에 따른 연합 기억 정확도

<br>

집단, 예측 오류 조건에 따른 연합 기억 정확도가 출처 반응의 유형에 따라 다른지 살펴보기 위한 분석을 수행하였다. 출처 기억 확신도 분석과 유사하게 각 출처 반응을 예측 오류 조건으로 구분하였을 때 시행수가 충분하지 않은 경우에는 연합 기억 정확도의 평균이 대표성을 가지지 못할 수 있다. 따라서 각 출처 반응에서의 시행수를 확인하였다.

```{r}
# The number of trials per condition
p3 %>% filter(cSrc!="List_3", Resp!="New") %>% 
  group_by(SN, cSrc, Resp, cPE) %>% 
  summarise(NumTrial = length(aCorr)) %>% 
  ungroup %>% 
  group_by(cSrc, Resp, cPE) %>%
  summarise(Avg = mean(NumTrial), 
            Med = median(NumTrial), 
            Min = min(NumTrial), 
            Max = max(NumTrial)) %>% 
  ungroup %>% kable(digit=4)
```

각 출처 반응의 시행수에서 **Source Confusion (L1>D2)**,  **Intrusion (L2>D1)**은 평균 시행수가 10시행에 미치지 못하므로 분석에서 제외하였다. 따라서 출처 반응의 종속 변인 중 **List 1 Correct (L1>D1)**, **List 2 Correct (L2>D2)**에서 집단과 예측 오류 조건에 따른 차이를 비교하였다. 

<br>

###### 목록 1 정확반응의 연합 기억 정확도

<br>

**List 1 Correct (L1>D1)** 출처 반응에서 집단과 예측 오류 조건에 따라 연합 기억 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>

```{r, fig.width= 12, fig.height=6}
## List 1 Association Memory of Correct Response
# long format
p3.Acc.Asc.long.all.1 <- p3 %>% filter(cPE != "pe0", Correct == 1, cSrc == "List_1") %>% group_by(SN, Btw, cPE) %>% 
  summarise(aCorr = mean(aCorr)*100) %>% ungroup()
p3.Acc.Asc.long.exp.1 <- p3.Acc.Asc.long.all.1 %>% filter(Btw==1)
p3.Acc.Asc.long.con.1 <- p3.Acc.Asc.long.all.1 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.swide.all.1 <- p3.Acc.Asc.long.all.1 %>% spread(key = cPE, value = aCorr)
p3.Acc.Asc.swide.exp.1 <- p3.Acc.Asc.swide.all.1 %>% filter(Btw==1)
p3.Acc.Asc.swide.con.1 <- p3.Acc.Asc.swide.all.1 %>% filter(Btw==2)

# summary
p3.Acc.Asc.g.all.1 <- p3.Acc.Asc.long.all.1 %>%  group_by(Btw, cPE) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup() 
p3.Acc.Asc.g.all.1$aCorr.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.1, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.g.all.1$aCorr.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.1, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.g.exp.1 <- p3.Acc.Asc.g.all.1 %>% filter(Btw==1)
p3.Acc.Asc.g.con.1 <- p3.Acc.Asc.g.all.1 %>% filter(Btw==2)
p3.Acc.Asc.g.all.1 %>% kable(digit=2)


## plot
p3.Asc.all.plot4.2.1 <- ggplot(p3.Acc.Asc.g.all.1, mapping=aes(x=cPE, y=aCorr.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.g.all.1, mapping = aes(x=cPE, y=aCorr.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.exp.plot4.2.1 <- ggplot(p3.Acc.Asc.g.exp.1, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.exp.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.exp.1, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.con.plot4.2.1 <- ggplot(p3.Acc.Asc.g.con.1, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.con.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.con.1, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.all.plot4.2.1, p3.Asc.exp.plot4.2.1, p3.Asc.con.plot4.2.1, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>

집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.1 <- aov_ez(id = "SN", dv = "aCorr", data = p3.Acc.Asc.long.all.1, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.1, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위하여, **List 1 Correct**의 연합 기억 정확도에 대해 집단과 예측 오류 조건의 고정 효과와 참가자와 자극 항목의 무선 효과를 포함한 일반화 선형 혼합 모형을 검증하였다.

```{r, eval=FALSE, warning=FALSE, message=FALSE}
p3.L1.asc.corr.1 <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.L1.asc.corr.1 <- p3.L1.asc.corr.1 %>% filter(cSrc == 1, Resp != 3, cPE != 0, Corr==1)
p3.L1.asc.corr.1$SN = factor(p3.L1.asc.corr.1$SN); p3.L1.asc.corr.1$Btw = factor(p3.L1.asc.corr.1$Btw)
p3.L1.asc.corr.1$cSrc = factor(p3.L1.asc.corr.1$cSrc, labels=c("List_1"))
p3.L1.asc.corr.1$cPE = factor(p3.L1.asc.corr.1$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.L1.asc.corr.1$Resp <- factor(p3.L1.asc.corr.1$Resp, labels=c("Day_1"))
p3.L1.asc.corr.1$aCorr <- as.numeric(p3.L1.asc.corr.1$aCorr==1)
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L1.asc.corr.Model.2 <- afex::mixed(aCorr ~ Btw*cPE + (1|SN) + (1|IMname),
                             p3.L1.asc.corr.1, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L1.asc.corr.Model.2, file="memudet_day3_L1corrL1asc_corr.Rdata")
stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_L1corrL1asc_corr.Rdata")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L1.asc.corr.Model.2) %>% kable(digit=3)
```

분석 결과, 모든 효과가 유의하지 않았다. 

<br>

###### 목록 2 정확반응의 연합 기억 정확도

<br>

**List 2 Correct (L2>D2)** 출처 반응에서 집단과 예측 오류 조건에 따라 연합 기억 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다. 

<br>

```{r, fig.width= 12, fig.height=6}
## List 2 Association Memory of Correct Source Response
# long format
p3.Acc.Asc.long.all.2 <- p3 %>% filter(cPE != "pe0", Correct == 1, cSrc == "List_2") %>% group_by(SN, Btw, cPE) %>% 
  summarise(aCorr = mean(aCorr)*100) %>% ungroup()
p3.Acc.Asc.long.exp.2 <- p3.Acc.Asc.long.all.2 %>% filter(Btw==1)
p3.Acc.Asc.long.con.2 <- p3.Acc.Asc.long.all.2 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.swide.all.2 <- p3.Acc.Asc.long.all.2 %>% spread(key = cPE, value = aCorr)
p3.Acc.Asc.swide.exp.2 <- p3.Acc.Asc.swide.all.2 %>% filter(Btw==1)
p3.Acc.Asc.swide.con.2 <- p3.Acc.Asc.swide.all.2 %>% filter(Btw==2)

# summary
p3.Acc.Asc.g.all.2 <- p3.Acc.Asc.long.all.2 %>%  group_by(Btw, cPE) %>% 
  summarise(aCorr.M = mean(aCorr), aCorr.SD = sd(aCorr)) %>% ungroup() 
p3.Acc.Asc.g.all.2$aCorr.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.2, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.g.all.2$aCorr.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.long.all.2, measurevar = "aCorr", 
                                                      idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.g.exp.2 <- p3.Acc.Asc.g.all.2 %>% filter(Btw==1)
p3.Acc.Asc.g.con.2 <- p3.Acc.Asc.g.all.2 %>% filter(Btw==2)
p3.Acc.Asc.g.all.2 %>% kable(digit=2)


## plot
p3.Asc.all.plot4.2.2 <- ggplot(p3.Acc.Asc.g.all.2, mapping=aes(x=cPE, y=aCorr.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.g.all.2, mapping = aes(x=cPE, y=aCorr.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.exp.plot4.2.2 <- ggplot(p3.Acc.Asc.g.exp.2, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.exp.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.exp.2, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.con.plot4.2.2 <- ggplot(p3.Acc.Asc.g.con.2, mapping=aes(x=cPE, y=aCorr.M, group=1)) + 
  geom_ribbon(aes(ymin=aCorr.M-aCorr.ci, ymax=aCorr.M+aCorr.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aCorr.M, ymax=aCorr.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.long.con.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aCorr, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.long.con.2, mapping = aes(x=cPE, y=aCorr, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(20, 100), clip = "on") +
  labs(x = "Prediction Error", y = "Association Accuracy (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 2 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.all.plot4.2.2, p3.Asc.exp.plot4.2.2, p3.Asc.con.plot4.2.2, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 예측 오류를 요인으로 하는 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.2 <- aov_ez(id = "SN", dv = "aCorr", data = p3.Acc.Asc.long.all.2, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.2, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

분산 분석 결과를 보충하기 위하여, **List 1 Correct**의 연합 기억 정확도에 대해 집단과 예측 오류 조건의 고정 효과와 참가자와 자극 항목의 무선 효과를 포함한 일반화 선형 혼합 모형을 검증하였다.

```{r, eval=FALSE, warning=FALSE, message=FALSE}
p3.L2.asc.corr.1 <- read.csv("MemUdt_PE_d3t6_m.csv", header = T) 
p3.L2.asc.corr.1 <- p3.L2.asc.corr.1 %>% filter(cSrc == 2, Resp != 3, cPE != 0, Corr==1)
p3.L2.asc.corr.1$SN = factor(p3.L2.asc.corr.1$SN); p3.L2.asc.corr.1$Btw = factor(p3.L2.asc.corr.1$Btw)
p3.L2.asc.corr.1$cSrc = factor(p3.L2.asc.corr.1$cSrc, labels=c("List_2"))
p3.L2.asc.corr.1$cPE = factor(p3.L2.asc.corr.1$cPE, levels=c(1,2,3), labels=c("pe1","pe2","pe3"))
p3.L2.asc.corr.1$Resp <- factor(p3.L2.asc.corr.1$Resp, labels=c("Day_2"))
p3.L2.asc.corr.1$aCorr <- as.numeric(p3.L2.asc.corr.1$aCorr==1)
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
(nc <- detectCores())
cl <- makeCluster(rep("localhost", nc))

p3.L2.asc.corr.Model.1 <- afex::mixed(aCorr ~ Btw*cPE + (1|SN) + (1|IMname),
                             p3.L2.asc.corr.1, method = "LRT", cl = cl,
                             family=binomial(link="logit"),
                             control = glmerControl(optCtrl = list(maxfun = 1e6)))

save(p3.L2.asc.corr.Model.1, file="memudet_day3_L2corrL2asc_corr.Rdata")
stopCluster(cl)
```

```{r, eval=FALSE, echo=FALSE}
load("/Users/taehoonkim/Desktop/Workspace/curr/Exp2/memudet_day3_12asc_Acc_afex.Rdata")
```

```{r, eval=FALSE, warning=FALSE, message=FALSE}
anova(p3.L2.asc.corr.Model.1) %>% kable(digit=3)
```

분석 결과, 모든 효과가 유의하지 않았다. 

<br><br>

### Day 3 연합 기억 확신도

<br>

#### 집단과 목록에 따른 연합 기억 확신도

<br>

각 집단과 물체 목록 조건에서의 연합 기억 확신도 평균과 표준편차를 계산하였다. 아래 그래프에서 x 축은 집단, y 축은 확신도 평정을 나타내며, 색은 각 물체 목록을 표시한다. 빨간 점은 평균, 오차 막대는 95% 신뢰구간을 나타낸다.

<br>

```{r, fig.width=12, fig.height = 6}
# long format
p3.day.Asc.conf.long.all <- p3 %>% filter(cSrc != "List_3", Resp != "New") %>% group_by(SN, Btw, cSrc) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup
p3.day.Asc.conf.long.exp <- p3.day.Asc.conf.long.all %>% filter(Btw==1)
p3.day.Asc.conf.long.con <- p3.day.Asc.conf.long.all %>% filter(Btw==2)

# wide format
p3.day.Asc.conf.swide.all <- p3.day.Asc.conf.long.all %>% spread(key = cSrc, value = aConf)
p3.day.Asc.conf.swide.exp <- p3.day.Asc.conf.swide.all %>% filter(Btw==1)
p3.day.Asc.conf.swide.con <- p3.day.Asc.conf.swide.all %>% filter(Btw==2)

# summary
p3.day.Asc.conf.g.all <- p3.day.Asc.conf.long.all %>% group_by(Btw, cSrc) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup()
p3.day.Asc.conf.g.all$aConf.se <- Rmisc::summarySEwithin(data = p3.day.Asc.conf.long.all, measurevar = "aConf", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cSrc")$se
p3.day.Asc.conf.g.all$aConf.ci <- Rmisc::summarySEwithin(data = p3.day.Asc.conf.long.all, measurevar = "aConf", 
                                                    idvar = "SN", betweenvars = "Btw", withinvars = "cSrc")$ci  
p3.day.Asc.conf.g.exp <- p3.day.Asc.conf.g.all %>% filter(Btw==1)
p3.day.Asc.conf.g.con <- p3.day.Asc.conf.g.all %>% filter(Btw==2)
p3.day.Asc.conf.g.all %>% kable(digit=2)

## plot
p3.day.Asc.conf.all.plot.1 <- ggplot(data=p3.day.Asc.conf.long.all, aes(x=Btw, y=aConf, fill=cSrc)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=Btw, y=aConf, group=cSrc, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.day.Asc.conf.swide.all,Btw==1), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.day.Asc.conf.swide.all,Btw==1)$"List_1",
                   xend=1+.16, yend=filter(p3.day.Asc.conf.swide.all,Btw==1)$"List_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.day.Asc.conf.swide.all,Btw==2), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.day.Asc.conf.swide.all,Btw==2)$"List_1",
                   xend=2+.16, yend=filter(p3.day.Asc.conf.swide.all,Btw==2)$"List_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.conf.g.all, aes(x = Btw, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("List 1", "List 2")) +
  scale_x_discrete(labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Group", y = "Confidence Rating (1-4)", fill ="Object List") +
  # ggtitle("Association Memory (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")
p3.day.Asc.conf.all.plot.2 <- ggplot(data=p3.day.Asc.conf.long.all, aes(x=cSrc, y=aConf, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aConf, group=Btw, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.conf.g.all, aes(x = cSrc, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Object List", y = "Confidence Rating (1-4)", fill ="Group") +
  # ggtitle("Association Memory by Object List") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")

ggpubr::ggarrange(p3.day.Asc.conf.all.plot.1, p3.day.Asc.conf.all.plot.2, ncol = 2, 
          labels=c("A) Association Confidence by Group","B) Association Confidence by List"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

집단과 물체 목록을 요인으로 하는 2 X 2 혼합 요인 분산분석을 수행하였다.

```{r, warning=FALSE, message=FALSE}
p3.day.Asc.conf.all.aov <- aov_ez(id = "SN", dv = "aConf", data = p3.day.Asc.conf.long.all, between = "Btw", within = c("cSrc"))
anova(p3.day.Asc.conf.all.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br><br>

#### 비대칭적 출처 반응에서의 연합 기억 확신도
  
<br>

연합 기억 확신도가 집단과 출처 반응의 패턴에서 차이를 보이는지 분석하였다. 각 조건별로 연합 기억 확신도의 평균과 표준편차를 계산하였다.
아래의 그래프에서 A는 전체 집단, B, C는 각 집단을 나타내며, 빨간 점은 평균, 오차 막대는 95% 신뢰구간을 나타낸다.

<br>

```{r, fig.width= 10, fig.height=12}
# long Format
p3.AsyPtt.Asc.conf.long.all <- p3 %>% filter(cSrc != "List_3", Resp != "New", aCorr==1) %>% group_by(SN, Btw, cSrc, Resp) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup()
p3.AsyPtt.Asc.conf.wide.all <- p3.AsyPtt.Asc.conf.long.all %>% spread(key = Resp, value = aConf)
p3.AsyPtt.Asc.conf.long.all <- gather(p3.AsyPtt.Asc.conf.wide.all, Resp, aConf, Day_1:Day_2, factor_key=TRUE)
p3.AsyPtt.Asc.conf.long.all[is.na(p3.AsyPtt.Asc.conf.long.all)] <- 0 
p3.AsyPtt.Asc.conf.long.all <- arrange(p3.AsyPtt.Asc.conf.long.all, SN, cSrc, Resp, aConf)
p3.AsyPtt.Asc.conf.long.exp <- p3.AsyPtt.Asc.conf.long.all %>% filter(Btw==1)
p3.AsyPtt.Asc.conf.long.con <- p3.AsyPtt.Asc.conf.long.all %>% filter(Btw==2)

# wide format
p3.AsyPtt.Asc.conf.swide.all <- p3.AsyPtt.Asc.conf.long.all %>% spread(key = Resp, value = aConf)
p3.AsyPtt.Asc.conf.swide.exp <- p3.AsyPtt.Asc.conf.swide.all %>% filter(Btw==1)
p3.AsyPtt.Asc.conf.swide.con <- p3.AsyPtt.Asc.conf.swide.all %>% filter(Btw==2)


# summary
p3.AsyPtt.Asc.conf.g.all <- p3.AsyPtt.Asc.conf.long.all %>% group_by(Btw, cSrc, Resp) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup()
p3.AsyPtt.Asc.conf.g.all$aConf.se <- Rmisc::summarySEwithin(data = p3.AsyPtt.Asc.conf.long.all, measurevar = "aConf", 
                                                       idvar = "SN", betweenvars = "Btw", withinvars = c("cSrc","Resp"))$se
p3.AsyPtt.Asc.conf.g.all$aConf.ci <- Rmisc::summarySEwithin(data = p3.AsyPtt.Asc.conf.long.all, measurevar = "aConf", 
                                                       idvar = "SN", betweenvars = "Btw", withinvars = c("cSrc","Resp"))$ci  
p3.AsyPtt.Asc.conf.g.exp <- p3.AsyPtt.Asc.conf.g.all %>% filter(Btw==1)
p3.AsyPtt.Asc.conf.g.con <- p3.AsyPtt.Asc.conf.g.all %>% filter(Btw==2)
p3.AsyPtt.Asc.conf.g.table.all <- p3.AsyPtt.Asc.conf.g.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(sResp = "cSrc_Resp")
p3.AsyPtt.Asc.conf.g.table.all$sResp[p3.AsyPtt.Asc.conf.g.table.all$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.Asc.conf.g.table.all$sResp[p3.AsyPtt.Asc.conf.g.table.all$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.Asc.conf.g.table.all$sResp[p3.AsyPtt.Asc.conf.g.table.all$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.Asc.conf.g.table.all$sResp[p3.AsyPtt.Asc.conf.g.table.all$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.Asc.conf.g.table.all %>% arrange(c(1,3,4,2,5,7,8,6)) %>% kable(digit=2)

## plot
p3.Asc.conf.all.plot1 <- ggplot(data=p3.AsyPtt.Asc.conf.long.all, aes(x=Resp, y=aConf, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.Asc.conf.g.all, aes(x = Resp, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~cSrc, scales="free_x", 
             labeller = labeller(cSrc = c("List_1" = "List 1 (Day 1)","List_2" = "List 2 (Day 2)"))) +
  scale_x_discrete(labels=c("Day 1","Day 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Source Response by Object List", y = "AM Confidence Rating (1-4)", fill ="Group") +
  # ggtitle("Confidence Response") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position="top")
p3.Asc.conf.exp.plot1 <- ggplot(data=p3.AsyPtt.Asc.conf.long.exp, aes(x=cSrc, y=aConf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aConf, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.Asc.conf.swide.exp,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.Asc.conf.g.exp, aes(x = cSrc, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Object List", y = "AM Confidence Rating (1 - 4)", fill ="Attribution") +
  # ggtitle("List 1 AM Confidence of Correct SM (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")
p3.Asc.conf.con.plot1 <- ggplot(data=p3.AsyPtt.Asc.conf.long.con, aes(x=cSrc, y=aConf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aConf, group=Resp, color = SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_1"), inherit.aes = FALSE,
               aes(x=1-.16, y=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_1")$"Day_1",
                   xend=1+.16, yend=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_1")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_segment(data=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_2"), inherit.aes = FALSE,
               aes(x=2-.16, y=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_2")$"Day_1",
                   xend=2+.16, yend=filter(p3.AsyPtt.Asc.conf.swide.con,cSrc=="List_2")$"Day_2", color=SN),
               size = 1, alpha = 0.3, show.legend = FALSE) +
  geom_pointrange(data=p3.AsyPtt.Asc.conf.g.con, aes(x = cSrc, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.65), color = "darkred", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#56b4e9", "#e69f00"),
                    labels = c("Day 1", "Day 2")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Object List", y = "AM Confidence Rating (1 - 4)", fill ="Attribution") +
  # ggtitle("List 1 AM Confidence of Correct SM (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position="top")

ggpubr::ggarrange(p3.Asc.conf.all.plot1, labels = "A) All Group",
  ggpubr::ggarrange(p3.Asc.conf.exp.plot1, p3.Asc.conf.con.plot1, ncol = 2, 
            labels = c("B) Experimental","C) Control"), hjust = -0.1, vjust=1, font.label = list(size = 16)
            ), nrow =2, hjust = -0.1, vjust=1, font.label = list(size = 16))
```

<br>

집단과 출처 반응을 요인으로 2 X 4 혼합 요인 분산분석을 수행하였다.

```{r, warning=FALSE, message=FALSE}
# List 1 & 2 Association Memory by Source Response
p3.AsyPtt.Asc.conf.long.all <- p3.AsyPtt.Asc.conf.long.all %>% unite(cSrc_Resp, cSrc:Resp, remove=TRUE) %>% rename(sResp = "cSrc_Resp")
p3.AsyPtt.Asc.conf.long.all$sResp[p3.AsyPtt.Asc.conf.long.all$sResp=='List_1_Day_1'] <- 'List 1 Correct'
p3.AsyPtt.Asc.conf.long.all$sResp[p3.AsyPtt.Asc.conf.long.all$sResp=='List_2_Day_2'] <- 'List 2 Correct'
p3.AsyPtt.Asc.conf.long.all$sResp[p3.AsyPtt.Asc.conf.long.all$sResp=='List_1_Day_2'] <- 'Source Confusion'
p3.AsyPtt.Asc.conf.long.all$sResp[p3.AsyPtt.Asc.conf.long.all$sResp=='List_2_Day_1'] <- 'Intrusion'
p3.AsyPtt.Asc.conf.long.allsResp <- factor(p3.AsyPtt.Asc.conf.long.all$sResp)

p3.AsyPtt.Asc.conf.all.1.aov <- aov_ez(id = "SN", dv = "aConf", data = p3.AsyPtt.Asc.conf.long.all, between = "Btw", within = "sResp")
anova(p3.AsyPtt.Asc.conf.all.1.aov, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

#### 예측 오류 조건에따른 연합 기억 확신도

<br>

##### 예측 오류에 따른 목록 1 연합 기억 확신도

<br>

`목록 1`에서 집단과 예측 오류 조건에 따라 연합 기억 확신도가 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

```{r, fig.width= 18, fig.height=6}
## List 1 Association Memory Confidence
# long format
p3.Acc.Asc.conf.long.all.1 <- p3 %>% filter(cPE != "pe0", cSrc == "List_1", aCorr == 1) %>% group_by(SN, Btw, cPE) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup()
p3.Acc.Asc.conf.long.exp.1 <- p3.Acc.Asc.conf.long.all.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.long.con.1 <- p3.Acc.Asc.conf.long.all.1 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.conf.swide.all.1 <- p3.Acc.Asc.conf.long.all.1 %>% spread(key = cPE, value = aConf)
p3.Acc.Asc.conf.swide.exp.1 <- p3.Acc.Asc.conf.swide.all.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.swide.con.1 <- p3.Acc.Asc.conf.swide.all.1 %>% filter(Btw==2)

# summary
p3.Acc.Asc.conf.g.all.1 <- p3.Acc.Asc.conf.long.all.1 %>%  group_by(Btw, cPE) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup() 
p3.Acc.Asc.conf.g.all.1$aConf.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.1, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.conf.g.all.1$aConf.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.1, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.conf.g.exp.1 <- p3.Acc.Asc.conf.g.all.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.g.con.1 <- p3.Acc.Asc.conf.g.all.1 %>% filter(Btw==2)
p3.Acc.Asc.conf.g.all.1 %>% kable(digit=2)

## plot
p3.Asc.conf.all.plot2.2.1 <- ggplot(p3.Acc.Asc.conf.g.all.1, mapping=aes(x=cPE, y=aConf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.conf.g.all.1, mapping = aes(x=cPE, y=aConf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.conf.exp.plot2.2.1 <- ggplot(p3.Acc.Asc.conf.g.exp.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.exp.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.exp.1, mapping = aes(x=cPE, y=aConf, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.conf.con.plot2.2.1 <- ggplot(p3.Acc.Asc.conf.g.con.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.con.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.con.1, mapping = aes(x=cPE, y=aConf, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.conf.all.plot2.2.1, p3.Asc.conf.exp.plot2.2.1, p3.Asc.conf.con.plot2.2.1, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>
  
  집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산 분석을 수행하였다. 

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.conf.1 <- aov_ez(id = "SN", dv = "aConf", data = p3.Acc.Asc.conf.long.all.1, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.conf.1, es = "pes") %>% kable(digits = 3)

```

모든 효과가 유의하지 않았다.

<br>

##### 예측 오류에 따른 목록 2 연합 기억 확신도

<br>
  
  `목록 2`에서 집단과 예측 오류 조건에 따라 연합 기억 확신도가 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

```{r, fig.width= 18, fig.height=6}
## List 2 Association Memory Confidence
# long format
p3.Acc.Asc.conf.long.all.2 <- p3 %>% filter(cPE != "pe0", cSrc == "List_2", aCorr == 1) %>% group_by(SN, Btw, cPE) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup()
p3.Acc.Asc.conf.long.exp.2 <- p3.Acc.Asc.conf.long.all.2 %>% filter(Btw==1)
p3.Acc.Asc.conf.long.con.2 <- p3.Acc.Asc.conf.long.all.2 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.conf.swide.all.2 <- p3.Acc.Asc.conf.long.all.2 %>% spread(key = cPE, value = aConf)
p3.Acc.Asc.conf.swide.exp.2 <- p3.Acc.Asc.conf.swide.all.2 %>% filter(Btw==1)
p3.Acc.Asc.conf.swide.con.2 <- p3.Acc.Asc.conf.swide.all.2 %>% filter(Btw==2)

# summary
p3.Acc.Asc.conf.g.all.2 <- p3.Acc.Asc.conf.long.all.2 %>%  group_by(Btw, cPE) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup() 
p3.Acc.Asc.conf.g.all.2$aConf.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.2, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.conf.g.all.2$aConf.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.2, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.conf.g.exp.2 <- p3.Acc.Asc.conf.g.all.2 %>% filter(Btw==1)
p3.Acc.Asc.conf.g.con.2 <- p3.Acc.Asc.conf.g.all.2 %>% filter(Btw==2)
p3.Acc.Asc.conf.g.all.2 %>% kable(digit=2)

## plot
p3.Asc.conf.all.plot2.2.2 <- ggplot(p3.Acc.Asc.conf.g.all.2, mapping=aes(x=cPE, y=aConf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.conf.g.all.2, mapping = aes(x=cPE, y=aConf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")
p3.Asc.conf.exp.plot2.2.2 <- ggplot(p3.Acc.Asc.conf.g.exp.2, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.exp.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.exp.2, mapping = aes(x=cPE, y=aConf, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.conf.con.plot2.2.2 <- ggplot(p3.Acc.Asc.conf.g.con.2, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.con.2, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.con.2, mapping = aes(x=cPE, y=aConf, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM of Correct Source (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.conf.all.plot2.2.2, p3.Asc.conf.exp.plot2.2.2, p3.Asc.conf.con.plot2.2.2, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>
  
  집단과 예측 오류 조건을 요인으로 2 X 3 혼합 요인 분산 분석을 수행하였다. 

```{r, warning=FALSE, message=FALSE}
p3.Acc.all.aov.Asc.conf.2 <- aov_ez(id = "SN", dv = "aConf", data = p3.Acc.Asc.conf.long.all.2, between = "Btw", within = "cPE")
anova(p3.Acc.all.aov.Asc.conf.2, es = "pes") %>% kable(digits = 3)

```

모든 효과가 유의하지 않았다.

<br>
  

##### 출처 반응에 따른 연합 기억 확신도

<br>

집단, 예측 오류 조건에 따른 연합 기억 확신도가 출처 반응의 유형에 따라 다른지 살펴보기 위한 분석을 수행하였다. 각 출처 반응을 예측 오류 조건으로 구분하였을 때 시행수가 충분하지 않은 경우에는 연합 기억 정확도의 평균이 대표성을 가지지 못할 수 있다. 따라서 각 출처 반응에서의 시행수를 확인하였다.

```{r, warning=FALSE, message=FALSE}
# The number of trials per condition
p3 %>% filter(cSrc!="List_3", Resp!="New", aCorr==1) %>% 
  group_by(SN, cSrc, Resp, cPE) %>% 
  summarise(NumTrial = length(aCorr)) %>% 
  ungroup %>% 
  group_by(cSrc, Resp, cPE) %>%
  summarise(Avg = mean(NumTrial), 
            Med = median(NumTrial), 
            Min = min(NumTrial), 
            Max = max(NumTrial)) %>% 
  ungroup %>% kable(digit=4)
```

각 출처 반응의 시행수에서 **Source Confusion (L1>D2)**, **Intrusion (L2>D1)**은 평균 시행수가 10시행에 미치지 못하므로 분석에서 제외하였다. 따라서 출처 반응의 종속 변인 중 **List 1 Correct (L1>D1)**, **List 2 Correct (L2>D2)**에서 집단과 예측 오류 조건에 따른 차이를 비교하였다.

<br>

###### 목록 1 정확반응의 연합 기억 확신도

**List 1 Correct (L1>D1)** 출처 반응에서 집단과 예측 오류 조건에 따라 연합 기억 확신도 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

```{r, fig.width= 12, fig.height=6}
## List 1 AM Confidence of Correct Source Response
# long format
p3.Acc.Asc.conf.long.all.1.1 <- p3 %>% filter(cSrc == "List_1", cPE != "pe0", Correct == 1, aCorr == 1) %>% 
  group_by(SN, Btw, cPE) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup()
p3.Acc.Asc.conf.long.exp.1.1<- p3.Acc.Asc.conf.long.all.1.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.long.con.1.1 <- p3.Acc.Asc.conf.long.all.1.1 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.conf.swide.all.1.1 <- p3.Acc.Asc.conf.long.all.1.1 %>% spread(key = cPE, value = aConf)
p3.Acc.Asc.conf.swide.exp.1.1 <- p3.Acc.Asc.conf.swide.all.1.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.swide.con.1.1 <- p3.Acc.Asc.conf.swide.all.1.1 %>% filter(Btw==2)

# summary
p3.Acc.Asc.conf.g.all.1.1 <- p3.Acc.Asc.conf.long.all.1.1 %>%  group_by(Btw, cPE) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup() 
p3.Acc.Asc.conf.g.all.1.1$aConf.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.1.1, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.conf.g.all.1.1$aConf.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.1.1, measurevar = "aConf", 
                                                           idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.conf.g.exp.1.1 <- p3.Acc.Asc.conf.g.all.1.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.g.con.1.1 <- p3.Acc.Asc.conf.g.all.1.1 %>% filter(Btw==2)
p3.Acc.Asc.conf.g.all.1.1 %>% kable(digit=2)

## plot
p3.Asc.conf.all.plot2.2.1.1 <- ggplot(p3.Acc.Asc.conf.g.all.1.1, mapping=aes(x=cPE, y=aConf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.conf.g.all.1.1, mapping = aes(x=cPE, y=aConf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")

p3.Asc.conf.exp.plot2.2.1.1 <- ggplot(p3.Acc.Asc.conf.g.exp.1.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.exp.1.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.exp.1.1, mapping = aes(x=cPE, y=aConf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Association Confidence (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM Confidence of Correct SM (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.conf.con.plot2.2.1.1 <- ggplot(p3.Acc.Asc.conf.g.con.1.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.con.1.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.con.1.1, mapping = aes(x=cPE, y=aConf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Association Confidence (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM Confidence of Correct SM (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.conf.all.plot2.2.1.1, p3.Asc.conf.exp.plot2.2.1.1, p3.Asc.conf.con.plot2.2.1.1, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>

집단과 예측 오류 조건을 요인으로 하는 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>

```{r, warning=FALSE, message=FALSE}
p3.Acc.Asc.all.aov.conf.1.1 <- aov_ez(id = "SN", dv = "aConf", data = p3.Acc.Asc.conf.long.all.1.1, between = "Btw", within = "cPE")
anova(p3.Acc.Asc.all.aov.conf.1.1, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

###### 목록 2 정확반응의 연합 기억 확신도

**List 2 Correct (L1>D1)** 출처 반응에서 집단과 예측 오류 조건에 따라 연합 기억 확신도 수준이 다른지 살펴보았다. 각 조건의 평균과 표준편차를 계산하였다. 아래의 그래프에서 A는 전체 집단, B는 실험 집단, C는 통제 집단을 나타내며, 빨간 점은 평균, 빨간 리본은 95% 신뢰구간을 나타낸다.

```{r, fig.width= 12, fig.height=6}
## List 2 AM Confidence of Correct Source Response
# long format
p3.Acc.Asc.conf.long.all.2.1 <- p3 %>% filter(cSrc == "List_2", cPE != "pe0", Correct == 1, aCorr == 1) %>% 
  group_by(SN, Btw, cPE) %>% 
  summarise(aConf = mean(aConf)) %>% ungroup()
p3.Acc.Asc.conf.long.exp.2.1<- p3.Acc.Asc.conf.long.all.2.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.long.con.2.1 <- p3.Acc.Asc.conf.long.all.2.1 %>% filter(Btw==2)

# wide format
p3.Acc.Asc.conf.swide.all.2.1 <- p3.Acc.Asc.conf.long.all.2.1 %>% spread(key = cPE, value = aConf)
p3.Acc.Asc.conf.swide.exp.2.1 <- p3.Acc.Asc.conf.swide.all.2.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.swide.con.2.1 <- p3.Acc.Asc.conf.swide.all.2.1 %>% filter(Btw==2)

# summary
p3.Acc.Asc.conf.g.all.2.1 <- p3.Acc.Asc.conf.long.all.2.1 %>%  group_by(Btw, cPE) %>% 
  summarise(aConf.M = mean(aConf), aConf.SD = sd(aConf)) %>% ungroup() 
p3.Acc.Asc.conf.g.all.2.1$aConf.se <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.2.1, measurevar = "aConf", 
                                                             idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$se
p3.Acc.Asc.conf.g.all.2.1$aConf.ci <- Rmisc::summarySEwithin(data = p3.Acc.Asc.conf.long.all.2.1, measurevar = "aConf", 
                                                             idvar = "SN", betweenvars = "Btw", withinvars = "cPE")$ci
p3.Acc.Asc.conf.g.exp.2.1 <- p3.Acc.Asc.conf.g.all.2.1 %>% filter(Btw==1)
p3.Acc.Asc.conf.g.con.2.1 <- p3.Acc.Asc.conf.g.all.2.1 %>% filter(Btw==2)
p3.Acc.Asc.conf.g.all.2.1 %>% kable(digit=2)

## plot
p3.Asc.conf.all.plot2.2.2.1 <- ggplot(p3.Acc.Asc.conf.g.all.2.1, mapping=aes(x=cPE, y=aConf.M, group=Btw)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci, fill=Btw), alpha=0.3) + 
  geom_line(p3.Acc.Asc.conf.g.all.2.1, mapping = aes(x=cPE, y=aConf.M, color = Btw), size = 1, show.legend = FALSE) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M, color=Btw), position = position_dodge(0), 
                  size = 0.8, show.legend = FALSE) +
  scale_fill_manual(values = c("#e69f00", "#56b4e9"), labels = c("Experimental", "Control")) +
  scale_color_manual(values = c("#e69f00", "#56b4e9")) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "AM Confidence Rating (1-4)", fill = "Group") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 Correct SM (L1>D1; Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.position = "top")

p3.Asc.conf.exp.plot2.2.2.1 <- ggplot(p3.Acc.Asc.conf.g.exp.2.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.exp.2.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.exp.2.1, mapping = aes(x=cPE, y=aConf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Association Confidence (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM Confidence of Correct SM (Exp)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
p3.Asc.conf.con.plot2.2.2.1 <- ggplot(p3.Acc.Asc.conf.g.con.2.1, mapping=aes(x=cPE, y=aConf.M, group=1)) + 
  geom_ribbon(aes(ymin=aConf.M-aConf.ci, ymax=aConf.M+aConf.ci), fill="darkred", alpha=0.3) + geom_line(colour="darkred", size = 1) +
  geom_pointrange(aes(x = cPE, ymin=aConf.M, ymax=aConf.M), position = position_dodge(0.65), 
                  color = "darkred", size = 0.8, show.legend = FALSE) +
  geom_line(p3.Acc.Asc.conf.long.con.2.1, alpha = 0.7, show.legend = FALSE,
            mapping=aes(x=cPE, y=aConf, group=SN, color=SN)) +
  geom_point(p3.Acc.Asc.conf.long.con.2.1, mapping = aes(x=cPE, y=aConf, group=SN, color=SN), size = 3, alpha = .22, show.legend = FALSE) +
  coord_cartesian(ylim = c(1, 4), clip = "on") +
  labs(x = "Prediction Error", y = "Association Confidence (1 - 4)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # ggtitle("List 1 AM Confidence of Correct SM (Con)") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(2, 0.3, 0.3, 0.3, "cm"))
ggpubr::ggarrange(p3.Asc.conf.all.plot2.2.2.1, p3.Asc.conf.exp.plot2.2.2.1, p3.Asc.conf.con.plot2.2.2.1, ncol=3, 
          labels=c("A) All Group", "B) Experimental", "C) Control"),
          hjust = -0.1, vjust=1, font.label = list(size = 16))

```

<br>
  
  집단과 예측 오류 조건을 요인으로 하는 2 X 3 혼합 요인 분산분석을 수행하였다.

<br>
  
```{r, warning=FALSE, message=FALSE}
p3.Acc.Asc.all.aov.conf.2.1 <- aov_ez(id = "SN", dv = "aConf", data = p3.Acc.Asc.conf.long.all.2.1, between = "Btw", within = "cPE")
anova(p3.Acc.Asc.all.aov.conf.2.1, es = "pes") %>% kable(digits = 3)
```

분석 결과, 모든 효과가 유의하지 않았다.

<br>

***

```{r, warning=FALSE, message=FALSE, eval=TRUE}
save(list=ls(), file="memudet_data.Rdata")
```

***

<br>

# PLOT

## Day 1 & 2. Association Memory Performance

```{r, fig.height = 6, fig.width = 8}
p12.L.g.L1 <- p12.L.g.all %>% filter(List == "List1")
p12.L.g.L1$Btw <- factor(p12.L.g.L1$Btw, labels=c("Experimental", "Control"))
p12.L.g.L1.plot1 <- ggplot(data=p12.L.g.L1, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 0.3, 1, "cm"),
        legend.key = element_blank())

p12.L.g.L2 <- p12.L.g.all %>% filter(List == "List2")
p12.L.g.L2$Btw <- factor(p12.L.g.L2$Btw, labels=c("Experimental", "Control"))
p12.L.g.L2.plot1 <- ggplot(data=p12.L.g.L2, 
                           aes(x=Block, y=ACC.M, ymin=ACC.M-ci, ymax=ACC.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(20,100), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Accuracy (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.35),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(1, 1, 0.3, 1, "cm"),
        legend.key = element_blank())


p12.L.rt.g.L1 <- p12.L.rt.g.all %>% filter(List == "List1")
p12.L.rt.g.L1$Btw <- factor(p12.L.g.L1$Btw, labels=c("Experimental", "Control"))
p12.L.rt.g.L1.plot1 <- ggplot(data=p12.L.rt.g.L1 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 1, 0.3, 1, "cm"),
        legend.key = element_blank())

p12.L.rt.g.L2 <- p12.L.rt.g.all %>% filter(List == "List2")
p12.L.rt.g.L2$Btw <- factor(p12.L.g.L2$Btw, labels=c("Experimental", "Control"))
p12.L.rt.g.L2.plot1 <- ggplot(data=p12.L.rt.g.L2 , 
                              aes(x=Block, y=RT.M, ymin=RT.M-ci, ymax=RT.M+ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,1800), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("1", "2", "3", "4")) +
  labs(x = "Block", y = "Response Time (ms)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.65, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 0.6,
        legend.background = element_blank(),
        plot.margin = margin(0.3, 1, 0.3, 1, "cm"),
        legend.key = element_blank())

d1_d2_asc_all2_Main<- ggpubr::ggarrange(p12.L.g.L1.plot1, p12.L.g.L2.plot1, p12.L.rt.g.L1.plot1, p12.L.rt.g.L2.plot1, nrow = 2, ncol=2, 
                                 labels=c("A. List 1","B. List 2"," "," "),
                                 hjust = -0.05, vjust=1, font.label = list(size = 20))
d1_d2_asc_all2_Main
# ggsave("d1&d2_asc_all_Main.jpg", plot = d1_d2_asc_all2_Main, width=12, height=9, unit='in', dpi=600)

```

<br>

## Day 3. Asymmetric Patterns of Source Misattribution

```{r, fig.height = 6, fig.width = 6}
p3.AsyPtt.long.all.p2 <- p3.AsyPtt.long.all %>% filter(cSrc != "List_3", Resp != "New")
p3.AsyPtt.g.all.p2 <- p3.AsyPtt.g.all %>% filter(cSrc != "List_3", Resp != "New")
p3.all.plot3.pilot <- ggplot(data=p3.AsyPtt.long.all.p2, aes(x=cSrc, y=Rsp, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.g.all.p2, aes(x = cSrc, y=Rsp.M, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  # geom_point(data=p3.AsyPtt.g.all.p2, aes(x = cSrc, y=Rsp.M),
                  # position = position_dodge(0.80), color = "black", size = 5, show.legend = FALSE) +
  # geom_errorbar(data=p3.AsyPtt.g.all.p2, aes(x=cSrc, ymin = Rsp.M-Rsp.ci, ymax = Rsp.M+Rsp.ci), size = 1, width = .2, position = position_dodge(0.8)) +
  facet_grid(.~Btw, scales="free_x", space = "free",
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
  # scale_fill_manual(values = c("#a3d8d7", "#ed9b5d"),#a3d8d7 #72c2c8
  # scale_fill_manual(values = c("#feb24c", "#4292c6"),
  # scale_fill_manual(values = c("#c6d9f1", "#254061"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(0, 105), clip = "on") +
  labs(x = "Source Response by Object List", y = "Proportion of Response (%)", fill ="Attribution") +
  # ggtitle("Source Memory Response") +
  theme_bw(base_size = 18) +
  theme(axis.line=element_line(),
        # axis.title = element_text(face = "bold", size = 16, color = "black"),
        # axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        # strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8, 0.85),
        legend.title = element_text(size=18),
        legend.text = element_text(size=18))
p3.all.plot3.pilot
# ggsave("d3_Src_asyptt_all_pilot3.jpg", plot = p3.all.plot3.pilot, width=6, height=6, unit='in', dpi=600)
```

```{r, fig.height=6, fig.width=6}
p3.conf.all.plot1 <- ggplot(data=p3.AsyPtt.conf.long.all, aes(x=cSrc, y=Conf, fill=Resp)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .9, width = 0.8, colour="black", size = 1.02) +
  geom_pointrange(data=p3.AsyPtt.conf.g.all, aes(x = cSrc, y = Conf.M, ymin = Conf.M-Conf.ci, ymax = Conf.M+Conf.ci),
                  position = position_dodge(0.80), color = "darkred", size = 1, show.legend = FALSE) +
  facet_grid(.~Btw, scales="free_x", 
             labeller = labeller(Btw = c("1" = "Experimental Group","2" = "Control Group"))) +
  scale_x_discrete(labels=c("List 1","List 2")) +
  scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Day 1 Response", "Day 2 Response")) +
  coord_cartesian(ylim = c(1, 4.5), clip = "on") +
  labs(x = "Source Response by Object List", y = "Confidence Rating (1-4)", fill ="Attribution") +
  # ggtitle("Confidence Response") +
  theme_bw(base_size = 18) +
  theme(axis.line=element_line(),
        # axis.title = element_text(face = "bold", size = 16, color = "black"),
        # axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        # strip.text.x = element_text(face = "plain", size = 15, color = "black"),
        strip.background = element_blank(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.spacing=unit(1, "lines"),
        plot.margin = margin(1, 0.3, 1, 0.3, "cm"), 
        # plot.title = element_text(hjust = 0.5),
        legend.position=c(0.8,0.85),
        legend.title = element_text(size=18),
        legend.text = element_text(size=18))
p3.conf.all.plot1
# ggsave("d3_sConf_asyptt_all_main1.jpg", plot = p3.conf.all.plot1, width=6, height=6, unit='in', dpi=600)

```

<br>

## Day 3. Non-monotonic Patterns of Memory Updating

```{r, fig.height = 6, fig.width = 6}
# Intrusion
p3.Intru.g.all.p3 <- p3.Intru.g.all
p3.Intru.g.all.p3$Btw <- factor(p3.Intru.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.1.all.p3.main <- ggplot(data=p3.Intru.g.all.p3, 
                            aes(x=cPE, y=Intru.M, ymin=Intru.M-Intru.ci, ymax=Intru.M+Intru.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,70), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  labs(x = "Prediction Error", y = "Intrusion (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
p3.plot2.1.all.p3.main

# ggsave("d3_Src_nmon_int_main2.jpg", plot = p3.plot2.1.all.p3.main, width=6, height=6, unit='in', dpi=600)
```


```{r, fig.height=12, fig.width=12}
p3.Acc.g.all.1.p3 <- p3.Acc.g.all.1
p3.Acc.g.all.1.p3$Btw <- factor(p3.Acc.g.all.1.p3$Btw, labels=c("Experimental", "Control"))
p3.plot2.2.all.1.p3 <- ggplot(data=p3.Acc.g.all.1.p3, 
                              aes(x=cPE, y=Acc.M, ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(40,100), clip = "on") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "List 1 Correct (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.25),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.5, 0.3, 0.5, "cm"),
        legend.key = element_blank())
p3.plot2.2.all.1.p3

# source confusion
p3.Err.g.all.p3 <- p3.Err.g.all
p3.Err.g.all.p3$Btw <- factor(p3.Err.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.3.all.1.p3 <- ggplot(data=p3.Err.g.all.p3, 
                              aes(x=cPE, y=Err.M, ymin=Err.M-Err.ci, ymax=Err.M+Err.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,70), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  labs(x = "Prediction Error", y = "Source Confusion (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.5, 0.3, 0.5, "cm"),
        legend.key = element_blank())
p3.plot2.3.all.1.p3

# List 2 Correct
p3.Acc.g.all.2.p3 <- p3.Acc.g.all.2
p3.Acc.g.all.2.p3$Btw <- factor(p3.Acc.g.all.2.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.2.all.2.p3 <- ggplot(data=p3.Acc.g.all.2.p3, 
                              aes(x=cPE, y=Acc.M, ymin=Acc.M-Acc.ci, ymax=Acc.M+Acc.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(40,100), clip = "on") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "List 2 Correct (%)") +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.25),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.5, 0.3, 0.5, "cm"),
        legend.key = element_blank())
# p3.plot2.2.all.2.p3

# Intrusion
p3.Intru.g.all.p3 <- p3.Intru.g.all
p3.Intru.g.all.p3$Btw <- factor(p3.Intru.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot2.1.all.p3 <- ggplot(data=p3.Intru.g.all.p3, 
                            aes(x=cPE, y=Intru.M, ymin=Intru.M-Intru.ci, ymax=Intru.M+Intru.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(0,70), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "Intrusion (%)") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.85),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.5, 0.3, 0.5, "cm"),
        legend.key = element_blank())
# p3.plot2.1.all.p3

d3_nmon_src<- ggpubr::ggarrange(p3.plot2.2.all.1.p3, p3.plot2.2.all.2.p3, p3.plot2.3.all.1.p3, p3.plot2.1.all.p3, nrow = 2, ncol=2, 
                          labels=c("A","B","C","D"),
                          hjust = -0.05, vjust=1, font.label = list(size = 20))
d3_nmon_src

# ggsave("d3_Src_nmon_all_main3.jpg", plot = d3_nmon_src, width=12, height=12, unit='in', dpi=600)

```

```{r, fig.height=6, fig.width=6}
p3.US.g.all.p3 <- p3.US.g.all
p3.US.g.all.p3$Btw <- factor(p3.US.g.all.p3$Btw, labels=c("Experimental", "Control"))

p3.plot5.1.all.p3 <- ggplot(data=p3.US.g.all.p3, 
                            aes(x=cPE, y=US.M, ymin=US.M-US.ci, ymax=US.M+US.ci, color=Btw, shape=Btw)) +
  geom_point(size = 4, position = position_dodge(.3)) +
  geom_errorbar(width = .2, position = position_dodge(.3)) +
  geom_line(aes(group = Btw), position = position_dodge(.3)) + 
  scale_color_manual(values = c("red", "black")) +
  # scale_shape_manual(values = c("red", "black"), labels = c("Experimental", "Control")) +
  coord_cartesian(ylim = c(-50,50), clip = "on") +
  # scale_y_continuous(breaks = seq(0,80)) +
  labs(x = "Prediction Error", y = "Updating Score") +
  scale_x_discrete(labels = c("PE 1", "PE 2", "PE 3")) +
  theme_bw(base_size = 18) +
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        legend.position = c(0.75, 0.20),
        legend.title = element_blank(),
        aspect.ratio = 1,
        legend.background = element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"),
        legend.key = element_blank())
p3.plot5.1.all.p3

# ggsave("d3_Src_nmon_US_main3.jpg", plot = p3.plot5.1.all.p3, width=6, height=6, unit='in', dpi=600)
```

## Day 3. Association Memory Performance

```{r, fig.height=6, fig.width=6}
p3.day.Asc.all.plot.2 <- ggplot(data=p3.day.Asc.long.all, aes(x=cSrc, y=aCorr, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  # geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aCorr, group=Btw, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.g.all, aes(x = cSrc, y = aCorr.M, ymin = aCorr.M-aCorr.ci, ymax = aCorr.M+aCorr.ci),
                  position = position_dodge(0.65), color = "black", size = 1,  show.legend = FALSE) +
    scale_fill_manual(values = c("#c6d9f1", "#254061"),
  # scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(40, 105), clip = "on") +
  labs(x = "Object List", y = "Accuracy (%)", fill ="Group") +
  # ggtitle("Association Memory by Object List") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position=c(0.80,0.90))
p3.day.Asc.all.plot.2
# ggsave("d3_asc_all.jpg", plot = p3.day.Asc.all.plot.2, width=6, height=6, unit='in', dpi=600)

```

```{r, fig.height=6, fig.width=6}
p3.day.Asc.conf.all.plot.2 <- ggplot(data=p3.day.Asc.conf.long.all, aes(x=cSrc, y=aConf, fill=Btw)) +
  stat_summary(fun = mean, geom = "bar", position="dodge", na.rm = TRUE, alpha = .7, width = .65, colour="black", size = 1.02) +
  # geom_point(position=position_dodge(0.65), aes(x=cSrc, y=aConf, group=Btw, color=SN), size = 3, alpha = .4, show.legend = FALSE) +
  geom_pointrange(data=p3.day.Asc.conf.g.all, aes(x = cSrc, y = aConf.M, ymin = aConf.M-aConf.ci, ymax = aConf.M+aConf.ci),
                  position = position_dodge(0.65), color = "black", size = 1, show.legend = FALSE) +
  scale_fill_manual(values = c("#c6d9f1", "#254061"),
  # scale_fill_manual(values = c("#feb24c", "#91bfdb"),
                    labels = c("Experimental", "Control")) +
  scale_x_discrete(labels = c("List 1", "List 2")) +
  coord_cartesian(ylim = c(1, 4.5), clip = "on") +
  labs(x = "Object List", y = "Confidence Rating (1-4)", fill ="Group") +
  # ggtitle("Association Memory by Object List") +
  theme_bw(base_size = 15) +
  theme(axis.title = element_text(face = "bold", size = 16, color = "black"),
        axis.text = element_text(face = "plain", hjust = 0.5, size = 15, color = "black"),
        axis.line=element_line(),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border=element_blank(),
        plot.margin = margin(1, 0.3, 0.3, 0.3, "cm"), 
        legend.position=c(.8,.9))
p3.day.Asc.conf.all.plot.2
# ggsave("d3_asc_conf_all.jpg", plot = p3.day.Asc.conf.all.plot.2, width=6, height=6, unit='in', dpi=600)

```

****
  
<br><br>
  
# SessionInfo

```{r, warning=FALSE, message=FALSE}
sessionInfo()
```
